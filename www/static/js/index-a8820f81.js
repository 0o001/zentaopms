var Yt=Object.defineProperty,Xt=Object.defineProperties;var Wt=Object.getOwnPropertyDescriptors;var pt=Object.getOwnPropertySymbols;var zt=Object.prototype.hasOwnProperty,qt=Object.prototype.propertyIsEnumerable;var vt=(e,t,n)=>t in e?Yt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,P=(e,t)=>{for(var n in t||(t={}))zt.call(t,n)&&vt(e,n,t[n]);if(pt)for(var n of pt(t))qt.call(t,n)&&vt(e,n,t[n]);return e},de=(e,t)=>Xt(e,Wt(t));var pe=(e,t,n)=>new Promise((s,o)=>{var h=i=>{try{m(n.next(i))}catch(l){o(l)}},v=i=>{try{m(n.throw(i))}catch(l){o(l)}},m=i=>i.done?s(i.value):Promise.resolve(i.value).then(h,v);m((n=n.apply(e,t)).next())});import{u as ae,E as re,c as At,H as R,i as Ie,a as Dt,C as Vt,j as Jt}from"./chartEditStore-043dcc59.js";import{x as it,a6 as kt,bd as Qt,aj as T,c5 as Ft,c6 as Lt,cn as ht,aE as oe,aD as Xe,cm as Zt,c2 as tt,co as q,ca as We,ak as jt,j as ce,d as ue,bT as ke,f as a,u as Fe,a5 as $,o as A,m as z,n as lt,F as he,A as Ee,ad as le,aH as se,aa as Ce,z as W,c as N,w as x,L as we,aG as nt,aI as He,aJ as ot,aK as Ot,a4 as dt,y as Ne,al as gt,R as ve,r as I,cp as en,a3 as Ke,v as Z,cq as _t,G as Mt,H as bt,e as O,p as Se,t as fe,ay as tn,a$ as nn,cr as ge,cs as Pe,ct as on,c1 as sn,cu as an,U as ze,aU as qe,av as Me,aw as mt,am as rn,cv as un,J as Bt,Q as Ct,aP as Ve,X as Je,Y as Qe,c0 as cn,V as ln,cw as dn,cx as fn,W as pn,c4 as vn,S as be,aQ as Ze}from"./index.js";import{u as ft,d as hn}from"./index-4e01e2e9.js";import{c as Rt,l as $e,f as gn,b as _n}from"./index-167b58f5.js";import{a as mn,b as yt,l as Cn,g as yn}from"./plugin-f5226ec4.js";import{C as En}from"./index-4bf35c4c.js";import{u as It,C as st}from"./chartLayoutStore-44dbd96d.js";import{i as De}from"./icon-ce1cfc0f.js";import{E as wn}from"./index-4d15c8ef.js";import"./index-695ddc2d.js";import"./index-b6ff2ace.js";import"./tables_list-b8a2612d.js";import"./SizeSetting.vue_vue_type_style_index_0_scoped_true_lang-6f7723ea.js";import"./useTargetData.hook-4229c89e.js";const xe=ae(),Sn=()=>{it(()=>{xe.setEditCanvas(re.EDIT_LAYOUT_DOM,document.getElementById("go-chart-edit-layout")),xe.setEditCanvas(re.EDIT_CONTENT_DOM,document.getElementById("go-chart-edit-content"));const e=xe.listenerScale();kt(()=>{xe.setEditCanvas(re.EDIT_LAYOUT_DOM,null),xe.setEditCanvas(re.EDIT_CONTENT_DOM,null),e()})})};var Ht={exports:{}};(function(e){(function(t){var n,s={},o={16:!1,18:!1,17:!1,91:!1},h="all",v={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},m={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},i=function(u){return m[u]||u.toUpperCase().charCodeAt(0)},l=[];for(n=1;n<20;n++)m["f"+n]=111+n;function d(u,f){for(var k=u.length;k--;)if(u[k]===f)return k;return-1}function r(u,f){if(u.length!=f.length)return!1;for(var k=0;k<u.length;k++)if(u[k]!==f[k])return!1;return!0}var c={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function p(u){for(n in o)o[n]=u[c[n]]}function g(u){var f,k,F,Y,U,ie;if(f=u.keyCode,d(l,f)==-1&&l.push(f),(f==93||f==224)&&(f=91),f in o){o[f]=!0;for(F in v)v[F]==f&&(D[F]=!0);return}if(p(u),!!D.filter.call(this,u)&&f in s){for(ie=V(),Y=0;Y<s[f].length;Y++)if(k=s[f][Y],k.scope==ie||k.scope=="all"){U=k.mods.length>0;for(F in o)(!o[F]&&d(k.mods,+F)>-1||o[F]&&d(k.mods,+F)==-1)&&(U=!1);(k.mods.length==0&&!o[16]&&!o[18]&&!o[17]&&!o[91]||U)&&k.method(u,k)===!1&&(u.preventDefault?u.preventDefault():u.returnValue=!1,u.stopPropagation&&u.stopPropagation(),u.cancelBubble&&(u.cancelBubble=!0))}}}function C(u){var f=u.keyCode,k,F=d(l,f);if(F>=0&&l.splice(F,1),(f==93||f==224)&&(f=91),f in o){o[f]=!1;for(k in v)v[k]==f&&(D[k]=!1)}}function y(){for(n in o)o[n]=!1;for(n in v)D[n]=!1}function D(u,f,k){var F,Y;F=_(u),k===void 0&&(k=f,f="all");for(var U=0;U<F.length;U++)Y=[],u=F[U].split("+"),u.length>1&&(Y=H(u),u=[u[u.length-1]]),u=u[0],u=i(u),u in s||(s[u]=[]),s[u].push({shortcut:F[U],scope:f,method:k,key:F[U],mods:Y})}function B(u,f){var k,F,Y=[],U,ie,Te;for(k=_(u),ie=0;ie<k.length;ie++){if(F=k[ie].split("+"),F.length>1&&(Y=H(F),u=F[F.length-1]),u=i(u),f===void 0&&(f=V()),!s[u])return;for(U=0;U<s[u].length;U++)Te=s[u][U],Te.scope===f&&r(Te.mods,Y)&&(s[u][U]={})}}function b(u){return typeof u=="string"&&(u=i(u)),d(l,u)!=-1}function L(){return l.slice(0)}function G(u){var f=(u.target||u.srcElement).tagName;return!(f=="INPUT"||f=="SELECT"||f=="TEXTAREA")}for(n in v)D[n]=!1;function X(u){h=u||"all"}function V(){return h||"all"}function w(u){var f,k,F;for(f in s)for(k=s[f],F=0;F<k.length;)k[F].scope===u?k.splice(F,1):F++}function _(u){var f;return u=u.replace(/\s/g,""),f=u.split(","),f[f.length-1]==""&&(f[f.length-2]+=","),f}function H(u){for(var f=u.slice(0,u.length-1),k=0;k<f.length;k++)f[k]=v[f[k]];return f}function K(u,f,k){u.addEventListener?u.addEventListener(f,k,!1):u.attachEvent&&u.attachEvent("on"+f,function(){k(window.event)})}K(document,"keydown",function(u){g(u)}),K(document,"keyup",C),K(window,"focus",y);var S=t.key;function M(){var u=t.key;return t.key=S,u}t.key=D,t.key.setScope=X,t.key.getScope=V,t.key.deleteScope=w,t.key.filter=G,t.key.isPressed=b,t.key.getPressedKeyCodes=L,t.key.noConflict=M,t.key.unbind=B,e.exports=D})(Qt)})(Ht);var j=Ht.exports;const ee=ae(),ne=e=>`${Ft.CTRL}+${e}`,Be=e=>`${Ft.SHIFT}+${e}`,J={[T.ARROW_UP]:ne("up"),[T.ARROW_RIGHT]:ne("right"),[T.ARROW_DOWN]:ne("down"),[T.ARROW_LEFT]:ne("left"),[T.COPY]:ne("c"),[T.CUT]:ne("x"),[T.PARSE]:ne("v"),[T.DELETE]:"delete",[T.BACK]:ne("z"),[T.FORWORD]:ne(Be("z")),[T.GROUP]:ne("g"),[T.UN_GROUP]:ne(Be("g")),[T.LOCK]:ne("l"),[T.UNLOCK]:ne(Be("l")),[T.HIDE]:ne("h"),[T.SHOW]:ne(Be("h"))},te=e=>`${Lt.CTRL}+${e}`,Re=e=>`${Lt.SHIFT}+${e}`,Q={[T.ARROW_UP]:te("arrowup"),[T.ARROW_RIGHT]:te("arrowright"),[T.ARROW_DOWN]:te("arrowdown"),[T.ARROW_LEFT]:te("arrowleft"),[T.COPY]:te("c"),[T.CUT]:te("x"),[T.PARSE]:te("v"),[T.DELETE]:te("backspace"),[T.BACK]:te("z"),[T.FORWORD]:te(Re("z")),[T.GROUP]:te("g"),[T.UN_GROUP]:te(Re("g")),[T.LOCK]:te("l"),[T.UNLOCK]:te(Re("l")),[T.HIDE]:te("h"),[T.SHOW]:te(Re("h"))},Tn=[J.up,J.right,J.down,J.left,J.delete,J.copy,J.cut,J.parse,J.back,J.forward,J.group,J.unGroup,J.lock,J.unLock,J.hide,J.show],xn=[Q.up,Q.right,Q.down,Q.left,Q.delete,Q.copy,Q.cut,Q.parse,Q.back,Q.forward,Q.group,Q.unGroup,Q.lock,Q.unLock,Q.hide,Q.show],An=()=>{window.$KeyboardActive={ctrl:!1,space:!1},document.onkeydown=e=>{const{keyCode:t}=e;if(t==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(t)&&window.$KeyboardActive)switch(ht(e.keyCode),t){case 17:window.$KeyboardActive.ctrl=!0;break;case 32:window.$KeyboardActive.space=!0;break}},document.onkeyup=e=>{const{keyCode:t}=e;if(t==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(t)&&window.$KeyboardActive)switch(ht(),t){case 17:window.$KeyboardActive.ctrl=!1;break;case 32:window.$KeyboardActive.space=!1;break}}},Dn=()=>{const t=(n,s)=>{switch(s){case n.up:j(s,oe(()=>(ee.setMove(T.ARROW_UP),!1),50));break;case n.right:j(s,oe(()=>(ee.setMove(T.ARROW_RIGHT),!1),50));break;case n.down:j(s,oe(()=>(ee.setMove(T.ARROW_DOWN),!1),50));break;case n.left:j(s,oe(()=>(ee.setMove(T.ARROW_LEFT),!1),50));break;case n.delete:j(s,Xe(()=>(ee.removeComponentList(),!1),50));break;case n.copy:j(s,Xe(()=>(ee.setCopy(),!1),50));break;case n.cut:j(s,Xe(()=>(ee.setCut(),!1),50));break;case n.parse:j(s,oe(()=>(ee.setParse(),!1),50));break;case n.back:j(s,oe(()=>(ee.setBack(),!1),50));break;case n.forward:j(s,oe(()=>(ee.setForward(),!1),50));break;case n.group:j(s,oe(()=>(ee.setGroup(),!1),50));break;case n.unGroup:j(s,oe(()=>(ee.setUnGroup(),!1),50));break;case n.lock:j(s,oe(()=>(ee.setLock(),!1),50));break;case n.unLock:j(s,oe(()=>(ee.setUnLock(),!1),50));break;case n.hide:j(s,oe(()=>(ee.setHide(),!1),50));break;case n.show:j(s,oe(()=>(ee.setShow(),!1),50));break}};Tn.forEach(n=>{t(J,n)}),xn.forEach(n=>{t(Q,n)}),An()},E=ae(),{onClickOutSide:kn}=ft(),Fn=e=>pe(void 0,null,function*(){e.preventDefault();try{mn();const t=e.dataTransfer.getData(Zt.DRAG_KEY);if(!t){yt();return}E.setEditCanvas(re.IS_CREATE,!1);const n=tt(t);let s=yield Rt(n);q(s,e.offsetX-s.attr.w/2,e.offsetY-s.attr.h/2),E.addComponentList(s,!1,!0),E.setTargetSelectChart(s.id),yt()}catch(t){Cn(),window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...")}}),Et=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},Pt=(e,t)=>{if(t){E.setTargetSelectChart(t.id);return}E.setTargetSelectChart(void 0)},Ln=(e,t)=>{var l;if(e.which==2||(l=window.$KeyboardActive)!=null&&l.space)return;Pt();const n=e.offsetX,s=e.offsetY,o=e.screenX,h=e.screenY,v=E.getEditCanvas.scale;E.setMousePosition(void 0,void 0,n,s);const m=$e.exports.throttle(d=>{E.setTargetSelectChart(),E.setEditCanvas(re.IS_SELECT,!0);const r=n+d.screenX-o,c=s+d.screenY-h;E.setMousePosition(r,c);const p={x1:0,y1:0,x2:0,y2:0};r>n&&c>s?(p.x1=n,p.y1=s,p.x2=Math.round(n+(d.screenX-o)/v),p.y2=Math.round(s+(d.screenY-h)/v)):r>n&&c<s?(p.x1=n,p.y1=Math.round(s-(h-d.screenY)/v),p.x2=Math.round(n+(d.screenX-o)/v),p.y2=s):r<n&&c>s?(p.x1=Math.round(n-(o-d.screenX)/v),p.y1=s,p.x2=n,p.y2=Math.round(s+(d.screenY-h)/v)):(p.x1=Math.round(n-(o-d.screenX)/v),p.y1=Math.round(s-(h-d.screenY)/v),p.x2=n,p.y2=s),E.getComponentList.forEach(g=>{if(!E.getTargetChart.selectId.includes(g.id)){const{x:C,y,w:D,h:B}=g.attr,b={x1:C,y1:y,x2:C+D,y2:y+B};b.x1-p.x1>=0&&b.y1-p.y1>=0&&b.x2-p.x2<=0&&b.y2-p.y2<=0&&!g.status.lock&&!g.status.hide&&E.setTargetSelectChart(g.id,!0)}})},30),i=()=>{m.cancel(),E.setEditCanvas(re.IS_SELECT,!1),E.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",i)};document.addEventListener("mousemove",m),document.addEventListener("mouseup",i)},$t=()=>({mouseClickHandle:(o,h)=>{var v;if(o.preventDefault(),o.stopPropagation(),!h.status.lock&&(v=window.$KeyboardActive)!=null&&v.ctrl)if(E.targetChart.selectId.includes(h.id)){const m=E.targetChart.selectId.filter(i=>i!==h.id);E.setTargetSelectChart(m)}else E.setTargetSelectChart(h.id,!0)},mousedownHandle:(o,h)=>{var y;if(o.preventDefault(),o.stopPropagation(),h.status.lock||(kn(),o.buttons===We.LEFT&&((y=window.$KeyboardActive)==null?void 0:y.ctrl)))return;const v=E.getTargetChart.selectId;if(o.buttons===We.RIGHT&&v.length>1&&v.includes(h.id)||(E.setTargetSelectChart(h.id),o.buttons===We.RIGHT))return;const m=E.getEditCanvas.scale,i=E.getEditCanvasConfig.width,l=E.getEditCanvasConfig.height,d=new Map;E.getTargetChart.selectId.forEach(D=>{const B=E.fetchTargetIndex(D);if(B!==-1){const{x:b,y:L,w:G,h:X}=jt(E.getComponentList[B]).attr;d.set(D,{x:b,y:L,w:G,h:X})}});const r=o.screenX,c=o.screenY;let p=[];E.getTargetChart.selectId.forEach(D=>{if(!d.has(D))return;const B=E.fetchTargetIndex(D);p.push($e.exports.cloneDeep(E.getComponentList[B]))}),E.setMousePosition(void 0,void 0,r,c);const g=$e.exports.throttle(D=>{E.setEditCanvas(re.IS_DRAG,!0),E.setMousePosition(D.screenX,D.screenY);let B=(D.screenX-r)/m,b=(D.screenY-c)/m;E.getTargetChart.selectId.forEach(L=>{if(!d.has(L))return;const G=E.fetchTargetIndex(L),{x:X,y:V,w,h:_}=d.get(L),H=E.getComponentList[G];let K=Math.round(X+B),S=Math.round(V+b);const M=50;K=K<-w+M?-w+M:K,S=S<-_+M?-_+M:S,K=K>i-M?i-M:K,S=S>l-M?l-M:S,H&&(H.attr=Object.assign(H.attr,{x:K,y:S}))})},20),C=()=>{try{E.setMousePosition(0,0,0,0),E.setEditCanvas(re.IS_DRAG,!1),p.length&&(E.getTargetChart.selectId.forEach(D=>{if(!d.has(D))return;const B=E.fetchTargetIndex(D),b=E.getComponentList[B];p.forEach(L=>{L.id===D&&(L.attr=Object.assign(L.attr,{offsetX:b.attr.x-L.attr.x,offsetY:b.attr.y-L.attr.y}))})}),E.moveComponentList(p)),document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",C)}catch(D){console.log(D)}};document.addEventListener("mousemove",g),document.addEventListener("mouseup",C)},mouseenterHandle:(o,h)=>{o.preventDefault(),o.stopPropagation(),E.getEditCanvas.isSelect||E.setTargetHoverChart(h.id)},mouseleaveHandle:(o,h)=>{o.preventDefault(),o.stopPropagation(),E.setEditCanvas(re.IS_DRAG,!1),E.setTargetHoverChart(void 0)}}),On=(e,t,n)=>{e.stopPropagation(),e.preventDefault(),E.setEditCanvas(re.IS_DRAG,!0);const s=E.getEditCanvas.scale,o=n.x,h=n.y,v=n.w,m=n.h,i=e.screenX,l=e.screenY;E.setMousePosition(i,l);const d=$e.exports.throttle(c=>{E.setMousePosition(c.screenX,c.screenY);let p=Math.round((c.screenX-i)/s),g=Math.round((c.screenY-l)/s);const C=/t/.test(t),y=/b/.test(t),D=/l/.test(t),B=/r/.test(t),b=m+(C?-g:y?g:0),L=v+(D?-p:B?p:0);n.h=b>0?b:0,n.w=L>0?L:0,n.x=o+(D?p:0),n.y=h+(C?g:0)},50),r=()=>{E.setEditCanvas(re.IS_DRAG,!1),E.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",r)};document.addEventListener("mousemove",d),document.addEventListener("mouseup",r)},Ue=(e,t)=>e?{zIndex:t+1,left:`${e.x}px`,top:`${e.y}px`}:{},ye=(e,t)=>e?{width:`${t?t*e.w:e.w}px`,height:`${t?t*e.h:e.h}px`}:{},Mn=(e,t,n,s)=>{const{w:o,h}=n,v=/t/.test(e),m=/b/.test(e),i=/l/.test(e),l=/r/.test(e);let d=0,r=0;return e.length===2?(d=i?0:o,r=v?0:h):((v||m)&&(d=o/2,r=v?0:h),(i||l)&&(d=i?0:o,r=Math.floor(h/2))),{left:`${d}px`,top:`${r}px`,cursor:s[t]+"-resize"}};const bn=["onMousedown"],Bn=ue({__name:"index",props:{item:{type:Object,required:!0},hiddenPoint:{type:Boolean,required:!1}},setup(e){const t=e;ke(r=>({"026d39a0":a(v)}));const n=Fe(),s=ae(),o=["t","r","b","l","lt","rt","lb","rb"],h=["n","e","s","w","nw","ne","sw","se"],v=$(()=>n.getAppTheme),m=$(()=>t.item.status.lock?!1:t.item.id===s.getTargetChart.hoverId),i=$(()=>{const r=t.item.id;return t.item.status.lock?!1:s.getTargetChart.selectId.find(c=>c===r)}),l=$(()=>t.item.status.lock),d=$(()=>t.item.status.hide);return(r,c)=>(A(),z("div",{class:le(["go-shape-box",{lock:a(l),hide:a(d)}])},[lt(r.$slots,"default",{},void 0,!0),e.hiddenPoint?Ce("",!0):(A(!0),z(he,{key:0},Ee(a(i)?o:[],(p,g)=>(A(),z("div",{class:le(`shape-point ${p}`),key:g,style:se(a(Mn)(p,g,e.item.attr,h)),onMousedown:C=>a(On)(C,p,e.item.attr)},null,46,bn))),128)),W("div",{class:"shape-modal",style:se(a(ye)(e.item.attr))},[W("div",{class:le(["shape-modal-select",{active:a(i)}])},null,2),W("div",{class:le(["shape-modal-change",{selectActive:a(i),hoverActive:a(m)}])},null,2)],4)],2))}});var at=ce(Bn,[["__scopeId","data-v-5f8854aa"]]);const Rn={class:"go-edit-group-box"},In=ue({__name:"index",props:{groupData:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){const t=ae(),{handleContextMenu:n}=ft(),{mouseenterHandle:s,mouseleaveHandle:o,mousedownHandle:h,mouseClickHandle:v}=$t(),m=(d,r,c)=>{const p=g=>r.filter(C=>g.includes(C.key));if(t.getTargetChart.selectId.length>1)return p([T.GROUP,T.DELETE]);{const g=[];c.status.lock?g.push(T.LOCK):g.push(T.UNLOCK),c.status.hide?g.push(T.HIDE):g.push(T.SHOW);const C=[T.UN_GROUP];return[...p(C),hn(),...d.filter(y=>!g.includes(y.key))]}},i=$(()=>{const d=t.getEditCanvasConfig.chartThemeColor;return At[d]}),l=$(()=>t.getEditCanvasConfig.chartThemeSetting);return(d,r)=>(A(),z("div",Rn,[(A(),N(a(at),{key:e.groupData.id,"data-id":e.groupData.id,index:e.groupIndex,item:e.groupData,hiddenPoint:!0,class:le(a(nt)(e.groupData.styles.animations)),style:se(P(P(P(P(P({},a(Ue)(e.groupData.attr,e.groupIndex)),a(ye)(e.groupData.attr)),a(He)(e.groupData.styles)),a(ot)(e.groupData.styles)),a(Ot)(e.groupData.styles))),onClick:r[0]||(r[0]=c=>a(v)(c,e.groupData)),onMousedown:r[1]||(r[1]=c=>a(h)(c,e.groupData)),onMouseenter:r[2]||(r[2]=c=>a(s)(c,e.groupData)),onMouseleave:r[3]||(r[3]=c=>a(o)(c,e.groupData)),onContextmenu:r[4]||(r[4]=c=>a(n)(c,e.groupData,m))},{default:x(()=>[(A(!0),z(he,null,Ee(e.groupData.groupList,c=>(A(),N(a(at),{key:c.id,"data-id":c.id,index:e.groupIndex,item:c,hiddenPoint:!0,style:se(P({},a(Ue)(c.attr,e.groupIndex)))},{default:x(()=>[(A(),N(we(c.chartConfig.chartKey),{class:le(["edit-content-chart",a(nt)(c.styles.animations)]),chartConfig:c,themeSetting:a(l),themeColor:a(i),style:se(P(P(P({},a(ye)(c.attr)),a(He)(c.styles)),a(ot)(c.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","item","style"]))),128))]),_:1},8,["data-id","index","item","class","style"]))]))}});const Hn={class:"go-edit-align-line"},Pn=ue({__name:"index",setup(e){ke(g=>({42514545:a(v)}));const t=Fe(),n=ae(),s=dt(),o=Ne({lineArr:["rowt","rowc","rowb","coll","colc","colr"],select:new Map,sorptioned:{x:!1,y:!1}}),h=g=>g?{left:`${g.x?g.x:0}px`,top:`${g.y?g.y:0}px`}:{},v=$(()=>t.getAppTheme),m=$(()=>s.getChartAlignRange),i=$(()=>n.getEditCanvas[re.IS_DRAG]),l=(g,C)=>Math.abs(g-C)<=m.value,d=$(()=>n.getTargetChart.selectId),r=$(()=>n.getComponentList[n.fetchTargetIndex()]),c=$(()=>{var g;return((g=r.value)==null?void 0:g.attr)||{}}),p=$(()=>({id:"0",attr:{w:gt(n.getEditCanvasConfig.width),h:gt(n.getEditCanvasConfig.height),x:0,y:0,offsetX:0,offsetY:0,zIndex:0}}));return ve(()=>n.getMousePosition,oe(()=>{try{if(!i.value||d.value.length!==1)return;const g=c.value.w,C=c.value.h,y=c.value.x,D=y+g/2,B=y+g,b=[y,D,B],L=c.value.y,G=L+C/2,X=L+C,V=[L,G,X];o.select.clear(),o.sorptioned.y=!1;const w=n.getComponentList.map(_=>({id:_.id,attr:_.attr}));w.push(p.value),o.lineArr.forEach(_=>{w.forEach(H=>{if(d.value[0]===H.id)return;const K=H.attr.w,S=H.attr.h,M=H.attr.x,u=M+K/2,f=M+K,k=[M,u,f],F=H.attr.y,Y=F+S/2,U=F+S,ie=[F,Y,U];_.includes("rowt")&&(l(L,F)&&(o.select.set(_,{y:F}),q(r.value,y,F)),l(L,Y)&&(o.select.set(_,{y:Y}),q(r.value,y,Y)),l(L,U)&&(o.select.set(_,{y:U}),q(r.value,y,U))),_.includes("rowc")&&(l(G,F)&&(o.select.set(_,{y:F}),q(r.value,y,F-C/2)),l(G,Y)&&(o.select.set(_,{y:Y}),q(r.value,y,Y-C/2)),l(G,U)&&(o.select.set(_,{y:U}),q(r.value,y,U-C/2))),_.includes("rowb")&&(l(X,F)&&(o.select.set(_,{y:F}),q(r.value,y,F-C)),l(X,Y)&&(o.select.set(_,{y:Y}),q(r.value,y,Y-C)),l(X,U)&&(o.select.set(_,{y:U}),q(r.value,y,U-C))),_.includes("coll")&&(l(y,M)&&(o.select.set(_,{x:M}),q(r.value,M,L)),l(y,u)&&(o.select.set(_,{x:u}),q(r.value,u,L)),l(y,f)&&(o.select.set(_,{x:f}),q(r.value,f,L))),_.includes("colc")&&(l(D,M)&&(o.select.set(_,{x:M}),q(r.value,M-g/2,L)),l(D,u)&&(o.select.set(_,{x:u}),q(r.value,u-g/2,L)),l(D,f)&&(o.select.set(_,{x:f}),q(r.value,f-g/2,L))),_.includes("colr")&&(l(B,M)&&(o.select.set(_,{x:M}),q(r.value,M-g,L)),l(B,u)&&(o.select.set(_,{x:u}),q(r.value,u-g,L)),l(B,f)&&(o.select.set(_,{x:f}),q(r.value,f-g,L)))})})}catch(g){console.log(g)}},200),{deep:!0}),ve(()=>i.value,g=>{g||(o.select.clear(),o.sorptioned.y=!1)}),(g,C)=>(A(),z("div",Hn,[(A(!0),z(he,null,Ee(o.lineArr,y=>(A(),z("div",{class:le(["line",[y.includes("row")?"row":"col",o.select.has(y)&&"visible"]]),key:y,style:se(h(o.select.get(y)))},null,6))),128))]))}});var $n=ce(Pn,[["__scopeId","data-v-403a9eed"]]);const Un=ue({__name:"index",setup(e){return(t,n)=>{const s=I("n-watermark");return A(),N(s,{id:"go-edit-watermark",content:a(en),cross:"",selectable:"","font-size":16,"line-height":16,width:500,height:150,"x-offset":12,"y-offset":80,rotate:-15},null,8,["content"])}}});var Nn=ce(Un,[["__scopeId","data-v-e5cd93da"]]);const Ut=e=>(Mt("data-v-71d41248"),e=e(),bt(),e),Kn=Ut(()=>W("div",{class:"select-background"},null,-1)),Gn=Ut(()=>W("div",{class:"select-border"},null,-1)),Yn=[Kn,Gn],Xn=ue({__name:"index",setup(e){ke(m=>({c29aca42:a(h)}));const t=Fe(),n=ae(),{isSelect:s,scale:o}=Ke(n.getEditCanvas),h=$(()=>t.getAppTheme),v=Z();return ve(()=>n.getMousePosition,m=>{if(!s.value)return;const{startX:i,startY:l,x:d,y:r}=m,c={zIndex:_t,x:0,y:0,w:0,h:0,offsetX:0,offsetY:0};d>i&&r>l?(c.x=i,c.y=l,c.w=Math.round((d-i)/o.value),c.h=Math.round((r-l)/o.value)):d>i&&r<l?(c.x=i,c.w=Math.round((d-i)/o.value),c.h=Math.round((l-r)/o.value),c.y=l-c.h):d<i&&r>l?(c.y=l,c.w=Math.round((i-d)/o.value),c.h=Math.round((r-l)/o.value),c.x=i-c.w):(c.w=Math.round((i-d)/o.value),c.h=Math.round((l-r)/o.value),c.x=i-c.w,c.y=l-c.h),v.value=P(P({},Ue(c,_t)),ye(c))},{deep:!0}),(m,i)=>a(s)?(A(),z("div",{key:0,class:"go-edit-select",style:se(v.value)},Yn,4)):Ce("",!0)}});var Wn=ce(Xn,[["__scopeId","data-v-71d41248"]]);const zn=ue({__name:"index",setup(e){const t=ae(),{getEditCanvasConfig:n,getEditCanvas:s}=Ke(t),o=$(()=>({w:n.value.width,h:n.value.height})),h=$(()=>{const m={transform:`scale(${s.value.scale})`};return P(P({},ye(o.value)),m)}),v=$(()=>{const m=s.value.isCreate&&{"z-index":99999};return P(P({},ye(o.value)),m)});return(m,i)=>(A(),z("div",{class:"go-edit-range go-transition",style:se(a(h)),onMousedown:i[0]||(i[0]=l=>a(Ln)(l,void 0))},[lt(m.$slots,"default",{},void 0,!0),O(a(Nn)),O(a($n)),O(a(Wn)),W("div",{class:"go-edit-range-model",style:se(a(v))},null,4)],36))}});var qn=ce(zn,[["__scopeId","data-v-52e445d0"]]),Nt=!!(typeof window!="undefined"&&window.document&&window.document.createElement),rt=!1,ut=!1;try{var je={get passive(){return rt=!0},get once(){return ut=rt=!0}};Nt&&(window.addEventListener("test",je,je),window.removeEventListener("test",je,!0))}catch(e){}function Vn(e,t,n,s){if(s&&typeof s!="boolean"&&!ut){var o=s.once,h=s.capture,v=n;!ut&&o&&(v=n.__once||function m(i){this.removeEventListener(t,m,h),n.call(this,i)},n.__once=v),e.addEventListener(t,v,rt?s:h)}e.addEventListener(t,n,s)}function Jn(e,t,n,s){var o=s&&typeof s!="boolean"?s.capture:s;e.removeEventListener(t,n,o),n.__once&&e.removeEventListener(t,n.__once,o)}function wt(e,t,n,s){return Vn(e,t,n,s),function(){Jn(e,t,n,s)}}var St=new Date().getTime();function Qn(e){var t=new Date().getTime(),n=Math.max(0,16-(t-St)),s=setTimeout(e,n);return St=t,s}var Zn=["","webkit","moz","o","ms"],Tt=Qn,xt=function(t,n){return t+(t?n[0].toUpperCase()+n.substr(1):n)+"AnimationFrame"};Nt&&Zn.some(function(e){var t=xt(e,"request");return t in window&&(xt(e,"cancel"),Tt=function(s){return window[t](s)}),!!Tt});Function.prototype.bind.call(Function.prototype.call,[].slice);Function.prototype.bind.call(Function.prototype.call,[].slice);const jn={class:"go-sketch-rule"},eo={key:1,class:"fix-edit-screens-block"},to=ue({__name:"index",setup(e){ke(S=>({"027e6d17":a(G),"66707d7c":a(b),"2846119e":c.value}));const t=ae(),n=It(),s=Fe(),o=20;let h=[0,0],v=[0,0];const m=Z(),i=Z(!0),l=Z(),d=Z(),r=Z(!1),c=Z("auto"),{width:p,height:g}=Ke(t.getEditCanvasConfig),C=Z(0),y=Z(0),D=Ne({h:[],v:[]}),B=$(()=>t.getEditCanvas.scale),b=$(()=>`${g.value*2}px`),L=$(()=>s.getDarkTheme?{bgColor:"#18181c",longfgColor:"#4d4d4d",shortfgColor:"#4d4d4d",fontColor:"#4d4d4d",shadowColor:"#18181c",borderColor:"#18181c",cornerActiveColor:"#18181c"}:{}),G=$(()=>s.getAppTheme),X=S=>{if(S.ctrlKey||S.metaKey){S.preventDefault();let M=B.value;if(S.wheelDelta>=0&&B.value<2){M=B.value+.05,t.setScale(M);return}S.wheelDelta<0&&B.value>.1&&(M=B.value-.05,t.setScale(M))}},V=()=>{if(!m.value)return;const S=m.value.getBoundingClientRect(),M=l.value.getBoundingClientRect();C.value=(S.left+o-M.left)/B.value,y.value=(S.top+o-M.top)/B.value},w=S=>{var F,Y;if(S.preventDefault(),S.stopPropagation(),S.which==2)r.value=!0;else if(!((F=window.$KeyboardActive)!=null&&F.space))return;(Y=document.activeElement)==null||Y.blur();const M=S.pageX,u=S.pageY,f=wt(window,"mousemove",U=>{const ie=U.pageX-M,Te=U.pageY-u,[Ge,Le]=h,[Ye,Oe]=v;h=[Le,ie],v=[Oe,Te],m.value.scrollLeft-=Le>Ge?Math.abs(Le-Ge):-Math.abs(Le-Ge),m.value.scrollTop-=Oe>Ye?Math.abs(Oe-Ye):-Math.abs(Oe-Ye)}),k=wt(window,"mouseup",()=>{f(),k(),h=[0,0],v=[0,0],r.value=!1})},_=()=>{const S=document.getElementById("go-chart-edit-layout");return S?{height:S.clientHeight-25,width:S.clientWidth}:{width:p.value,height:g.value}},H=()=>{i.value=!1,setTimeout(()=>{i.value=!0},10)},K=()=>{const{width:S,height:M}=d.value.getBoundingClientRect(),{width:u,height:f}=_();m.value.scrollLeft=S/2-u/2,m.value.scrollTop=M/2-f/2};return ve(()=>s.getDarkTheme,()=>{H()}),ve(()=>B.value,(S,M)=>{M!==S&&n.getRePositionCanvas?(n.setItemUnHandle(st.RE_POSITION_CANVAS,!1),V(),setTimeout(()=>{K(),H()},400)):oe(H,20)}),ve(()=>r.value,S=>{c.value=S?"grab":"auto"}),it(()=>{m.value&&(m.value.addEventListener("wheel",X,{passive:!1}),K())}),kt(()=>{m.value&&m.value.removeEventListener("wheel",X)}),window.onKeySpacePressHold=S=>{r.value=S},(S,M)=>{const u=I("sketch-rule");return A(),z("div",jn,[i.value?(A(),N(u,{key:0,thick:o,scale:a(B),width:_().width,height:_().height,startX:C.value,startY:y.value,lines:D,palette:a(L)},null,8,["scale","width","height","startX","startY","lines","palette"])):Ce("",!0),W("div",{ref_key:"$app",ref:m,class:"edit-screens",onScroll:V},[W("div",{ref_key:"$container",ref:d,class:"edit-screen-container",style:se({width:a(p)*2+"px"})},[W("div",{ref_key:"refSketchRuleBox",ref:l,class:"canvas",onMousedown:w,style:se({marginLeft:"-"+(_().width/2-25)+"px"})},[W("div",{style:se({pointerEvents:r.value?"none":"auto"})},[lt(S.$slots,"default",{},void 0,!0)],4)],36)],4)],544),a(s).getDarkTheme?(A(),z("div",eo)):Ce("",!0)])}}});var no=ce(to,[["__scopeId","data-v-9b7f266a"]]);const et={[R.ADD]:"\u65B0\u589E",[R.DELETE]:"\u5220\u9664",[R.UPDATE]:"\u66F4\u65B0",[R.MOVE]:"\u79FB\u52A8",[R.PASTE]:"\u7C98\u8D34",[R.COPY]:"\u590D\u5236",[R.CUT]:"\u526A\u5207",[R.TOP]:"\u7F6E\u9876",[R.BOTTOM]:"\u7F6E\u5E95",[R.UP]:"\u4E0A\u79FB",[R.DOWN]:"\u4E0B\u79FB",[R.GROUP]:"\u6210\u7EC4",[R.UN_GROUP]:"\u89E3\u7EC4",[R.LOCK]:"\u9501\u5B9A",[R.UNLOCK]:"\u89E3\u9501",[R.HIDE]:"\u9690\u85CF",[R.SHOW]:"\u663E\u793A",[Ie.CANVAS]:"\u753B\u5E03\u521D\u59CB\u5316"};var oo=Array.prototype,so=oo.reverse;function ao(e){return e==null?e:so.call(e)}var ro=ao;const Kt=e=>(Mt("data-v-5a4fd660"),e=e(),bt(),e),uo={class:"go-flex-items-center"},co=Kt(()=>W("span",{class:"btn-text"},"\u5386\u53F2\u8BB0\u5F55",-1)),io={class:"history-list-box"},lo=["title"],fo=Kt(()=>W("div",{class:"popover-modal"},null,-1)),po=ue({__name:"index",setup(e){const{DesktopOutlineIcon:t,PencilIcon:n,TrashIcon:s,CopyIcon:o,LayersIcon:h,DuplicateIcon:v,HelpOutlineIcon:m,LockClosedOutlineIcon:i,LockOpenOutlineIcon:l,EyeOffOutlineIcon:d,EyeOutlineIcon:r}=De.ionicons5,{StackedMoveIcon:c,Carbon3DCursorIcon:p,Carbon3DSoftwareIcon:g}=De.carbon,C=Dt(),y=b=>{if(b.targetType===Ie.CANVAS)return t;switch(b.actionType){case R.UPDATE:return n;case R.DELETE:return s;case R.PASTE:return o;case R.TOP:return h;case R.BOTTOM:return h;case R.UP:return h;case R.DOWN:return h;case R.MOVE:return c;case R.ADD:return v;case R.GROUP:return p;case R.UN_GROUP:return g;case R.LOCK:return i;case R.UNLOCK:return l;case R.HIDE:return d;case R.SHOW:return r;default:return n}},D=b=>{if(b.targetType===Ie.CANVAS)return et[Ie.CANVAS];if(b.actionType===R.GROUP||b.actionType===R.UN_GROUP)return`${et[b.actionType]}`;if(b.historyData.length)return`${et[b.actionType]} - ${b.historyData[0].chartConfig.title}`},B=$(()=>{const L=C.getBackStack.map(G=>({label:D(G),icon:y(G)}));return ro(L.filter(G=>G.label))});return(b,L)=>{const G=I("n-button"),X=I("n-icon"),V=I("n-text"),w=I("n-scrollbar"),_=I("n-popover"),H=I("n-tooltip");return A(),z("div",uo,[O(_,{class:"edit-history-popover","show-arrow":!1,size:"small",trigger:"click",placement:"top-start"},{trigger:x(()=>[O(G,{class:"mr-10",secondary:"",size:"small",disabled:a(B).length===0},{default:x(()=>[co]),_:1},8,["disabled"])]),default:x(()=>[W("div",io,[O(w,{style:{"max-height":"500px"}},{default:x(()=>[(A(!0),z(he,null,Ee(a(B),(K,S)=>(A(),z("div",{class:"list-item go-flex-items-center go-ellipsis-1",key:S,title:K.label},[O(X,{class:"item-icon",size:"16",depth:2,component:K.icon},null,8,["component"]),O(V,{depth:"2"},{default:x(()=>[Se(fe(K.label),1)]),_:2},1024)],8,lo))),128))]),_:1}),fo])]),_:1}),O(H,{trigger:"hover"},{trigger:x(()=>[O(X,{size:"21",depth:3},{default:x(()=>[O(a(m))]),_:1})]),default:x(()=>[W("span",null,"\u6700\u591A\u53EA\u4FDD\u7559"+fe(a(tn))+"\u6761\u8BB0\u5F55",1)]),_:1})])}}});var vo=ce(po,[["__scopeId","data-v-5a4fd660"]]);const ho={class:"go-edit-bottom"},go=ue({__name:"index",setup(e){ke(y=>({f3add9fc:o.value}));const{LockClosedOutlineIcon:t,LockOpenOutlineIcon:n}=De.ionicons5,s=Fe(),o=Z(s.getAppTheme),h=ae(),{lockScale:v,scale:m}=Ke(h.getEditCanvas);let i=[{label:"200%",value:200},{label:"150%",value:150},{label:"100%",value:100},{label:"50%",value:50},{label:"\u81EA\u9002\u5E94",value:0}];const l=Z(""),d=y=>{if(y===0){h.computedScale();return}h.setScale(y/100)},r=()=>{h.setEditCanvas(re.LOCK_SCALE,!v.value)},c=Z(100),p=y=>`${y}%`,g=y=>{h.setScale(y/100)},C=Ne({100:""});return nn(()=>{const y=(m.value*100).toFixed(0);l.value=`${y}%`,c.value=parseInt(y)}),(y,D)=>{const B=I("n-text"),b=I("n-space"),L=I("n-select"),G=I("n-icon"),X=I("n-button"),V=I("n-tooltip"),w=I("n-slider");return A(),z("div",ho,[O(b,null,{default:x(()=>[O(a(vo)),O(B,{id:"keyboard-dress-show",depth:"3"})]),_:1}),O(b,{class:"bottom-ri"},{default:x(()=>[O(wn),O(L,{disabled:a(v),class:"scale-btn",value:l.value,"onUpdate:value":[D[0]||(D[0]=_=>l.value=_),d],size:"mini",options:a(i)},null,8,["disabled","value","options"]),O(V,{trigger:"hover"},{trigger:x(()=>[O(X,{onClick:r,text:""},{default:x(()=>[O(G,{class:le(["lock-icon",{color:a(v)}]),size:"18",depth:2},{default:x(()=>[a(v)?(A(),N(a(t),{key:0})):(A(),N(a(n),{key:1}))]),_:1},8,["class"])]),_:1})]),default:x(()=>[W("span",null,fe(a(v)?"\u89E3\u9501":"\u9501\u5B9A")+"\u5F53\u524D\u6BD4\u4F8B",1)]),_:1}),O(w,{class:"scale-slider",value:c.value,"onUpdate:value":[D[1]||(D[1]=_=>c.value=_),g],"default-value":50,min:10,max:200,step:5,"format-tooltip":p,disabled:a(v),marks:C},null,8,["value","disabled","marks"])]),_:1})])}}});var _o=ce(go,[["__scopeId","data-v-99a534fc"]]);const mo=ue({__name:"index",props:{modelShow:Boolean},emits:["update:modelShow"],setup(e,{emit:t}){const n=e,{HelpOutlineIcon:s,CloseIcon:o}=De.ionicons5,h=dt(),v=Z(!1),m=Ne([{key:ge.ASIDE_ALL_COLLAPSED,value:h.getAsideAllCollapsed,type:"switch",name:"\u83DC\u5355\u6298\u53E0",desc:"\u9996\u9875\u83DC\u5355\u6298\u53E0\u65F6\u9690\u85CF\u81F3\u754C\u9762\u5916"},{key:ge.HIDE_PACKAGE_ONE_CATEGORY,value:h.getHidePackageOneCategory,type:"switch",name:"\u9690\u85CF\u5206\u7C7B",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u8868\u5355\u5206\u7C7B\u53EA\u6709\u5355\u9879\u65F6\u9690\u85CF"},{key:ge.CHANGE_LANG_RELOAD,value:h.getChangeLangReload,type:"switch",name:"\u5207\u6362\u8BED\u8A00",desc:"\u5207\u6362\u8BED\u8A00\u91CD\u65B0\u52A0\u8F7D\u9875\u9762",tip:"\u82E5\u9047\u5230\u90E8\u5206\u533A\u57DF\u8BED\u8A00\u5207\u6362\u5931\u8D25\uFF0C\u5219\u5EFA\u8BAE\u5F00\u542F"},{key:"divider1",type:"divider",name:"",desc:"",value:""},{key:ge.CHART_TOOLS_STATUS_HIDE,value:h.getChartToolsStatusHide,type:"switch",name:"\u9690\u85CF\u5DE5\u5177\u680F",desc:"\u9F20\u6807\u79FB\u5165\u65F6\uFF0C\u4F1A\u5C55\u793A\u5207\u6362\u5230\u5C55\u5F00\u6A21\u5F0F"},{key:ge.CHART_TOOLS_STATUS,value:h.getChartToolsStatus,type:"select",name:"\u5DE5\u5177\u680F\u5C55\u793A",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u5DE5\u5177\u680F\u5C55\u793A\u65B9\u5F0F",options:[{label:"\u4FA7\u8FB9\u680F",value:Pe.ASIDE},{label:"\u5E95\u90E8 Dock",value:Pe.DOCK}]},{key:"divider0",type:"divider",name:"",desc:"",value:""},{key:ge.CHART_MOVE_DISTANCE,value:h.getChartMoveDistance,type:"number",name:"\u79FB\u52A8\u8DDD\u79BB",min:1,step:1,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u65B9\u5411\u952E\u63A7\u5236\u79FB\u52A8\u8DDD\u79BB"},{key:ge.CHART_ALIGN_RANGE,value:h.getChartAlignRange,type:"number",name:"\u5438\u9644\u8DDD\u79BB",min:10,step:2,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u79FB\u52A8\u56FE\u8868\u65F6\u7684\u5438\u9644\u8DDD\u79BB"}]);ve(()=>n.modelShow,d=>{v.value=d});const i=()=>{t("update:modelShow",!1)},l=(d,r)=>{h.setItem(r.key,r.value)};return(d,r)=>{const c=I("n-h3"),p=I("n-icon"),g=I("n-space"),C=I("n-divider"),y=I("n-text"),D=I("n-switch"),B=I("n-input-number"),b=I("n-select"),L=I("n-tooltip"),G=I("n-list-item"),X=I("n-list"),V=I("n-modal");return A(),N(V,{show:v.value,"onUpdate:show":r[0]||(r[0]=w=>v.value=w),onAfterLeave:i},{default:x(()=>[O(X,{bordered:"",class:"go-system-setting"},{header:x(()=>[O(g,{justify:"space-between"},{default:x(()=>[O(c,{class:"go-mb-0"},{default:x(()=>[Se("\u7CFB\u7EDF\u8BBE\u7F6E")]),_:1}),O(p,{size:"20",class:"go-cursor-pointer",onClick:i},{default:x(()=>[O(a(o))]),_:1})]),_:1})]),default:x(()=>[(A(!0),z(he,null,Ee(m,w=>(A(),N(G,{key:w.key},{default:x(()=>[w.type==="divider"?(A(),N(C,{key:0,style:{margin:"0"}})):(A(),N(g,{key:1,size:40},{default:x(()=>[O(g,null,{default:x(()=>[O(y,{class:"item-left"},{default:x(()=>[Se(fe(w.name),1)]),_:2},1024),w.type==="switch"?(A(),N(D,{key:0,value:w.value,"onUpdate:value":[_=>w.value=_,_=>l(_,w)],size:"small"},null,8,["value","onUpdate:value"])):w.type==="number"?(A(),N(B,{key:1,value:w.value,"onUpdate:value":[_=>w.value=_,_=>l(_,w)],class:"input-num-width",size:"small",step:w.step||null,suffix:w.suffix||null,min:w.min||0},null,8,["value","onUpdate:value","step","suffix","min"])):w.type==="select"?(A(),N(b,{key:2,class:"select-min-width",value:w.value,"onUpdate:value":[_=>w.value=_,_=>l(_,w)],size:"small",options:w.options},null,8,["value","onUpdate:value","options"])):Ce("",!0)]),_:2},1024),O(g,null,{default:x(()=>[O(y,{class:"item-right"},{default:x(()=>[Se(fe(w.desc),1)]),_:2},1024),w.tip?(A(),N(L,{key:0,trigger:"hover"},{trigger:x(()=>[O(p,{size:"21"},{default:x(()=>[O(a(s))]),_:1})]),default:x(()=>[W("span",null,fe(w.tip),1)]),_:2},1024)):Ce("",!0)]),_:2},1024)]),_:2},1024))]),_:2},1024))),128))]),_:1})]),_:1},8,["show"])}}});var Co=ce(mo,[["__scopeId","data-v-7cea0aa5"]]);const Ae=ae(),yo=()=>{Ae.setTargetSelectChart(void 0),on(sn(Ae.getStorageInfo||[]),void 0,"json");const e=document.querySelector(".go-edit-range"),t=document.getElementById("go-edit-watermark");if(!e||!t){window.$message.error("\u5BFC\u51FA\u5931\u8D25\uFF01");return}const n=Ae.getEditCanvas.scale;Ae.setScale(1,!0),t.style.display="block",setTimeout(()=>{an(e,()=>{t&&(t.style.display="none"),Ae.setScale(n,!0)})},600)};var ct=(e=>(e.TXT="text/plain",e.JSON="application/json",e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e))(ct||{});const Eo=e=>e,wo=(e,t)=>{try{if(t.id){const n="vnodeBeforeMount"in t.events,s="vnodeMounted"in t.events;return n&&(e.events.advancedEvents.vnodeBeforeMount=t==null?void 0:t.events.vnodeBeforeMount),s&&(e.events.advancedEvents.vnodeMounted=t==null?void 0:t.events.vnodeMounted),(n||s)&&(t.events={baseEvent:{[Me.ON_CLICK]:void 0,[Me.ON_DBL_CLICK]:void 0,[Me.ON_MOUSE_ENTER]:void 0,[Me.ON_MOUSE_LEAVE]:void 0},advancedEvents:{[mt.VNODE_MOUNTED]:void 0,[mt.VNODE_BEFORE_MOUNT]:void 0}}),e}}catch(n){return e}},_e=(e,t,n=!1)=>{if(wo(e,t),n)return qe(e,t);const s=t.option;if(!s)return qe(e,t);if(t.option=void 0,s)return de(P({},qe(e,t)),{option:s})},Gt=()=>{const e=ae(),t=Dt(),n=It();return{updateComponent:(o,h=!1,v=!1)=>pe(void 0,null,function*(){h&&(e.componentList=[],t.clearBackStack(),t.clearForwardStack()),o.editCanvasConfig=Eo(o.editCanvasConfig),o.componentList.forEach(i=>pe(void 0,null,function*(){const l=d=>{window.$vue.component(d.chartConfig.chartKey)||(window.$vue.component(d.chartConfig.chartKey,gn(d.chartConfig)),window.$vue.component(d.chartConfig.conKey,_n(d.chartConfig)))};i.isGroup?i.groupList.forEach(d=>{l(d)}):l(i)}));const m=(i,l)=>pe(void 0,null,function*(){let d=yield Rt(i.chartConfig);l?l(v?_e(d,de(P({},i),{id:ze()})):_e(d,i)):v?e.addComponentList(_e(d,de(P({},i),{id:ze()})),!1,!0):e.addComponentList(_e(d,i),!1,!0)});for(const i in o)if(i===Vt.COMPONENT_LIST){let l=0;const d=o[i].length;for(const r of o[i]){let c=parseInt((parseFloat(`${++l/d}`)*100).toString());if(n.setItemUnHandle(st.PERCENTAGE,c),r.isGroup){let p=new Jt;v?p=_e(p,de(P({},r),{id:ze()})):p=_e(p,r);const g=[];for(const C of r.groupList)yield m(C,y=>{g.push(y)});p.groupList=g,e.addComponentList(p,!1,!0)}else yield m(r)}}else{if(i!=="editCanvasConfig"&&i!=="requestGlobalConfig")return;_e(e[i],o[i],!0)}n.setItemUnHandle(st.PERCENTAGE,0)})}},So=()=>{const e=Z(),{updateComponent:t}=Gt();return{importUploadFileListRef:e,importBeforeUpload:({file:o})=>{e.value=[];const h=o.file.type;return h!==ct.JSON&&h!==ct.TXT?(window.$message.warning("\u4EC5\u652F\u6301\u4E0A\u4F20 \u3010JSON\u3011 \u683C\u5F0F\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20\uFF01"),!1):!0},importCustomRequest:o=>{const{file:h}=o;rn(()=>{h.file?un(h.file).then(v=>{yn({message:"\u8BF7\u9009\u62E9\u5BFC\u5165\u65B9\u5F0F:",positiveText:"\u65B0\u589E\uFF08\u53EF\u64A4\u56DE\uFF09",negativeText:"\u8986\u76D6\uFF08\u4E0D\u53EF\u64A4\u56DE\uFF09",negativeButtonProps:{type:"info",ghost:!1},onPositiveCallback:()=>pe(void 0,null,function*(){try{v=tt(v),yield t(v,!1,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(m){console.log(m),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}}),onNegativeCallback:()=>pe(void 0,null,function*(){try{v=tt(v),yield t(v,!0,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(m){console.log(m),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}})})}):window.$message.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6216\u8054\u7CFB\u7BA1\u7406\u5458\uFF01")})}}},{updateComponent:To}=Gt(),xo=ae(),Ao=()=>{const e=h=>To(h.detail,!0,!1),t=()=>pe(void 0,null,function*(){dispatchEvent(new CustomEvent(Ve.CHART,{detail:xo.getStorageInfo}))}),n=()=>{addEventListener("blur",t),addEventListener(Ve.JSON,e)},s=()=>{removeEventListener(Ve.JSON,e),removeEventListener("blur",t)};return(h,v)=>{v==Ct.CHART_HOME_NAME&&s(),h==Ct.CHART_HOME_NAME&&n()}},Do=()=>{const e=Bt();ve(()=>e.name,Ao(),{immediate:!0})};var me=(e=>(e.BUTTON="button",e.IMPORTUPLOAD="importUpload",e))(me||{});const ko={class:"btn-item"},Fo=ue({__name:"index",setup(e){const{DownloadIcon:t,ShareIcon:n,PawIcon:s,SettingsSharpIcon:o,CreateIcon:h}=De.ionicons5,v=dt(),m=ae();Bt(),Do();let i=null;const l=Z(!1),d=Z(!0),r=Z(!0),{importUploadFileListRef:c,importCustomRequest:p,importBeforeUpload:g}=So(),C=$(()=>v.getChartToolsStatus===Pe.ASIDE),y=$(()=>v.getChartToolsStatusHide),D=$(()=>d.value&&y.value),B=$(()=>{if(!C.value)return V;const w=[];return V.map(_=>{w.unshift(_)}),w}),b=()=>{i=setTimeout(()=>{d.value&&(d.value=!1,r.value=!0)},200),setTimeout(()=>{r.value=!1},400)},L=()=>{clearTimeout(i),d.value||(d.value=!0)},G=()=>{window.$message.warning("\u5C06\u5F00\u542F\u5931\u7126\u66F4\u65B0\uFF01"),setTimeout(()=>{const w=ln(dn.CHART_EDIT_NAME,"href");if(!w)return;const _=fn();X(_),pn(w,[_],void 0,!0)},1e3)},X=w=>{const _=m.getStorageInfo,H=vn(be.GO_CHART_STORAGE_LIST)||[];if(H!=null&&H.length){const K=H.findIndex(S=>S.id===w);K!==-1?(H.splice(K,1,de(P({},_),{id:w})),Ze(be.GO_CHART_STORAGE_LIST,H)):(H.push(de(P({},_),{id:w})),Ze(be.GO_CHART_STORAGE_LIST,H))}else Ze(be.GO_CHART_STORAGE_LIST,[de(P({},_),{id:w})])},V=[{key:"import",type:me.IMPORTUPLOAD,name:"\u5BFC\u5165",icon:n},{key:"export",type:me.BUTTON,name:"\u5BFC\u51FA",icon:t,handle:yo},{key:"edit",type:me.BUTTON,name:"\u7F16\u8F91",icon:h,handle:G},{key:"setting",type:me.BUTTON,name:"\u8BBE\u7F6E",icon:o,handle:()=>{l.value=!0}}];return(w,_)=>{const H=I("n-icon"),K=I("n-text"),S=I("n-button"),M=I("n-upload"),u=I("n-tooltip");return A(),z(he,null,[W("div",{class:le(["go-chart-edit-tools",[a(v).getChartToolsStatus,a(D)?"isMini":"unMini"]]),onClick:_[1]||(_[1]=f=>d.value&&(d.value=!1)),onMouseenter:b,onMouseleave:L},[Je(O(H,{class:"asideLogo",size:"22"},{default:x(()=>[O(a(s))]),_:1},512),[[Qe,a(v).getChartToolsStatus===a(Pe).ASIDE&&a(D)]]),(A(!0),z(he,null,Ee(a(B),(f,k)=>(A(),N(u,{key:f.key,disabled:!a(C)||a(y)&&r.value,trigger:"hover",placement:"left"},{trigger:x(()=>[W("div",ko,[f.type===a(me).BUTTON?(A(),N(S,{key:0,circle:a(C),secondary:"",onClick:f.handle},{icon:x(()=>[a(C)?(A(),N(H,{key:0,size:"22"},{default:x(()=>[(A(),N(we(f.icon)))]),_:2},1024)):(A(),N(we(f.icon),{key:1}))]),default:x(()=>[Je(O(K,{depth:"3"},{default:x(()=>[Se(fe(f.name),1)]),_:2},1536),[[Qe,!a(C)]])]),_:2},1032,["circle","onClick"])):f.type===a(me).IMPORTUPLOAD?(A(),N(M,{key:1,"file-list":a(c),"onUpdate:fileList":_[0]||(_[0]=F=>cn(c)?c.value=F:null),"show-file-list":!1,customRequest:a(p),onBeforeUpload:a(g)},{default:x(()=>[O(S,{circle:a(C),secondary:""},{icon:x(()=>[a(C)?(A(),N(H,{key:0,size:"22"},{default:x(()=>[(A(),N(we(f.icon)))]),_:2},1024)):(A(),N(we(f.icon),{key:1}))]),default:x(()=>[Je(O(K,{depth:"3"},{default:x(()=>[Se(fe(f.name),1)]),_:2},1536),[[Qe,!a(C)]])]),_:2},1032,["circle"])]),_:2},1032,["file-list","customRequest","onBeforeUpload"])):Ce("",!0)])]),default:x(()=>[W("span",null,fe(f.name),1)]),_:2},1032,["disabled"]))),128))],34),O(a(Co),{modelShow:l.value,"onUpdate:modelShow":_[2]||(_[2]=f=>l.value=f)},null,8,["modelShow"])],64)}}});var Lo=ce(Fo,[["__scopeId","data-v-4c257f27"]]);const Oo=ue({__name:"index",setup(e){const t=ae(),{handleContextMenu:n}=ft();Sn();const{mouseenterHandle:s,mouseleaveHandle:o,mousedownHandle:h,mouseClickHandle:v}=$t(),m=(r,c,p)=>{if(t.getTargetChart.selectId.length>1)return c.filter(C=>[T.GROUP,T.DELETE].includes(C.key));const g=[];return p.status.lock?g.push(T.LOCK):g.push(T.UNLOCK),p.status.hide?g.push(T.HIDE):g.push(T.SHOW),r.filter(C=>!g.includes(C.key))},i=$(()=>t.getEditCanvasConfig.chartThemeSetting),l=$(()=>{const r=t.getEditCanvasConfig.chartThemeColor;return At[r]});$(()=>t.getEditCanvasConfig.filterShow);const d=$(()=>{const r=t.getEditCanvasConfig.background,c=t.getEditCanvasConfig.backgroundImage,C=t.getEditCanvasConfig.selectColor?{background:r||void 0}:{background:`url(${c}) no-repeat center center / cover !important`};return de(P({},C),{width:"inherit",height:"inherit"})});return it(()=>{Dn()}),(r,c)=>(A(),N(a(En),{id:"go-chart-edit-layout",flex:!0,showTop:!1,showBottom:!0,depth:1,xScroll:!0,disabledScroll:!0,onMousedown:a(Pt),onDrop:a(Fn),onDragover:a(Et),onDragenter:a(Et)},{aside:x(()=>[O(a(Lo))]),bottom:x(()=>[O(a(_o))]),default:x(()=>[O(a(no),null,{default:x(()=>[W("div",{id:"go-chart-edit-content",onContextmenu:c[0]||(c[0]=(...p)=>a(n)&&a(n)(...p))},[O(a(qn),null,{default:x(()=>[W("div",{style:se(P(P({},a(He)(a(t).getEditCanvasConfig)),a(d)))},[(A(!0),z(he,null,Ee(a(t).getComponentList,(p,g)=>(A(),z("div",{key:p.id},[p.isGroup?(A(),N(a(In),{key:0,groupData:p,groupIndex:g},null,8,["groupData","groupIndex"])):(A(),N(a(at),{key:1,"data-id":p.id,index:g,style:se(P(P({},a(Ue)(p.attr,g)),a(Ot)(p.styles))),item:p,onClick:C=>a(v)(C,p),onMousedown:C=>a(h)(C,p),onMouseenter:C=>a(s)(C,p),onMouseleave:C=>a(o)(C,p),onContextmenu:C=>a(n)(C,p,m)},{default:x(()=>[(A(),N(we(p.chartConfig.chartKey),{class:le(["edit-content-chart",a(nt)(p.styles.animations)]),chartConfig:p,themeSetting:a(i),themeColor:a(l),style:se(P(P(P({},a(ye)(p.attr)),a(He)(p.styles)),a(ot)(p.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","style","item","onClick","onMousedown","onMouseenter","onMouseleave","onContextmenu"]))]))),128))],4)]),_:1})],32)]),_:1})]),_:1},8,["onMousedown","onDrop","onDragover","onDragenter"]))}});var zo=ce(Oo,[["__scopeId","data-v-697ec73e"]]);export{zo as default};
