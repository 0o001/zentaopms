var oe=Object.defineProperty,ie=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var k=(e,t,n)=>t in e?oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,h=(e,t)=>{for(var n in t||(t={}))re.call(t,n)&&k(e,n,t[n]);if(O)for(var n of O(t))ae.call(t,n)&&k(e,n,t[n]);return e},T=(e,t)=>ie(e,se(t));var x=(e,t,n)=>new Promise((o,i)=>{var a=l=>{try{d(n.next(l))}catch(r){i(r)}},s=l=>{try{d(n.throw(l))}catch(r){i(r)}},d=l=>l.done?o(l.value):Promise.resolve(l.value).then(a,s);d((n=n.apply(e,t)).next())});import{g as D}from"./storage-28a90beb.js";import{az as y,aH as ce,j as z,d as S,o as u,m as w,A as B,ad as $,f as c,aI as G,aJ as m,aK as L,aL as M,aM as A,c as f,aN as V,aO as U,L as j,F as q,a5 as C,x as K,ab as E,z as X,v as p,aP as v,a6 as _,e as W,aQ as I,aR as de,S as le}from"./index.js";import{u as Y,c as he,C as F}from"./chartEditStore-1f8105d2.js";import{t as R,_ as ue,u as we,f as pe}from"./index-5c8ab160.js";import"./plugin-9e9b27b9.js";import"./icon-0617f5fe.js";import"./chartLayoutStore-0f501f0a.js";import"./table_scrollboard-3667f4b7.js";/* empty css                                                                */import"./SettingItemBox-aedd53df.js";import"./CollapseItem-05ae1c53.js";import"./useTargetData.hook-65515aeb.js";const ve=(e,t,n,o)=>{const i=e,a=t,s={width:1,height:1},d=parseFloat((i/a).toFixed(5)),l=()=>{const ne=parseFloat((window.innerWidth/window.innerHeight).toFixed(5));n&&(ne>d?(s.width=parseFloat((window.innerHeight*d/i).toFixed(5)),s.height=parseFloat((window.innerHeight/a).toFixed(5)),n.style.transform=`scale(${s.width}, ${s.height})`):(s.height=parseFloat((window.innerWidth/d/a).toFixed(5)),s.width=parseFloat((window.innerWidth/i).toFixed(5)),n.style.transform=`scale(${s.width}, ${s.height})`),o&&o(s))},r=R(()=>{l()},200);return{calcRate:l,windowResize:()=>{window.addEventListener("resize",r)},unWindowResize:()=>{window.removeEventListener("resize",r)}}},ge=(e,t,n,o)=>{const i=e,a=t,s={width:1,height:1},d=parseFloat((i/a).toFixed(5)),l=()=>{n&&(s.height=parseFloat((window.innerWidth/d/a).toFixed(5)),s.width=parseFloat((window.innerWidth/i).toFixed(5)),n.style.transform=`scale(${s.width}, ${s.height})`,o&&o(s))},r=R(()=>{l()},200);return{calcRate:l,windowResize:()=>{window.addEventListener("resize",r)},unWindowResize:()=>{window.removeEventListener("resize",r)}}},fe=(e,t,n,o)=>{const i=e,a=t,s={height:1,width:1},d=parseFloat((i/a).toFixed(5)),l=()=>{n&&(s.width=parseFloat((window.innerHeight*d/i).toFixed(5)),s.height=parseFloat((window.innerHeight/a).toFixed(5)),n.style.transform=`scale(${s.width}, ${s.height})`,o&&o(s))},r=R(()=>{l()},200);return{calcRate:l,windowResize:()=>{window.addEventListener("resize",r)},unWindowResize:()=>{window.removeEventListener("resize",r)}}},ye=(e,t,n,o)=>{const i={width:1,height:1},a=()=>{n&&(i.width=parseFloat((window.innerWidth/e).toFixed(5)),i.height=parseFloat((window.innerHeight/t).toFixed(5)),n.style.transform=`scale(${i.width}, ${i.height})`,o&&o(i))},s=R(()=>{a()},200);return{calcRate:a,windowResize:()=>{window.addEventListener("resize",s)},unWindowResize:()=>{window.removeEventListener("resize",s)}}},J={},P={echarts:ce},Q=e=>{if(!e.events)return{};const t={};for(const i in e.events.baseEvent){const a=e.events.baseEvent[i];a&&(t[i]=_e(a))}const n=e.events.advancedEvents||{},o={[y.VNODE_BEFORE_MOUNT](i){J[e.id]=i.component;const a=(n[y.VNODE_BEFORE_MOUNT]||"").trim();N(a,i)},[y.VNODE_MOUNTED](i){const a=(n[y.VNODE_MOUNTED]||"").trim();N(a,i)}};return h(h({},t),o)};function _e(e){try{return new Function(`
      return (
        async function(mouseEvent){
          ${e}
        }
      )`)()}catch(t){console.error(t)}}function N(e,t){try{Function(`
      "use strict";
      return (
        async function(e, components, node_modules){
          const {${Object.keys(P).join()}} = node_modules;
          ${e}
        }
      )`)().bind(t==null?void 0:t.component)(t,J,P)}catch(n){console.error(n)}}const Z=(e,t)=>({zIndex:t+1,left:`${e.x}px`,top:`${e.y}px`}),me=(e,t)=>({width:`${t?t*e.w:e.w}px`,height:`${t?t*e.h:e.h}px`}),Ce=(e,t,n)=>{if(!e)return{};const o=t?40*3:0;return{width:`${n?n*e.w:e.w}px`,height:`${n?n*e.h-o:e.h-o}px`}},ee=e=>({display:e.hide?"none":"block"}),te=e=>{const t={};return e&&e.overFlowHidden&&(t.overflow="hidden"),t},Se=e=>{const t=e.selectColor?{background:e.background}:{background:`url(${e.backgroundImage}) center center / cover no-repeat !important`};return h({position:"relative",width:e.width?`${e.width||100}px`:"100%",height:e.height?`${e.height}px`:"100%"},t)};const Re=S({__name:"index",props:{groupData:{type:Object,required:!0},themeSetting:{type:Object,required:!0},themeColor:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){return(t,n)=>(u(!0),w(q,null,B(e.groupData.groupList,o=>(u(),w("div",{class:$(["chart-item",c(G)(o.styles.animations)]),key:o.id,style:m(h(h(h(h(h(h({},c(Z)(o.attr,e.groupIndex)),c(L)(o.styles)),c(M)(o.styles)),c(ee)(o.status)),c(te)(o.preview)),c(A)(o.styles)))},[(u(),f(j(o.chartConfig.chartKey),V({id:o.id,chartConfig:o,themeSetting:e.themeSetting,themeColor:e.themeColor,style:h({},c(me)(o.attr))},U(c(Q)(o))),null,16,["id","chartConfig","themeSetting","themeColor","style"]))],6))),128))}});var xe=z(Re,[["__scopeId","data-v-78cb40c3"]]);const Fe=S({__name:"index",setup(e){const{initDataPond:t,clearMittDataPondMap:n}=we(),o=Y(),i=d=>{var l;return!!((l=d.chartConfig.filters)!=null&&l.length)},a=C(()=>o.editCanvasConfig.chartThemeSetting),s=C(()=>{const d=o.editCanvasConfig.chartThemeColor;return he[d]});return n(),K(()=>{t(o.requestGlobalConfig)}),(d,l)=>(u(!0),w(q,null,B(c(o).componentList,(r,g)=>(u(),w("div",{key:r.id,class:"chart-item",style:m(h(h(h(h(h(h({},c(Z)(r.attr,g)),c(L)(r.styles)),c(M)(r.styles)),c(ee)(r.status)),c(te)(r.preview)),c(A)(r.styles)))},[i(r)?(u(),f(c(ue),{key:0,componentIdx:r.id,attr:r.attr,filters:r.chartConfig.filters,type:r.chartConfig.category},null,8,["componentIdx","attr","filters","type"])):E("",!0),X("div",{class:$(c(G)(r.styles.animations))},[r.isGroup?(u(),f(c(xe),{key:0,groupData:r,groupIndex:g,themeSetting:c(a),themeColor:c(s)},null,8,["groupData","groupIndex","themeSetting","themeColor"])):(u(),f(j(r.chartConfig.chartKey),V({key:1,id:r.id,chartConfig:r,themeSetting:c(a),themeColor:c(s),style:h({},c(Ce)(r.attr,i(r)))},U(c(Q)(r))),null,16,["id","chartConfig","themeSetting","themeColor","style"]))],2)],4))),128))}});var H=z(Fe,[["__scopeId","data-v-0a7041ed"]]);const Ee=e=>{const t=p(!1),n=setInterval(()=>{if(window.$vue.component){clearInterval(n);const o=i=>{window.$vue.component(i.chartConfig.chartKey)||window.$vue.component(i.chartConfig.chartKey,pe(i.chartConfig))};e.componentList.forEach(i=>x(void 0,null,function*(){i.isGroup?i.groupList.forEach(a=>{o(a)}):o(i)})),t.value=!0}},200);return{show:t}},ze=e=>{const t=p(),n=p(),o=p(e.editCanvasConfig.width),i=p(e.editCanvasConfig.height);return K(()=>{switch(e.editCanvasConfig.previewScaleType){case v.FIT:(()=>{const{calcRate:a,windowResize:s,unWindowResize:d}=ve(o.value,i.value,n.value);a(),s(),_(()=>{d()})})();break;case v.SCROLL_Y:(()=>{const{calcRate:a,windowResize:s,unWindowResize:d}=ge(o.value,i.value,n.value,l=>{const r=t.value;r.style.width=`${o.value*l.width}px`,r.style.height=`${i.value*l.height}px`});a(),s(),_(()=>{d()})})();break;case v.SCROLL_X:(()=>{const{calcRate:a,windowResize:s,unWindowResize:d}=fe(o.value,i.value,n.value,l=>{const r=t.value;r.style.width=`${o.value*l.width}px`,r.style.height=`${i.value*l.height}px`});a(),s(),_(()=>{d()})})();break;case v.FULL:(()=>{const{calcRate:a,windowResize:s,unWindowResize:d}=ye(o.value,i.value,n.value);a(),s(),_(()=>{d()})})();break}}),{entityRef:t,previewRef:n}},$e=e=>{const t=Y();t.requestGlobalConfig=e[F.REQUEST_GLOBAL_CONFIG],t.editCanvasConfig=e[F.EDIT_CANVAS_CONFIG],t.componentList=e[F.COMPONENT_LIST]};const Le=S({__name:"index",setup(e){let t=D();const n=C(()=>h(h({},Se(t.editCanvasConfig)),L(t.editCanvasConfig))),o=C(()=>{const d=t.editCanvasConfig.previewScaleType;return d===v.SCROLL_Y||d===v.SCROLL_X});$e(t);const{entityRef:i,previewRef:a}=ze(t),{show:s}=Ee(t);return(d,l)=>(u(),w("div",{class:$(`go-preview ${c(t).editCanvasConfig.previewScaleType}`)},[c(o)?(u(),w("div",{key:0,ref_key:"entityRef",ref:i,class:"go-preview-entity"},[X("div",{ref_key:"previewRef",ref:a,class:"go-preview-scale"},[c(s)?(u(),w("div",{key:0,style:m(c(n))},[W(c(H))],4)):E("",!0)],512)],512)):(u(),w("div",{key:1,ref_key:"previewRef",ref:a,class:"go-preview-scale"},[c(s)?(u(),w("div",{key:0,style:m(c(n))},[W(c(H))],4)):E("",!0)],512))],2))}});var be=z(Le,[["__scopeId","data-v-25130ef2"]]);const Ve=S({__name:"wrapper",setup(e){let t=p(Date.now());return[I.JSON,I.CHART].forEach(n=>{!window.opener||window.opener.addEventListener(n,o=>x(this,null,function*(){const i=yield D();de(le.GO_CHART_STORAGE_LIST,[T(h({},o.detail),{id:i.id})]),t.value=Date.now()}))}),(n,o)=>(u(),f(be,{key:c(t)}))}});export{Ve as default};
