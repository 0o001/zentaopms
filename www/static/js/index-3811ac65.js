var Wt=Object.defineProperty,zt=Object.defineProperties;var Vt=Object.getOwnPropertyDescriptors;var ht=Object.getOwnPropertySymbols;var qt=Object.prototype.hasOwnProperty,Jt=Object.prototype.propertyIsEnumerable;var gt=(e,t,n)=>t in e?Wt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,P=(e,t)=>{for(var n in t||(t={}))qt.call(t,n)&&gt(e,n,t[n]);if(ht)for(var n of ht(t))Jt.call(t,n)&&gt(e,n,t[n]);return e},fe=(e,t)=>zt(e,Vt(t));var le=(e,t,n)=>new Promise((o,s)=>{var f=g=>{try{C(n.next(g))}catch(p){s(p)}},l=g=>{try{C(n.throw(g))}catch(p){s(p)}},C=g=>g.done?o(g.value):Promise.resolve(g.value).then(f,l);C((n=n.apply(e,t)).next())});import{u as re,E as j,d as Xe,a as Ft,C as Qt,j as Zt,c as Lt,H as B,k as Ie}from"./chartEditStore-e4b119af.js";import{x as lt,a6 as Ot,bd as jt,aj as x,c5 as Mt,c6 as bt,cl as _t,U as We,aC as ze,aV as Ve,ay as Me,az as mt,ck as en,c2 as nt,cm as V,ca as qe,ak as tn,j as ce,d as ue,bT as ke,f as a,u as Fe,a5 as U,o as D,m as z,n as dt,F as he,A as Ee,ad as de,aJ as ae,aa as Ce,z as W,c as N,w as A,L as Se,aI as ot,aK as He,aL as st,aM as Rt,a4 as ft,y as Ne,al as Ct,R as ve,r as I,cn as nn,a3 as Ke,v as Z,co as yt,G as Bt,H as It,e as O,p as we,t as pe,aB as on,b0 as sn,cp as ge,cq as Pe,cr as an,c1 as rn,cs as un,am as cn,ct as ln,J as Ht,Q as Et,aQ as Je,X as Qe,Y as Ze,c0 as dn,V as fn,cu as pn,cv as vn,W as hn,c4 as gn,S as be,aR as je}from"./index.js";import{u as pt,d as _n}from"./index-031a6446.js";import{t as oe,f as mn,b as Cn,l as Pt,m as Ue}from"./index-102b64e6.js";import{u as Ut,C as at}from"./chartLayoutStore-0c9d1202.js";import{a as yn,b as St,l as En,g as Sn}from"./plugin-180ddff7.js";import{C as wn}from"./index-4923c035.js";import{i as De}from"./icon-ff91aece.js";import{E as Tn}from"./index-ff5c1657.js";import"./index-cbf4bcfa.js";import"./index-b26dbf42.js";import"./tables_list-71790294.js";import"./SizeSetting.vue_vue_type_style_index_0_scoped_true_lang-7d6b5abe.js";import"./useTargetData.hook-6b7922ca.js";const xe=re(),xn=()=>{lt(()=>{xe.setEditCanvas(j.EDIT_LAYOUT_DOM,document.getElementById("go-chart-edit-layout")),xe.setEditCanvas(j.EDIT_CONTENT_DOM,document.getElementById("go-chart-edit-content"));const e=xe.listenerScale();Ot(()=>{xe.setEditCanvas(j.EDIT_LAYOUT_DOM,null),xe.setEditCanvas(j.EDIT_CONTENT_DOM,null),e()})})};var $t={exports:{}};(function(e){(function(t){var n,o={},s={16:!1,18:!1,17:!1,91:!1},f="all",l={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},C={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},g=function(i){return C[i]||i.toUpperCase().charCodeAt(0)},p=[];for(n=1;n<20;n++)C["f"+n]=111+n;function _(i,d){for(var k=i.length;k--;)if(i[k]===d)return k;return-1}function r(i,d){if(i.length!=d.length)return!1;for(var k=0;k<i.length;k++)if(i[k]!==d[k])return!1;return!0}var u={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function h(i){for(n in s)s[n]=i[u[n]]}function c(i){var d,k,F,Y,$,ie;if(d=i.keyCode,_(p,d)==-1&&p.push(d),(d==93||d==224)&&(d=91),d in s){s[d]=!0;for(F in l)l[F]==d&&(S[F]=!0);return}if(h(i),!!S.filter.call(this,i)&&d in o){for(ie=q(),Y=0;Y<o[d].length;Y++)if(k=o[d][Y],k.scope==ie||k.scope=="all"){$=k.mods.length>0;for(F in s)(!s[F]&&_(k.mods,+F)>-1||s[F]&&_(k.mods,+F)==-1)&&($=!1);(k.mods.length==0&&!s[16]&&!s[18]&&!s[17]&&!s[91]||$)&&k.method(i,k)===!1&&(i.preventDefault?i.preventDefault():i.returnValue=!1,i.stopPropagation&&i.stopPropagation(),i.cancelBubble&&(i.cancelBubble=!0))}}}function y(i){var d=i.keyCode,k,F=_(p,d);if(F>=0&&p.splice(F,1),(d==93||d==224)&&(d=91),d in s){s[d]=!1;for(k in l)l[k]==d&&(S[k]=!1)}}function v(){for(n in s)s[n]=!1;for(n in l)S[n]=!1}function S(i,d,k){var F,Y;F=m(i),k===void 0&&(k=d,d="all");for(var $=0;$<F.length;$++)Y=[],i=F[$].split("+"),i.length>1&&(Y=H(i),i=[i[i.length-1]]),i=i[0],i=g(i),i in o||(o[i]=[]),o[i].push({shortcut:F[$],scope:d,method:k,key:F[$],mods:Y})}function b(i,d){var k,F,Y=[],$,ie,Te;for(k=m(i),ie=0;ie<k.length;ie++){if(F=k[ie].split("+"),F.length>1&&(Y=H(F),i=F[F.length-1]),i=g(i),d===void 0&&(d=q()),!o[i])return;for($=0;$<o[i].length;$++)Te=o[i][$],Te.scope===d&&r(Te.mods,Y)&&(o[i][$]={})}}function M(i){return typeof i=="string"&&(i=g(i)),_(p,i)!=-1}function L(){return p.slice(0)}function G(i){var d=(i.target||i.srcElement).tagName;return!(d=="INPUT"||d=="SELECT"||d=="TEXTAREA")}for(n in l)S[n]=!1;function X(i){f=i||"all"}function q(){return f||"all"}function w(i){var d,k,F;for(d in o)for(k=o[d],F=0;F<k.length;)k[F].scope===i?k.splice(F,1):F++}function m(i){var d;return i=i.replace(/\s/g,""),d=i.split(","),d[d.length-1]==""&&(d[d.length-2]+=","),d}function H(i){for(var d=i.slice(0,i.length-1),k=0;k<d.length;k++)d[k]=l[d[k]];return d}function K(i,d,k){i.addEventListener?i.addEventListener(d,k,!1):i.attachEvent&&i.attachEvent("on"+d,function(){k(window.event)})}K(document,"keydown",function(i){c(i)}),K(document,"keyup",y),K(window,"focus",v);var T=t.key;function R(){var i=t.key;return t.key=T,i}t.key=S,t.key.setScope=X,t.key.getScope=q,t.key.deleteScope=w,t.key.filter=G,t.key.isPressed=M,t.key.getPressedKeyCodes=L,t.key.noConflict=R,t.key.unbind=b,e.exports=S})(jt)})($t);var ee=$t.exports;const te=re(),se=e=>`${Mt.CTRL}+${e}`,Re=e=>`${Mt.SHIFT}+${e}`,J={[x.ARROW_UP]:se("up"),[x.ARROW_RIGHT]:se("right"),[x.ARROW_DOWN]:se("down"),[x.ARROW_LEFT]:se("left"),[x.COPY]:se("c"),[x.CUT]:se("x"),[x.PARSE]:se("v"),[x.DELETE]:"delete",[x.BACK]:se("z"),[x.FORWORD]:se(Re("z")),[x.GROUP]:se("g"),[x.UN_GROUP]:se(Re("g")),[x.LOCK]:se("l"),[x.UNLOCK]:se(Re("l")),[x.HIDE]:se("h"),[x.SHOW]:se(Re("h"))},ne=e=>`${bt.CTRL}+${e}`,Be=e=>`${bt.SHIFT}+${e}`,Q={[x.ARROW_UP]:ne("arrowup"),[x.ARROW_RIGHT]:ne("arrowright"),[x.ARROW_DOWN]:ne("arrowdown"),[x.ARROW_LEFT]:ne("arrowleft"),[x.COPY]:ne("c"),[x.CUT]:ne("x"),[x.PARSE]:ne("v"),[x.DELETE]:ne("backspace"),[x.BACK]:ne("z"),[x.FORWORD]:ne(Be("z")),[x.GROUP]:ne("g"),[x.UN_GROUP]:ne(Be("g")),[x.LOCK]:ne("l"),[x.UNLOCK]:ne(Be("l")),[x.HIDE]:ne("h"),[x.SHOW]:ne(Be("h"))},An=[J.up,J.right,J.down,J.left,J.delete,J.copy,J.cut,J.parse,J.back,J.forward,J.group,J.unGroup,J.lock,J.unLock,J.hide,J.show],Dn=[Q.up,Q.right,Q.down,Q.left,Q.delete,Q.copy,Q.cut,Q.parse,Q.back,Q.forward,Q.group,Q.unGroup,Q.lock,Q.unLock,Q.hide,Q.show],kn=()=>{window.$KeyboardActive={ctrl:!1,space:!1},document.onkeydown=e=>{const{keyCode:t}=e;if(t==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(t)&&window.$KeyboardActive)switch(_t(e.keyCode),t){case 17:window.$KeyboardActive.ctrl=!0;break;case 32:window.$KeyboardActive.space=!0;break}},document.onkeyup=e=>{const{keyCode:t}=e;if(t==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(t)&&window.$KeyboardActive)switch(_t(),t){case 17:window.$KeyboardActive.ctrl=!1;break;case 32:window.$KeyboardActive.space=!1;break}}},Fn=()=>{const t=(n,o)=>{switch(o){case n.up:ee(o,oe(()=>(te.setMove(x.ARROW_UP),!1),50));break;case n.right:ee(o,oe(()=>(te.setMove(x.ARROW_RIGHT),!1),50));break;case n.down:ee(o,oe(()=>(te.setMove(x.ARROW_DOWN),!1),50));break;case n.left:ee(o,oe(()=>(te.setMove(x.ARROW_LEFT),!1),50));break;case n.delete:ee(o,Xe(()=>(te.removeComponentList(),!1),50));break;case n.copy:ee(o,Xe(()=>(te.setCopy(),!1),50));break;case n.cut:ee(o,Xe(()=>(te.setCut(),!1),50));break;case n.parse:ee(o,oe(()=>(te.setParse(),!1),50));break;case n.back:ee(o,oe(()=>(te.setBack(),!1),50));break;case n.forward:ee(o,oe(()=>(te.setForward(),!1),50));break;case n.group:ee(o,oe(()=>(te.setGroup(),!1),50));break;case n.unGroup:ee(o,oe(()=>(te.setUnGroup(),!1),50));break;case n.lock:ee(o,oe(()=>(te.setLock(),!1),50));break;case n.unLock:ee(o,oe(()=>(te.setUnLock(),!1),50));break;case n.hide:ee(o,oe(()=>(te.setHide(),!1),50));break;case n.show:ee(o,oe(()=>(te.setShow(),!1),50));break}};An.forEach(n=>{t(J,n)}),Dn.forEach(n=>{t(Q,n)}),kn()},Ln=e=>e,On=(e,t)=>{try{if(t.id){const n="vnodeBeforeMount"in t.events,o="vnodeMounted"in t.events;return n&&(e.events.advancedEvents.vnodeBeforeMount=t==null?void 0:t.events.vnodeBeforeMount),o&&(e.events.advancedEvents.vnodeMounted=t==null?void 0:t.events.vnodeMounted),(n||o)&&(t.events={baseEvent:{[Me.ON_CLICK]:void 0,[Me.ON_DBL_CLICK]:void 0,[Me.ON_MOUSE_ENTER]:void 0,[Me.ON_MOUSE_LEAVE]:void 0},advancedEvents:{[mt.VNODE_MOUNTED]:void 0,[mt.VNODE_BEFORE_MOUNT]:void 0}}),e}}catch(n){return e}},_e=(e,t,n=!1)=>{if(On(e,t),n)return Ve(e,t);const o=t.option;if(!o)return Ve(e,t);if(t.option=void 0,o)return fe(P({},Ve(e,t)),{option:o})},vt=()=>{const e=re(),t=Ft(),n=Ut(),o=(l,C=!1,g=!1)=>le(void 0,null,function*(){C&&(e.componentList=[],e.editCanvasConfig.globalFilter=[],t.clearBackStack(),t.clearForwardStack()),l.editCanvasConfig=Ln(l.editCanvasConfig),l.componentList.forEach(r=>le(void 0,null,function*(){const u=h=>{window.$vue.component(h.chartConfig.chartKey)||(window.$vue.component(h.chartConfig.chartKey,mn(h.chartConfig)),window.$vue.component(h.chartConfig.conKey,Cn(h.chartConfig)))};r.isGroup?r.groupList.forEach(h=>{u(h)}):u(r)}));const p=l.editCanvasConfig.globalFilter;p.length>0&&e.addFilterList(p);const _=(r,u)=>le(void 0,null,function*(){let h=yield Pt(r.chartConfig);u?u(g?_e(h,fe(P({},r),{id:We()})):_e(h,r)):g?e.addComponentList(_e(h,fe(P({},r),{id:We()})),!1,!0):e.addComponentList(_e(h,r),!1,!0)});for(const r in l)if(r===Qt.COMPONENT_LIST){let u=0;const h=l[r].length;for(const c of l[r]){let y=parseInt((parseFloat(`${++u/h}`)*100).toString());if(n.setItemUnHandle(at.PERCENTAGE,y),c.isGroup){let v=new Zt;g?v=_e(v,fe(P({},c),{id:We()})):v=_e(v,c);const S=[];for(const b of c.groupList)yield _(b,M=>{S.push(M)});v.groupList=S,e.addComponentList(v,!1,!0)}else yield _(c)}}else(r==="editCanvasConfig"||r==="requestGlobalConfig")&&_e(e[r],l[r],!0);n.setItemUnHandle(at.PERCENTAGE,0)}),s=()=>le(void 0,null,function*(){e.componentList=[],e.setEditCanvas(j.SAVE_STATUS,ze.START);const l=window.chartData;l&&(yield o(l))}),f=oe((l=!0)=>le(void 0,null,function*(){e.setEditCanvas(j.SAVE_STATUS,ze.START),e.getStorageInfo,setTimeout(()=>{e.setEditCanvas(j.SAVE_STATUS,ze.SUCCESS)},1e3)}),3e3);return{updateComponent:o,dataSyncFetch:s,dataSyncUpdate:f}},E=re(),{onClickOutSide:Mn}=pt(),bn=e=>le(void 0,null,function*(){e.preventDefault();try{yn();const t=e.dataTransfer.getData(en.DRAG_KEY);if(!t){St();return}E.setEditCanvas(j.IS_CREATE,!1);const n=nt(t);let o=yield Pt(n);V(o,e.offsetX-o.attr.w/2,e.offsetY-o.attr.h/2),E.addComponentList(o,!1,!0),E.setTargetSelectChart(o.id),St()}catch(t){En(),window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...")}}),wt=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},Nt=(e,t)=>{if(t){E.setTargetSelectChart(t.id);return}E.setTargetSelectChart(void 0)},Rn=(e,t)=>{var p;if(e.which==2||(p=window.$KeyboardActive)!=null&&p.space)return;Nt();const n=e.offsetX,o=e.offsetY,s=e.screenX,f=e.screenY,l=E.getEditCanvas.scale;E.setMousePosition(void 0,void 0,n,o);const C=Ue.exports.throttle(_=>{E.setTargetSelectChart(),E.setEditCanvas(j.IS_SELECT,!0);const r=n+_.screenX-s,u=o+_.screenY-f;E.setMousePosition(r,u);const h={x1:0,y1:0,x2:0,y2:0};r>n&&u>o?(h.x1=n,h.y1=o,h.x2=Math.round(n+(_.screenX-s)/l),h.y2=Math.round(o+(_.screenY-f)/l)):r>n&&u<o?(h.x1=n,h.y1=Math.round(o-(f-_.screenY)/l),h.x2=Math.round(n+(_.screenX-s)/l),h.y2=o):r<n&&u>o?(h.x1=Math.round(n-(s-_.screenX)/l),h.y1=o,h.x2=n,h.y2=Math.round(o+(_.screenY-f)/l)):(h.x1=Math.round(n-(s-_.screenX)/l),h.y1=Math.round(o-(f-_.screenY)/l),h.x2=n,h.y2=o),E.getComponentList.forEach(c=>{if(!E.getTargetChart.selectId.includes(c.id)){const{x:y,y:v,w:S,h:b}=c.attr,M={x1:y,y1:v,x2:y+S,y2:v+b};M.x1-h.x1>=0&&M.y1-h.y1>=0&&M.x2-h.x2<=0&&M.y2-h.y2<=0&&!c.status.lock&&!c.status.hide&&E.setTargetSelectChart(c.id,!0)}})},30),g=()=>{C.cancel(),E.setEditCanvas(j.IS_SELECT,!1),E.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",g)};document.addEventListener("mousemove",C),document.addEventListener("mouseup",g)},Kt=()=>({mouseClickHandle:(s,f)=>{var l;if(s.preventDefault(),s.stopPropagation(),!f.status.lock&&(l=window.$KeyboardActive)!=null&&l.ctrl)if(E.targetChart.selectId.includes(f.id)){const C=E.targetChart.selectId.filter(g=>g!==f.id);E.setTargetSelectChart(C)}else E.setTargetSelectChart(f.id,!0)},mousedownHandle:(s,f)=>{var v;if(s.preventDefault(),s.stopPropagation(),f.status.lock||(Mn(),s.buttons===qe.LEFT&&((v=window.$KeyboardActive)==null?void 0:v.ctrl)))return;const l=E.getTargetChart.selectId;if(s.buttons===qe.RIGHT&&l.length>1&&l.includes(f.id)||(E.setTargetSelectChart(f.id),s.buttons===qe.RIGHT))return;const C=E.getEditCanvas.scale,g=E.getEditCanvasConfig.width,p=E.getEditCanvasConfig.height,_=new Map;E.getTargetChart.selectId.forEach(S=>{const b=E.fetchTargetIndex(S);if(b!==-1){const{x:M,y:L,w:G,h:X}=tn(E.getComponentList[b]).attr;_.set(S,{x:M,y:L,w:G,h:X})}});const r=s.screenX,u=s.screenY;let h=[];E.getTargetChart.selectId.forEach(S=>{if(!_.has(S))return;const b=E.fetchTargetIndex(S);h.push(Ue.exports.cloneDeep(E.getComponentList[b]))}),E.setMousePosition(void 0,void 0,r,u);const c=Ue.exports.throttle(S=>{E.setEditCanvas(j.IS_DRAG,!0),E.setMousePosition(S.screenX,S.screenY);let b=(S.screenX-r)/C,M=(S.screenY-u)/C;E.getTargetChart.selectId.forEach(L=>{if(!_.has(L))return;const G=E.fetchTargetIndex(L),{x:X,y:q,w,h:m}=_.get(L),H=E.getComponentList[G];let K=Math.round(X+b),T=Math.round(q+M);const R=50;K=K<-w+R?-w+R:K,T=T<-m+R?-m+R:T,K=K>g-R?g-R:K,T=T>p-R?p-R:T,H&&(H.attr=Object.assign(H.attr,{x:K,y:T}))})},20),y=()=>{try{E.setMousePosition(0,0,0,0),E.setEditCanvas(j.IS_DRAG,!1),h.length&&(E.getTargetChart.selectId.forEach(S=>{if(!_.has(S))return;const b=E.fetchTargetIndex(S),M=E.getComponentList[b];h.forEach(L=>{L.id===S&&(L.attr=Object.assign(L.attr,{offsetX:M.attr.x-L.attr.x,offsetY:M.attr.y-L.attr.y}))})}),E.moveComponentList(h)),document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",y)}catch(S){console.log(S)}};document.addEventListener("mousemove",c),document.addEventListener("mouseup",y)},mouseenterHandle:(s,f)=>{s.preventDefault(),s.stopPropagation(),E.getEditCanvas.isSelect||E.setTargetHoverChart(f.id)},mouseleaveHandle:(s,f)=>{s.preventDefault(),s.stopPropagation(),E.setEditCanvas(j.IS_DRAG,!1),E.setTargetHoverChart(void 0)}}),Bn=(e,t,n)=>{e.stopPropagation(),e.preventDefault(),E.setEditCanvas(j.IS_DRAG,!0);const o=E.getEditCanvas.scale,s=n.x,f=n.y,l=n.w,C=n.h,g=e.screenX,p=e.screenY;E.setMousePosition(g,p);const _=Ue.exports.throttle(u=>{E.setMousePosition(u.screenX,u.screenY);let h=Math.round((u.screenX-g)/o),c=Math.round((u.screenY-p)/o);const y=/t/.test(t),v=/b/.test(t),S=/l/.test(t),b=/r/.test(t),M=C+(y?-c:v?c:0),L=l+(S?-h:b?h:0);n.h=M>0?M:0,n.w=L>0?L:0,n.x=s+(S?h:0),n.y=f+(y?c:0)},50),r=()=>{E.setEditCanvas(j.IS_DRAG,!1),E.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",r)};document.addEventListener("mousemove",_),document.addEventListener("mouseup",r)},$e=(e,t)=>e?{zIndex:t+1,left:`${e.x}px`,top:`${e.y}px`}:{},ye=(e,t)=>e?{width:`${t?t*e.w:e.w}px`,height:`${t?t*e.h:e.h}px`}:{},In=(e,t,n,o)=>{const{w:s,h:f}=n,l=/t/.test(e),C=/b/.test(e),g=/l/.test(e),p=/r/.test(e);let _=0,r=0;return e.length===2?(_=g?0:s,r=l?0:f):((l||C)&&(_=s/2,r=l?0:f),(g||p)&&(_=g?0:s,r=Math.floor(f/2))),{left:`${_}px`,top:`${r}px`,cursor:o[t]+"-resize"}};const Hn=["onMousedown"],Pn=ue({__name:"index",props:{item:{type:Object,required:!0},hiddenPoint:{type:Boolean,required:!1}},setup(e){const t=e;ke(r=>({"026d39a0":a(l)}));const n=Fe(),o=re(),s=["t","r","b","l","lt","rt","lb","rb"],f=["n","e","s","w","nw","ne","sw","se"],l=U(()=>n.getAppTheme),C=U(()=>t.item.status.lock?!1:t.item.id===o.getTargetChart.hoverId),g=U(()=>{const r=t.item.id;return t.item.status.lock?!1:o.getTargetChart.selectId.find(u=>u===r)}),p=U(()=>t.item.status.lock),_=U(()=>t.item.status.hide);return(r,u)=>(D(),z("div",{class:de(["go-shape-box",{lock:a(p),hide:a(_)}])},[dt(r.$slots,"default",{},void 0,!0),e.hiddenPoint?Ce("",!0):(D(!0),z(he,{key:0},Ee(a(g)?s:[],(h,c)=>(D(),z("div",{class:de(`shape-point ${h}`),key:c,style:ae(a(In)(h,c,e.item.attr,f)),onMousedown:y=>a(Bn)(y,h,e.item.attr)},null,46,Hn))),128)),W("div",{class:"shape-modal",style:ae(a(ye)(e.item.attr))},[W("div",{class:de(["shape-modal-select",{active:a(g)}])},null,2),W("div",{class:de(["shape-modal-change",{selectActive:a(g),hoverActive:a(C)}])},null,2)],4)],2))}});var rt=ce(Pn,[["__scopeId","data-v-5f8854aa"]]);const Un={class:"go-edit-group-box"},$n=ue({__name:"index",props:{groupData:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){const t=re(),{handleContextMenu:n}=pt(),{mouseenterHandle:o,mouseleaveHandle:s,mousedownHandle:f,mouseClickHandle:l}=Kt(),C=(_,r,u)=>{const h=c=>r.filter(y=>c.includes(y.key));if(t.getTargetChart.selectId.length>1)return h([x.GROUP,x.DELETE]);{const c=[];u.status.lock?c.push(x.LOCK):c.push(x.UNLOCK),u.status.hide?c.push(x.HIDE):c.push(x.SHOW);const y=[x.UN_GROUP];return[...h(y),_n(),..._.filter(v=>!c.includes(v.key))]}},g=U(()=>{const _=t.getEditCanvasConfig.chartThemeColor;return Lt[_]}),p=U(()=>t.getEditCanvasConfig.chartThemeSetting);return(_,r)=>(D(),z("div",Un,[(D(),N(a(rt),{key:e.groupData.id,"data-id":e.groupData.id,index:e.groupIndex,item:e.groupData,hiddenPoint:!0,class:de(a(ot)(e.groupData.styles.animations)),style:ae(P(P(P(P(P({},a($e)(e.groupData.attr,e.groupIndex)),a(ye)(e.groupData.attr)),a(He)(e.groupData.styles)),a(st)(e.groupData.styles)),a(Rt)(e.groupData.styles))),onClick:r[0]||(r[0]=u=>a(l)(u,e.groupData)),onMousedown:r[1]||(r[1]=u=>a(f)(u,e.groupData)),onMouseenter:r[2]||(r[2]=u=>a(o)(u,e.groupData)),onMouseleave:r[3]||(r[3]=u=>a(s)(u,e.groupData)),onContextmenu:r[4]||(r[4]=u=>a(n)(u,e.groupData,C))},{default:A(()=>[(D(!0),z(he,null,Ee(e.groupData.groupList,u=>(D(),N(a(rt),{key:u.id,"data-id":u.id,index:e.groupIndex,item:u,hiddenPoint:!0,style:ae(P({},a($e)(u.attr,e.groupIndex)))},{default:A(()=>[(D(),N(Se(u.chartConfig.chartKey),{class:de(["edit-content-chart",a(ot)(u.styles.animations)]),chartConfig:u,themeSetting:a(p),themeColor:a(g),style:ae(P(P(P({},a(ye)(u.attr)),a(He)(u.styles)),a(st)(u.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","item","style"]))),128))]),_:1},8,["data-id","index","item","class","style"]))]))}});const Nn={class:"go-edit-align-line"},Kn=ue({__name:"index",setup(e){ke(c=>({42514545:a(l)}));const t=Fe(),n=re(),o=ft(),s=Ne({lineArr:["rowt","rowc","rowb","coll","colc","colr"],select:new Map,sorptioned:{x:!1,y:!1}}),f=c=>c?{left:`${c.x?c.x:0}px`,top:`${c.y?c.y:0}px`}:{},l=U(()=>t.getAppTheme),C=U(()=>o.getChartAlignRange),g=U(()=>n.getEditCanvas[j.IS_DRAG]),p=(c,y)=>Math.abs(c-y)<=C.value,_=U(()=>n.getTargetChart.selectId),r=U(()=>n.getComponentList[n.fetchTargetIndex()]),u=U(()=>{var c;return((c=r.value)==null?void 0:c.attr)||{}}),h=U(()=>({id:"0",attr:{w:Ct(n.getEditCanvasConfig.width),h:Ct(n.getEditCanvasConfig.height),x:0,y:0,offsetX:0,offsetY:0,zIndex:0}}));return ve(()=>n.getMousePosition,oe(()=>{try{if(!g.value||_.value.length!==1)return;const c=u.value.w,y=u.value.h,v=u.value.x,S=v+c/2,b=v+c,M=[v,S,b],L=u.value.y,G=L+y/2,X=L+y,q=[L,G,X];s.select.clear(),s.sorptioned.y=!1;const w=n.getComponentList.map(m=>({id:m.id,attr:m.attr}));w.push(h.value),s.lineArr.forEach(m=>{w.forEach(H=>{if(_.value[0]===H.id)return;const K=H.attr.w,T=H.attr.h,R=H.attr.x,i=R+K/2,d=R+K,k=[R,i,d],F=H.attr.y,Y=F+T/2,$=F+T,ie=[F,Y,$];m.includes("rowt")&&(p(L,F)&&(s.select.set(m,{y:F}),V(r.value,v,F)),p(L,Y)&&(s.select.set(m,{y:Y}),V(r.value,v,Y)),p(L,$)&&(s.select.set(m,{y:$}),V(r.value,v,$))),m.includes("rowc")&&(p(G,F)&&(s.select.set(m,{y:F}),V(r.value,v,F-y/2)),p(G,Y)&&(s.select.set(m,{y:Y}),V(r.value,v,Y-y/2)),p(G,$)&&(s.select.set(m,{y:$}),V(r.value,v,$-y/2))),m.includes("rowb")&&(p(X,F)&&(s.select.set(m,{y:F}),V(r.value,v,F-y)),p(X,Y)&&(s.select.set(m,{y:Y}),V(r.value,v,Y-y)),p(X,$)&&(s.select.set(m,{y:$}),V(r.value,v,$-y))),m.includes("coll")&&(p(v,R)&&(s.select.set(m,{x:R}),V(r.value,R,L)),p(v,i)&&(s.select.set(m,{x:i}),V(r.value,i,L)),p(v,d)&&(s.select.set(m,{x:d}),V(r.value,d,L))),m.includes("colc")&&(p(S,R)&&(s.select.set(m,{x:R}),V(r.value,R-c/2,L)),p(S,i)&&(s.select.set(m,{x:i}),V(r.value,i-c/2,L)),p(S,d)&&(s.select.set(m,{x:d}),V(r.value,d-c/2,L))),m.includes("colr")&&(p(b,R)&&(s.select.set(m,{x:R}),V(r.value,R-c,L)),p(b,i)&&(s.select.set(m,{x:i}),V(r.value,i-c,L)),p(b,d)&&(s.select.set(m,{x:d}),V(r.value,d-c,L)))})})}catch(c){console.log(c)}},200),{deep:!0}),ve(()=>g.value,c=>{c||(s.select.clear(),s.sorptioned.y=!1)}),(c,y)=>(D(),z("div",Nn,[(D(!0),z(he,null,Ee(s.lineArr,v=>(D(),z("div",{class:de(["line",[v.includes("row")?"row":"col",s.select.has(v)&&"visible"]]),key:v,style:ae(f(s.select.get(v)))},null,6))),128))]))}});var Gn=ce(Kn,[["__scopeId","data-v-403a9eed"]]);const Yn=ue({__name:"index",setup(e){return(t,n)=>{const o=I("n-watermark");return D(),N(o,{id:"go-edit-watermark",content:a(nn),cross:"",selectable:"","font-size":16,"line-height":16,width:500,height:150,"x-offset":12,"y-offset":80,rotate:-15},null,8,["content"])}}});var Xn=ce(Yn,[["__scopeId","data-v-e5cd93da"]]);const Gt=e=>(Bt("data-v-71d41248"),e=e(),It(),e),Wn=Gt(()=>W("div",{class:"select-background"},null,-1)),zn=Gt(()=>W("div",{class:"select-border"},null,-1)),Vn=[Wn,zn],qn=ue({__name:"index",setup(e){ke(C=>({c29aca42:a(f)}));const t=Fe(),n=re(),{isSelect:o,scale:s}=Ke(n.getEditCanvas),f=U(()=>t.getAppTheme),l=Z();return ve(()=>n.getMousePosition,C=>{if(!o.value)return;const{startX:g,startY:p,x:_,y:r}=C,u={zIndex:yt,x:0,y:0,w:0,h:0,offsetX:0,offsetY:0};_>g&&r>p?(u.x=g,u.y=p,u.w=Math.round((_-g)/s.value),u.h=Math.round((r-p)/s.value)):_>g&&r<p?(u.x=g,u.w=Math.round((_-g)/s.value),u.h=Math.round((p-r)/s.value),u.y=p-u.h):_<g&&r>p?(u.y=p,u.w=Math.round((g-_)/s.value),u.h=Math.round((r-p)/s.value),u.x=g-u.w):(u.w=Math.round((g-_)/s.value),u.h=Math.round((p-r)/s.value),u.x=g-u.w,u.y=p-u.h),l.value=P(P({},$e(u,yt)),ye(u))},{deep:!0}),(C,g)=>a(o)?(D(),z("div",{key:0,class:"go-edit-select",style:ae(l.value)},Vn,4)):Ce("",!0)}});var Jn=ce(qn,[["__scopeId","data-v-71d41248"]]);const Qn=ue({__name:"index",setup(e){const t=re(),{getEditCanvasConfig:n,getEditCanvas:o}=Ke(t),s=U(()=>({w:n.value.width,h:n.value.height})),f=U(()=>{const C={transform:`scale(${o.value.scale})`};return P(P({},ye(s.value)),C)}),l=U(()=>{const C=o.value.isCreate&&{"z-index":99999};return P(P({},ye(s.value)),C)});return(C,g)=>(D(),z("div",{class:"go-edit-range go-transition",style:ae(a(f)),onMousedown:g[0]||(g[0]=p=>a(Rn)(p,void 0))},[dt(C.$slots,"default",{},void 0,!0),O(a(Xn)),O(a(Gn)),O(a(Jn)),W("div",{class:"go-edit-range-model",style:ae(a(l))},null,4)],36))}});var Zn=ce(Qn,[["__scopeId","data-v-52e445d0"]]),Yt=!!(typeof window!="undefined"&&window.document&&window.document.createElement),ut=!1,ct=!1;try{var et={get passive(){return ut=!0},get once(){return ct=ut=!0}};Yt&&(window.addEventListener("test",et,et),window.removeEventListener("test",et,!0))}catch(e){}function jn(e,t,n,o){if(o&&typeof o!="boolean"&&!ct){var s=o.once,f=o.capture,l=n;!ct&&s&&(l=n.__once||function C(g){this.removeEventListener(t,C,f),n.call(this,g)},n.__once=l),e.addEventListener(t,l,ut?o:f)}e.addEventListener(t,n,o)}function eo(e,t,n,o){var s=o&&typeof o!="boolean"?o.capture:o;e.removeEventListener(t,n,s),n.__once&&e.removeEventListener(t,n.__once,s)}function Tt(e,t,n,o){return jn(e,t,n,o),function(){eo(e,t,n,o)}}var xt=new Date().getTime();function to(e){var t=new Date().getTime(),n=Math.max(0,16-(t-xt)),o=setTimeout(e,n);return xt=t,o}var no=["","webkit","moz","o","ms"],At=to,Dt=function(t,n){return t+(t?n[0].toUpperCase()+n.substr(1):n)+"AnimationFrame"};Yt&&no.some(function(e){var t=Dt(e,"request");return t in window&&(Dt(e,"cancel"),At=function(o){return window[t](o)}),!!At});Function.prototype.bind.call(Function.prototype.call,[].slice);Function.prototype.bind.call(Function.prototype.call,[].slice);const oo={class:"go-sketch-rule"},so={key:1,class:"fix-edit-screens-block"},ao=ue({__name:"index",setup(e){ke(T=>({"027e6d17":a(G),"66707d7c":a(M),"2846119e":u.value}));const t=re(),n=Ut(),o=Fe(),s=20;let f=[0,0],l=[0,0];const C=Z(),g=Z(!0),p=Z(),_=Z(),r=Z(!1),u=Z("auto"),{width:h,height:c}=Ke(t.getEditCanvasConfig),y=Z(0),v=Z(0),S=Ne({h:[],v:[]}),b=U(()=>t.getEditCanvas.scale),M=U(()=>`${c.value*2}px`),L=U(()=>o.getDarkTheme?{bgColor:"#18181c",longfgColor:"#4d4d4d",shortfgColor:"#4d4d4d",fontColor:"#4d4d4d",shadowColor:"#18181c",borderColor:"#18181c",cornerActiveColor:"#18181c"}:{}),G=U(()=>o.getAppTheme),X=T=>{if(T.ctrlKey||T.metaKey){T.preventDefault();let R=b.value;if(T.wheelDelta>=0&&b.value<2){R=b.value+.05,t.setScale(R);return}T.wheelDelta<0&&b.value>.1&&(R=b.value-.05,t.setScale(R))}},q=()=>{if(!C.value)return;const T=C.value.getBoundingClientRect(),R=p.value.getBoundingClientRect();y.value=(T.left+s-R.left)/b.value,v.value=(T.top+s-R.top)/b.value},w=T=>{var F,Y;if(T.preventDefault(),T.stopPropagation(),T.which==2)r.value=!0;else if(!((F=window.$KeyboardActive)!=null&&F.space))return;(Y=document.activeElement)==null||Y.blur();const R=T.pageX,i=T.pageY,d=Tt(window,"mousemove",$=>{const ie=$.pageX-R,Te=$.pageY-i,[Ge,Le]=f,[Ye,Oe]=l;f=[Le,ie],l=[Oe,Te],C.value.scrollLeft-=Le>Ge?Math.abs(Le-Ge):-Math.abs(Le-Ge),C.value.scrollTop-=Oe>Ye?Math.abs(Oe-Ye):-Math.abs(Oe-Ye)}),k=Tt(window,"mouseup",()=>{d(),k(),f=[0,0],l=[0,0],r.value=!1})},m=()=>{const T=document.getElementById("go-chart-edit-layout");return T?{height:T.clientHeight-25,width:T.clientWidth}:{width:h.value,height:c.value}},H=()=>{g.value=!1,setTimeout(()=>{g.value=!0},10)},K=()=>{const{width:T,height:R}=_.value.getBoundingClientRect(),{width:i,height:d}=m();C.value.scrollLeft=T/2-i/2,C.value.scrollTop=R/2-d/2};return ve(()=>o.getDarkTheme,()=>{H()}),ve(()=>b.value,(T,R)=>{R!==T&&n.getRePositionCanvas?(n.setItemUnHandle(at.RE_POSITION_CANVAS,!1),q(),setTimeout(()=>{K(),H()},400)):oe(H,20)}),ve(()=>r.value,T=>{u.value=T?"grab":"auto"}),lt(()=>{C.value&&(C.value.addEventListener("wheel",X,{passive:!1}),K())}),Ot(()=>{C.value&&C.value.removeEventListener("wheel",X)}),window.onKeySpacePressHold=T=>{r.value=T},(T,R)=>{const i=I("sketch-rule");return D(),z("div",oo,[g.value?(D(),N(i,{key:0,thick:s,scale:a(b),width:m().width,height:m().height,startX:y.value,startY:v.value,lines:S,palette:a(L)},null,8,["scale","width","height","startX","startY","lines","palette"])):Ce("",!0),W("div",{ref_key:"$app",ref:C,class:"edit-screens",onScroll:q},[W("div",{ref_key:"$container",ref:_,class:"edit-screen-container",style:ae({width:a(h)*2+"px"})},[W("div",{ref_key:"refSketchRuleBox",ref:p,class:"canvas",onMousedown:w,style:ae({marginLeft:"-"+(m().width/2-25)+"px"})},[W("div",{style:ae({pointerEvents:r.value?"none":"auto"})},[dt(T.$slots,"default",{},void 0,!0)],4)],36)],4)],544),a(o).getDarkTheme?(D(),z("div",so)):Ce("",!0)])}}});var ro=ce(ao,[["__scopeId","data-v-9b7f266a"]]);const tt={[B.ADD]:"\u65B0\u589E",[B.DELETE]:"\u5220\u9664",[B.UPDATE]:"\u66F4\u65B0",[B.MOVE]:"\u79FB\u52A8",[B.PASTE]:"\u7C98\u8D34",[B.COPY]:"\u590D\u5236",[B.CUT]:"\u526A\u5207",[B.TOP]:"\u7F6E\u9876",[B.BOTTOM]:"\u7F6E\u5E95",[B.UP]:"\u4E0A\u79FB",[B.DOWN]:"\u4E0B\u79FB",[B.GROUP]:"\u6210\u7EC4",[B.UN_GROUP]:"\u89E3\u7EC4",[B.LOCK]:"\u9501\u5B9A",[B.UNLOCK]:"\u89E3\u9501",[B.HIDE]:"\u9690\u85CF",[B.SHOW]:"\u663E\u793A",[Ie.CANVAS]:"\u753B\u5E03\u521D\u59CB\u5316"};var uo=Array.prototype,co=uo.reverse;function io(e){return e==null?e:co.call(e)}var lo=io;const Xt=e=>(Bt("data-v-5a4fd660"),e=e(),It(),e),fo={class:"go-flex-items-center"},po=Xt(()=>W("span",{class:"btn-text"},"\u5386\u53F2\u8BB0\u5F55",-1)),vo={class:"history-list-box"},ho=["title"],go=Xt(()=>W("div",{class:"popover-modal"},null,-1)),_o=ue({__name:"index",setup(e){const{DesktopOutlineIcon:t,PencilIcon:n,TrashIcon:o,CopyIcon:s,LayersIcon:f,DuplicateIcon:l,HelpOutlineIcon:C,LockClosedOutlineIcon:g,LockOpenOutlineIcon:p,EyeOffOutlineIcon:_,EyeOutlineIcon:r}=De.ionicons5,{StackedMoveIcon:u,Carbon3DCursorIcon:h,Carbon3DSoftwareIcon:c}=De.carbon,y=Ft(),v=M=>{if(M.targetType===Ie.CANVAS)return t;switch(M.actionType){case B.UPDATE:return n;case B.DELETE:return o;case B.PASTE:return s;case B.TOP:return f;case B.BOTTOM:return f;case B.UP:return f;case B.DOWN:return f;case B.MOVE:return u;case B.ADD:return l;case B.GROUP:return h;case B.UN_GROUP:return c;case B.LOCK:return g;case B.UNLOCK:return p;case B.HIDE:return _;case B.SHOW:return r;default:return n}},S=M=>{if(M.targetType===Ie.CANVAS)return tt[Ie.CANVAS];if(M.actionType===B.GROUP||M.actionType===B.UN_GROUP)return`${tt[M.actionType]}`;if(M.historyData.length)return`${tt[M.actionType]} - ${M.historyData[0].chartConfig.title}`},b=U(()=>{const L=y.getBackStack.map(G=>({label:S(G),icon:v(G)}));return lo(L.filter(G=>G.label))});return(M,L)=>{const G=I("n-button"),X=I("n-icon"),q=I("n-text"),w=I("n-scrollbar"),m=I("n-popover"),H=I("n-tooltip");return D(),z("div",fo,[O(m,{class:"edit-history-popover","show-arrow":!1,size:"small",trigger:"click",placement:"top-start"},{trigger:A(()=>[O(G,{class:"mr-10",secondary:"",size:"small",disabled:a(b).length===0},{default:A(()=>[po]),_:1},8,["disabled"])]),default:A(()=>[W("div",vo,[O(w,{style:{"max-height":"500px"}},{default:A(()=>[(D(!0),z(he,null,Ee(a(b),(K,T)=>(D(),z("div",{class:"list-item go-flex-items-center go-ellipsis-1",key:T,title:K.label},[O(X,{class:"item-icon",size:"16",depth:2,component:K.icon},null,8,["component"]),O(q,{depth:"2"},{default:A(()=>[we(pe(K.label),1)]),_:2},1024)],8,ho))),128))]),_:1}),go])]),_:1}),O(H,{trigger:"hover"},{trigger:A(()=>[O(X,{size:"21",depth:3},{default:A(()=>[O(a(C))]),_:1})]),default:A(()=>[W("span",null,"\u6700\u591A\u53EA\u4FDD\u7559"+pe(a(on))+"\u6761\u8BB0\u5F55",1)]),_:1})])}}});var mo=ce(_o,[["__scopeId","data-v-5a4fd660"]]);const Co={class:"go-edit-bottom"},yo=ue({__name:"index",setup(e){ke(v=>({f3add9fc:s.value}));const{LockClosedOutlineIcon:t,LockOpenOutlineIcon:n}=De.ionicons5,o=Fe(),s=Z(o.getAppTheme),f=re(),{lockScale:l,scale:C}=Ke(f.getEditCanvas);let g=[{label:"200%",value:200},{label:"150%",value:150},{label:"100%",value:100},{label:"50%",value:50},{label:"\u81EA\u9002\u5E94",value:0}];const p=Z(""),_=v=>{if(v===0){f.computedScale();return}f.setScale(v/100)},r=()=>{f.setEditCanvas(j.LOCK_SCALE,!l.value)},u=Z(100),h=v=>`${v}%`,c=v=>{f.setScale(v/100)},y=Ne({100:""});return sn(()=>{const v=(C.value*100).toFixed(0);p.value=`${v}%`,u.value=parseInt(v)}),(v,S)=>{const b=I("n-text"),M=I("n-space"),L=I("n-select"),G=I("n-icon"),X=I("n-button"),q=I("n-tooltip"),w=I("n-slider");return D(),z("div",Co,[O(M,null,{default:A(()=>[O(a(mo)),O(b,{id:"keyboard-dress-show",depth:"3"})]),_:1}),O(M,{class:"bottom-ri"},{default:A(()=>[O(Tn),O(L,{disabled:a(l),class:"scale-btn",value:p.value,"onUpdate:value":[S[0]||(S[0]=m=>p.value=m),_],size:"mini",options:a(g)},null,8,["disabled","value","options"]),O(q,{trigger:"hover"},{trigger:A(()=>[O(X,{onClick:r,text:""},{default:A(()=>[O(G,{class:de(["lock-icon",{color:a(l)}]),size:"18",depth:2},{default:A(()=>[a(l)?(D(),N(a(t),{key:0})):(D(),N(a(n),{key:1}))]),_:1},8,["class"])]),_:1})]),default:A(()=>[W("span",null,pe(a(l)?"\u89E3\u9501":"\u9501\u5B9A")+"\u5F53\u524D\u6BD4\u4F8B",1)]),_:1}),O(w,{class:"scale-slider",value:u.value,"onUpdate:value":[S[1]||(S[1]=m=>u.value=m),c],"default-value":50,min:10,max:200,step:5,"format-tooltip":h,disabled:a(l),marks:y},null,8,["value","disabled","marks"])]),_:1})])}}});var Eo=ce(yo,[["__scopeId","data-v-99a534fc"]]);const So=ue({__name:"index",props:{modelShow:Boolean},emits:["update:modelShow"],setup(e,{emit:t}){const n=e,{HelpOutlineIcon:o,CloseIcon:s}=De.ionicons5,f=ft(),l=Z(!1),C=Ne([{key:ge.ASIDE_ALL_COLLAPSED,value:f.getAsideAllCollapsed,type:"switch",name:"\u83DC\u5355\u6298\u53E0",desc:"\u9996\u9875\u83DC\u5355\u6298\u53E0\u65F6\u9690\u85CF\u81F3\u754C\u9762\u5916"},{key:ge.HIDE_PACKAGE_ONE_CATEGORY,value:f.getHidePackageOneCategory,type:"switch",name:"\u9690\u85CF\u5206\u7C7B",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u8868\u5355\u5206\u7C7B\u53EA\u6709\u5355\u9879\u65F6\u9690\u85CF"},{key:ge.CHANGE_LANG_RELOAD,value:f.getChangeLangReload,type:"switch",name:"\u5207\u6362\u8BED\u8A00",desc:"\u5207\u6362\u8BED\u8A00\u91CD\u65B0\u52A0\u8F7D\u9875\u9762",tip:"\u82E5\u9047\u5230\u90E8\u5206\u533A\u57DF\u8BED\u8A00\u5207\u6362\u5931\u8D25\uFF0C\u5219\u5EFA\u8BAE\u5F00\u542F"},{key:"divider1",type:"divider",name:"",desc:"",value:""},{key:ge.CHART_TOOLS_STATUS_HIDE,value:f.getChartToolsStatusHide,type:"switch",name:"\u9690\u85CF\u5DE5\u5177\u680F",desc:"\u9F20\u6807\u79FB\u5165\u65F6\uFF0C\u4F1A\u5C55\u793A\u5207\u6362\u5230\u5C55\u5F00\u6A21\u5F0F"},{key:ge.CHART_TOOLS_STATUS,value:f.getChartToolsStatus,type:"select",name:"\u5DE5\u5177\u680F\u5C55\u793A",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u5DE5\u5177\u680F\u5C55\u793A\u65B9\u5F0F",options:[{label:"\u4FA7\u8FB9\u680F",value:Pe.ASIDE},{label:"\u5E95\u90E8 Dock",value:Pe.DOCK}]},{key:"divider0",type:"divider",name:"",desc:"",value:""},{key:ge.CHART_MOVE_DISTANCE,value:f.getChartMoveDistance,type:"number",name:"\u79FB\u52A8\u8DDD\u79BB",min:1,step:1,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u65B9\u5411\u952E\u63A7\u5236\u79FB\u52A8\u8DDD\u79BB"},{key:ge.CHART_ALIGN_RANGE,value:f.getChartAlignRange,type:"number",name:"\u5438\u9644\u8DDD\u79BB",min:10,step:2,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u79FB\u52A8\u56FE\u8868\u65F6\u7684\u5438\u9644\u8DDD\u79BB"}]);ve(()=>n.modelShow,_=>{l.value=_});const g=()=>{t("update:modelShow",!1)},p=(_,r)=>{f.setItem(r.key,r.value)};return(_,r)=>{const u=I("n-h3"),h=I("n-icon"),c=I("n-space"),y=I("n-divider"),v=I("n-text"),S=I("n-switch"),b=I("n-input-number"),M=I("n-select"),L=I("n-tooltip"),G=I("n-list-item"),X=I("n-list"),q=I("n-modal");return D(),N(q,{show:l.value,"onUpdate:show":r[0]||(r[0]=w=>l.value=w),onAfterLeave:g},{default:A(()=>[O(X,{bordered:"",class:"go-system-setting"},{header:A(()=>[O(c,{justify:"space-between"},{default:A(()=>[O(u,{class:"go-mb-0"},{default:A(()=>[we("\u7CFB\u7EDF\u8BBE\u7F6E")]),_:1}),O(h,{size:"20",class:"go-cursor-pointer",onClick:g},{default:A(()=>[O(a(s))]),_:1})]),_:1})]),default:A(()=>[(D(!0),z(he,null,Ee(C,w=>(D(),N(G,{key:w.key},{default:A(()=>[w.type==="divider"?(D(),N(y,{key:0,style:{margin:"0"}})):(D(),N(c,{key:1,size:40},{default:A(()=>[O(c,null,{default:A(()=>[O(v,{class:"item-left"},{default:A(()=>[we(pe(w.name),1)]),_:2},1024),w.type==="switch"?(D(),N(S,{key:0,value:w.value,"onUpdate:value":[m=>w.value=m,m=>p(m,w)],size:"small"},null,8,["value","onUpdate:value"])):w.type==="number"?(D(),N(b,{key:1,value:w.value,"onUpdate:value":[m=>w.value=m,m=>p(m,w)],class:"input-num-width",size:"small",step:w.step||null,suffix:w.suffix||null,min:w.min||0},null,8,["value","onUpdate:value","step","suffix","min"])):w.type==="select"?(D(),N(M,{key:2,class:"select-min-width",value:w.value,"onUpdate:value":[m=>w.value=m,m=>p(m,w)],size:"small",options:w.options},null,8,["value","onUpdate:value","options"])):Ce("",!0)]),_:2},1024),O(c,null,{default:A(()=>[O(v,{class:"item-right"},{default:A(()=>[we(pe(w.desc),1)]),_:2},1024),w.tip?(D(),N(L,{key:0,trigger:"hover"},{trigger:A(()=>[O(h,{size:"21"},{default:A(()=>[O(a(o))]),_:1})]),default:A(()=>[W("span",null,pe(w.tip),1)]),_:2},1024)):Ce("",!0)]),_:2},1024)]),_:2},1024))]),_:2},1024))),128))]),_:1})]),_:1},8,["show"])}}});var wo=ce(So,[["__scopeId","data-v-7cea0aa5"]]);const Ae=re(),To=()=>{Ae.setTargetSelectChart(void 0),an(rn(Ae.getStorageInfo||[]),void 0,"json");const e=document.querySelector(".go-edit-range"),t=document.getElementById("go-edit-watermark");if(!e||!t){window.$message.error("\u5BFC\u51FA\u5931\u8D25\uFF01");return}const n=Ae.getEditCanvas.scale;Ae.setScale(1,!0),t.style.display="block",setTimeout(()=>{un(e,()=>{t&&(t.style.display="none"),Ae.setScale(n,!0)})},600)};var it=(e=>(e.TXT="text/plain",e.JSON="application/json",e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e))(it||{});const xo=()=>{const e=Z(),{updateComponent:t}=vt();return{importUploadFileListRef:e,importBeforeUpload:({file:s})=>{e.value=[];const f=s.file.type;return f!==it.JSON&&f!==it.TXT?(window.$message.warning("\u4EC5\u652F\u6301\u4E0A\u4F20 \u3010JSON\u3011 \u683C\u5F0F\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20\uFF01"),!1):!0},importCustomRequest:s=>{const{file:f}=s;cn(()=>{f.file?ln(f.file).then(l=>{Sn({message:"\u8BF7\u9009\u62E9\u5BFC\u5165\u65B9\u5F0F:",positiveText:"\u65B0\u589E\uFF08\u53EF\u64A4\u56DE\uFF09",negativeText:"\u8986\u76D6\uFF08\u4E0D\u53EF\u64A4\u56DE\uFF09",negativeButtonProps:{type:"info",ghost:!1},onPositiveCallback:()=>le(void 0,null,function*(){try{l=nt(l),yield t(l,!1,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(C){console.log(C),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}}),onNegativeCallback:()=>le(void 0,null,function*(){try{l=nt(l),yield t(l,!0,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(C){console.log(C),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}})})}):window.$message.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6216\u8054\u7CFB\u7BA1\u7406\u5458\uFF01")})}}},{updateComponent:Ao,dataSyncUpdate:kt}=vt(),Do=re(),ko=()=>{const e=f=>Ao(f.detail,!0,!1),t=()=>le(void 0,null,function*(){kt&&(yield kt()),dispatchEvent(new CustomEvent(Je.CHART,{detail:Do.getStorageInfo}))}),n=()=>{addEventListener("blur",t),addEventListener(Je.JSON,e)},o=()=>{removeEventListener(Je.JSON,e),removeEventListener("blur",t)};return(f,l)=>{l==Et.CHART_HOME_NAME&&o(),f==Et.CHART_HOME_NAME&&n()}},Fo=()=>{const e=Ht();ve(()=>e.name,ko(),{immediate:!0})};var me=(e=>(e.BUTTON="button",e.IMPORTUPLOAD="importUpload",e))(me||{});const Lo={class:"btn-item"},Oo=ue({__name:"index",setup(e){const{DownloadIcon:t,ShareIcon:n,PawIcon:o,SettingsSharpIcon:s,CreateIcon:f}=De.ionicons5,l=ft(),C=re();Ht(),Fo();let g=null;const p=Z(!1),_=Z(!0),r=Z(!0),{importUploadFileListRef:u,importCustomRequest:h,importBeforeUpload:c}=xo(),y=U(()=>l.getChartToolsStatus===Pe.ASIDE),v=U(()=>l.getChartToolsStatusHide),S=U(()=>_.value&&v.value),b=U(()=>{if(!y.value)return q;const w=[];return q.map(m=>{w.unshift(m)}),w}),M=()=>{g=setTimeout(()=>{_.value&&(_.value=!1,r.value=!0)},200),setTimeout(()=>{r.value=!1},400)},L=()=>{clearTimeout(g),_.value||(_.value=!0)},G=()=>{window.$message.warning("\u5C06\u5F00\u542F\u5931\u7126\u66F4\u65B0\uFF01"),setTimeout(()=>{const w=fn(pn.CHART_EDIT_NAME,"href");if(!w)return;const m=vn();X(m),hn(w,[m],void 0,!0)},1e3)},X=w=>{const m=C.getStorageInfo,H=gn(be.GO_CHART_STORAGE_LIST)||[];if(H!=null&&H.length){const K=H.findIndex(T=>T.id===w);K!==-1?(H.splice(K,1,fe(P({},m),{id:w})),je(be.GO_CHART_STORAGE_LIST,H)):(H.push(fe(P({},m),{id:w})),je(be.GO_CHART_STORAGE_LIST,H))}else je(be.GO_CHART_STORAGE_LIST,[fe(P({},m),{id:w})])},q=[{key:"import",type:me.IMPORTUPLOAD,name:"\u5BFC\u5165",icon:n},{key:"export",type:me.BUTTON,name:"\u5BFC\u51FA",icon:t,handle:To},{key:"edit",type:me.BUTTON,name:"\u7F16\u8F91",icon:f,handle:G},{key:"setting",type:me.BUTTON,name:"\u8BBE\u7F6E",icon:s,handle:()=>{p.value=!0}}];return(w,m)=>{const H=I("n-icon"),K=I("n-text"),T=I("n-button"),R=I("n-upload"),i=I("n-tooltip");return D(),z(he,null,[W("div",{class:de(["go-chart-edit-tools",[a(l).getChartToolsStatus,a(S)?"isMini":"unMini"]]),onClick:m[1]||(m[1]=d=>_.value&&(_.value=!1)),onMouseenter:M,onMouseleave:L},[Qe(O(H,{class:"asideLogo",size:"22"},{default:A(()=>[O(a(o))]),_:1},512),[[Ze,a(l).getChartToolsStatus===a(Pe).ASIDE&&a(S)]]),(D(!0),z(he,null,Ee(a(b),(d,k)=>(D(),N(i,{key:d.key,disabled:!a(y)||a(v)&&r.value,trigger:"hover",placement:"left"},{trigger:A(()=>[W("div",Lo,[d.type===a(me).BUTTON?(D(),N(T,{key:0,circle:a(y),secondary:"",onClick:d.handle},{icon:A(()=>[a(y)?(D(),N(H,{key:0,size:"22"},{default:A(()=>[(D(),N(Se(d.icon)))]),_:2},1024)):(D(),N(Se(d.icon),{key:1}))]),default:A(()=>[Qe(O(K,{depth:"3"},{default:A(()=>[we(pe(d.name),1)]),_:2},1536),[[Ze,!a(y)]])]),_:2},1032,["circle","onClick"])):d.type===a(me).IMPORTUPLOAD?(D(),N(R,{key:1,"file-list":a(u),"onUpdate:fileList":m[0]||(m[0]=F=>dn(u)?u.value=F:null),"show-file-list":!1,customRequest:a(h),onBeforeUpload:a(c)},{default:A(()=>[O(T,{circle:a(y),secondary:""},{icon:A(()=>[a(y)?(D(),N(H,{key:0,size:"22"},{default:A(()=>[(D(),N(Se(d.icon)))]),_:2},1024)):(D(),N(Se(d.icon),{key:1}))]),default:A(()=>[Qe(O(K,{depth:"3"},{default:A(()=>[we(pe(d.name),1)]),_:2},1536),[[Ze,!a(y)]])]),_:2},1032,["circle"])]),_:2},1032,["file-list","customRequest","onBeforeUpload"])):Ce("",!0)])]),default:A(()=>[W("span",null,pe(d.name),1)]),_:2},1032,["disabled"]))),128))],34),O(a(wo),{modelShow:p.value,"onUpdate:modelShow":m[2]||(m[2]=d=>p.value=d)},null,8,["modelShow"])],64)}}});var Mo=ce(Oo,[["__scopeId","data-v-4c257f27"]]);const bo=ue({__name:"index",setup(e){const t=re(),{handleContextMenu:n}=pt(),{dataSyncFetch:o}=vt();xn();const{mouseenterHandle:s,mouseleaveHandle:f,mousedownHandle:l,mouseClickHandle:C}=Kt(),g=(u,h,c)=>{if(t.getTargetChart.selectId.length>1)return h.filter(v=>[x.GROUP,x.DELETE].includes(v.key));const y=[];return c.status.lock?y.push(x.LOCK):y.push(x.UNLOCK),c.status.hide?y.push(x.HIDE):y.push(x.SHOW),u.filter(v=>!y.includes(v.key))},p=U(()=>t.getEditCanvasConfig.chartThemeSetting),_=U(()=>{const u=t.getEditCanvasConfig.chartThemeColor;return Lt[u]});U(()=>t.getEditCanvasConfig.filterShow);const r=U(()=>{const u=t.getEditCanvasConfig.background,h=t.getEditCanvasConfig.backgroundImage,v=t.getEditCanvasConfig.selectColor?{background:u||void 0}:{background:`url(${h}) no-repeat center center / cover !important`};return fe(P({},v),{width:"inherit",height:"inherit"})});return lt(()=>{Fn(),o()}),(u,h)=>(D(),N(a(wn),{id:"go-chart-edit-layout",flex:!0,showTop:!1,showBottom:!0,depth:1,xScroll:!0,disabledScroll:!0,onMousedown:a(Nt),onDrop:a(bn),onDragover:a(wt),onDragenter:a(wt)},{aside:A(()=>[O(a(Mo))]),bottom:A(()=>[O(a(Eo))]),default:A(()=>[O(a(ro),null,{default:A(()=>[W("div",{id:"go-chart-edit-content",onContextmenu:h[0]||(h[0]=(...c)=>a(n)&&a(n)(...c))},[O(a(Zn),null,{default:A(()=>[W("div",{style:ae(P(P({},a(He)(a(t).getEditCanvasConfig)),a(r)))},[(D(!0),z(he,null,Ee(a(t).getComponentList,(c,y)=>(D(),z("div",{key:c.id},[c.isGroup?(D(),N(a($n),{key:0,groupData:c,groupIndex:y},null,8,["groupData","groupIndex"])):(D(),N(a(rt),{key:1,"data-id":c.id,index:y,style:ae(P(P({},a($e)(c.attr,y)),a(Rt)(c.styles))),item:c,onClick:v=>a(C)(v,c),onMousedown:v=>a(l)(v,c),onMouseenter:v=>a(s)(v,c),onMouseleave:v=>a(f)(v,c),onContextmenu:v=>a(n)(v,c,g)},{default:A(()=>[(D(),N(Se(c.chartConfig.chartKey),{class:de(["edit-content-chart",a(ot)(c.styles.animations)]),chartConfig:c,themeSetting:a(p),themeColor:a(_),style:ae(P(P(P({},a(ye)(c.attr)),a(He)(c.styles)),a(st)(c.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","style","item","onClick","onMousedown","onMouseenter","onMouseleave","onContextmenu"]))]))),128))],4)]),_:1})],32)]),_:1})]),_:1},8,["onMousedown","onDrop","onDragover","onDragenter"]))}});var qo=ce(bo,[["__scopeId","data-v-71b3d0ba"]]);export{qo as default};
