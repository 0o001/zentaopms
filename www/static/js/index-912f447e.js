var It=Object.defineProperty,Ht=Object.defineProperties;var Pt=Object.getOwnPropertyDescriptors;var ct=Object.getOwnPropertySymbols;var $t=Object.prototype.hasOwnProperty,Ut=Object.prototype.propertyIsEnumerable;var lt=(e,n,t)=>n in e?It(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Y=(e,n)=>{for(var t in n||(n={}))$t.call(n,t)&&lt(e,t,n[t]);if(ct)for(var t of ct(n))Ut.call(n,t)&&lt(e,t,n[t]);return e},we=(e,n)=>Ht(e,Pt(n));var Se=(e,n,t)=>new Promise((a,s)=>{var d=m=>{try{y(t.next(m))}catch(f){s(f)}},p=m=>{try{y(t.throw(m))}catch(f){s(f)}},y=m=>m.done?a(m.value):Promise.resolve(m.value).then(d,p);y((t=t.apply(e,n)).next())});import{u as re,E as ae,t as se,A as Ye,B as Nt,z as Kt,D as Re,G as Yt,J as Ce,c as Et,K as Ie,g as Gt,h as Xt,M as R,O as Be,a as Wt,b as wt,Q as zt,F as jt,R as qt,e as Jt}from"./useSync.hook-43733809.js";import{x as ot,a6 as St,b1 as Vt,aj as F,c4 as Tt,c5 as xt,ck as it,cj as Qt,c2 as Ve,cl as j,c9 as Ge,ak as Zt,j as ce,d as ue,bH as Ae,f as o,u as ke,a5 as $,o as D,m as z,n as at,F as he,A as _e,ad as ie,aP as oe,ab as fe,z as W,c as U,w as b,L as me,bS as Qe,bT as He,bU as Ze,bV as Dt,a4 as rt,y as $e,al as dt,R as pe,r as H,cm as en,a3 as Ue,v as Q,cn as ft,D as At,E as kt,e as M,p as ye,t as de,aI as tn,aR as nn,co as ve,cp as Pe,cq as sn,c1 as on,cr as an,am as rn,cs as un,J as Ft,Q as pt,bZ as Xe,X as We,Y as ze,bQ as cn,V as ln,ct as dn,cu as fn,W as pn,aO as hn,S as Oe,b_ as je}from"./index.js";import{u as ut,d as vn}from"./index-6530b97e.js";import{a as gn,b as ht,l as _n,g as mn}from"./plugin-af240f11.js";import{C as Cn}from"./index-0adfa37a.js";import{i as De}from"./icon-1e459023.js";import{E as yn}from"./index-bdf401f8.js";import"./tables_list-38e71280.js";import"./index-4b2dde42.js";import"./index-93a76adb.js";const Te=re(),En=()=>{ot(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,document.getElementById("go-chart-edit-layout")),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,document.getElementById("go-chart-edit-content"));const e=Te.listenerScale();St(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,null),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,null),e()})})};var bt={exports:{}};(function(e){(function(n){var t,a={},s={16:!1,18:!1,17:!1,91:!1},d="all",p={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},y={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},m=function(r){return y[r]||r.toUpperCase().charCodeAt(0)},f=[];for(t=1;t<20;t++)y["f"+t]=111+t;function C(r,l){for(var O=r.length;O--;)if(r[O]===l)return O;return-1}function i(r,l){if(r.length!=l.length)return!1;for(var O=0;O<r.length;O++)if(r[O]!==l[O])return!1;return!0}var c={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function S(r){for(t in s)s[t]=r[c[t]]}function g(r){var l,O,L,G,N,le;if(l=r.keyCode,C(f,l)==-1&&f.push(l),(l==93||l==224)&&(l=91),l in s){s[l]=!0;for(L in p)p[L]==l&&(u[L]=!0);return}if(S(r),!!u.filter.call(this,r)&&l in a){for(le=q(),G=0;G<a[l].length;G++)if(O=a[l][G],O.scope==le||O.scope=="all"){N=O.mods.length>0;for(L in s)(!s[L]&&C(O.mods,+L)>-1||s[L]&&C(O.mods,+L)==-1)&&(N=!1);(O.mods.length==0&&!s[16]&&!s[18]&&!s[17]&&!s[91]||N)&&O.method(r,O)===!1&&(r.preventDefault?r.preventDefault():r.returnValue=!1,r.stopPropagation&&r.stopPropagation(),r.cancelBubble&&(r.cancelBubble=!0))}}}function _(r){var l=r.keyCode,O,L=C(f,l);if(L>=0&&f.splice(L,1),(l==93||l==224)&&(l=91),l in s){s[l]=!1;for(O in p)p[O]==l&&(u[O]=!1)}}function h(){for(t in s)s[t]=!1;for(t in p)u[t]=!1}function u(r,l,O){var L,G;L=v(r),O===void 0&&(O=l,l="all");for(var N=0;N<L.length;N++)G=[],r=L[N].split("+"),r.length>1&&(G=P(r),r=[r[r.length-1]]),r=r[0],r=m(r),r in a||(a[r]=[]),a[r].push({shortcut:L[N],scope:l,method:O,key:L[N],mods:G})}function w(r,l){var O,L,G=[],N,le,Ee;for(O=v(r),le=0;le<O.length;le++){if(L=O[le].split("+"),L.length>1&&(G=P(L),r=L[L.length-1]),r=m(r),l===void 0&&(l=q()),!a[r])return;for(N=0;N<a[r].length;N++)Ee=a[r][N],Ee.scope===l&&i(Ee.mods,G)&&(a[r][N]={})}}function E(r){return typeof r=="string"&&(r=m(r)),C(f,r)!=-1}function k(){return f.slice(0)}function I(r){var l=(r.target||r.srcElement).tagName;return!(l=="INPUT"||l=="SELECT"||l=="TEXTAREA")}for(t in p)u[t]=!1;function X(r){d=r||"all"}function q(){return d||"all"}function A(r){var l,O,L;for(l in a)for(O=a[l],L=0;L<O.length;)O[L].scope===r?O.splice(L,1):L++}function v(r){var l;return r=r.replace(/\s/g,""),l=r.split(","),l[l.length-1]==""&&(l[l.length-2]+=","),l}function P(r){for(var l=r.slice(0,r.length-1),O=0;O<l.length;O++)l[O]=p[l[O]];return l}function K(r,l,O){r.addEventListener?r.addEventListener(l,O,!1):r.attachEvent&&r.attachEvent("on"+l,function(){O(window.event)})}K(document,"keydown",function(r){g(r)}),K(document,"keyup",_),K(window,"focus",h);var x=n.key;function B(){var r=n.key;return n.key=x,r}n.key=u,n.key.setScope=X,n.key.getScope=q,n.key.deleteScope=A,n.key.filter=I,n.key.isPressed=E,n.key.getPressedKeyCodes=k,n.key.noConflict=B,n.key.unbind=w,e.exports=u})(Vt)})(bt);var Z=bt.exports;const ee=re(),ne=e=>`${Tt.CTRL}+${e}`,Le=e=>`${Tt.SHIFT}+${e}`,J={[F.ARROW_UP]:ne("up"),[F.ARROW_RIGHT]:ne("right"),[F.ARROW_DOWN]:ne("down"),[F.ARROW_LEFT]:ne("left"),[F.COPY]:ne("c"),[F.CUT]:ne("x"),[F.PARSE]:ne("v"),[F.DELETE]:"delete",[F.BACK]:ne("z"),[F.FORWORD]:ne(Le("z")),[F.GROUP]:ne("g"),[F.UN_GROUP]:ne(Le("g")),[F.LOCK]:ne("l"),[F.UNLOCK]:ne(Le("l")),[F.HIDE]:ne("h"),[F.SHOW]:ne(Le("h"))},te=e=>`${xt.CTRL}+${e}`,Me=e=>`${xt.SHIFT}+${e}`,V={[F.ARROW_UP]:te("arrowup"),[F.ARROW_RIGHT]:te("arrowright"),[F.ARROW_DOWN]:te("arrowdown"),[F.ARROW_LEFT]:te("arrowleft"),[F.COPY]:te("c"),[F.CUT]:te("x"),[F.PARSE]:te("v"),[F.DELETE]:te("backspace"),[F.BACK]:te("z"),[F.FORWORD]:te(Me("z")),[F.GROUP]:te("g"),[F.UN_GROUP]:te(Me("g")),[F.LOCK]:te("l"),[F.UNLOCK]:te(Me("l")),[F.HIDE]:te("h"),[F.SHOW]:te(Me("h"))},wn=[J.up,J.right,J.down,J.left,J.delete,J.copy,J.cut,J.parse,J.back,J.forward,J.group,J.unGroup,J.lock,J.unLock,J.hide,J.show],Sn=[V.up,V.right,V.down,V.left,V.delete,V.copy,V.cut,V.parse,V.back,V.forward,V.group,V.unGroup,V.lock,V.unLock,V.hide,V.show],Tn=()=>{window.$KeyboardActive={ctrl:!1,space:!1},document.onkeydown=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(it(e.keyCode),n){case 17:window.$KeyboardActive.ctrl=!0;break;case 32:window.$KeyboardActive.space=!0;break}},document.onkeyup=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(it(),n){case 17:window.$KeyboardActive.ctrl=!1;break;case 32:window.$KeyboardActive.space=!1;break}}},xn=()=>{const n=(t,a)=>{switch(a){case t.up:Z(a,se(()=>(ee.setMove(F.ARROW_UP),!1),50));break;case t.right:Z(a,se(()=>(ee.setMove(F.ARROW_RIGHT),!1),50));break;case t.down:Z(a,se(()=>(ee.setMove(F.ARROW_DOWN),!1),50));break;case t.left:Z(a,se(()=>(ee.setMove(F.ARROW_LEFT),!1),50));break;case t.delete:Z(a,Ye(()=>(ee.removeComponentList(),!1),50));break;case t.copy:Z(a,Ye(()=>(ee.setCopy(),!1),50));break;case t.cut:Z(a,Ye(()=>(ee.setCut(),!1),50));break;case t.parse:Z(a,se(()=>(ee.setParse(),!1),50));break;case t.back:Z(a,se(()=>(ee.setBack(),!1),50));break;case t.forward:Z(a,se(()=>(ee.setForward(),!1),50));break;case t.group:Z(a,se(()=>(ee.setGroup(),!1),50));break;case t.unGroup:Z(a,se(()=>(ee.setUnGroup(),!1),50));break;case t.lock:Z(a,se(()=>(ee.setLock(),!1),50));break;case t.unLock:Z(a,se(()=>(ee.setUnLock(),!1),50));break;case t.hide:Z(a,se(()=>(ee.setHide(),!1),50));break;case t.show:Z(a,se(()=>(ee.setShow(),!1),50));break}};wn.forEach(t=>{n(J,t)}),Sn.forEach(t=>{n(V,t)}),Tn()},T=re(),{onClickOutSide:Dn}=ut(),An=e=>Se(void 0,null,function*(){e.preventDefault();try{gn();const n=e.dataTransfer.getData(Qt.DRAG_KEY);if(!n){ht();return}T.setEditCanvas(ae.IS_CREATE,!1);const t=Ve(n);let a;if(t.sourceID){let d=yield Nt(t.sourceID,t.category);if(!d){window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...");return}a=d.chartConfig}else a=t;let s=yield Kt(a);j(s,e.offsetX-s.attr.w/2,e.offsetY-s.attr.h/2),T.addComponentList(s,!1,!0),T.setTargetSelectChart(s.id),ht()}catch(n){_n(),window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...")}}),vt=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},Ot=(e,n)=>{if(n){T.setTargetSelectChart(n.id);return}T.setTargetSelectChart(void 0)},kn=(e,n)=>{var f;if(e.which==2||(f=window.$KeyboardActive)!=null&&f.space)return;Ot();const t=e.offsetX,a=e.offsetY,s=e.screenX,d=e.screenY,p=T.getEditCanvas.scale;T.setMousePosition(void 0,void 0,t,a);const y=Re.exports.throttle(C=>{T.setTargetSelectChart(),T.setEditCanvas(ae.IS_SELECT,!0);const i=t+C.screenX-s,c=a+C.screenY-d;T.setMousePosition(i,c);const S={x1:0,y1:0,x2:0,y2:0};i>t&&c>a?(S.x1=t,S.y1=a,S.x2=Math.round(t+(C.screenX-s)/p),S.y2=Math.round(a+(C.screenY-d)/p)):i>t&&c<a?(S.x1=t,S.y1=Math.round(a-(d-C.screenY)/p),S.x2=Math.round(t+(C.screenX-s)/p),S.y2=a):i<t&&c>a?(S.x1=Math.round(t-(s-C.screenX)/p),S.y1=a,S.x2=t,S.y2=Math.round(a+(C.screenY-d)/p)):(S.x1=Math.round(t-(s-C.screenX)/p),S.y1=Math.round(a-(d-C.screenY)/p),S.x2=t,S.y2=a),T.getComponentList.forEach(g=>{if(!T.getTargetChart.selectId.includes(g.id)){const{x:_,y:h,w:u,h:w}=g.attr,E={x1:_,y1:h,x2:_+u,y2:h+w};E.x1-S.x1>=0&&E.y1-S.y1>=0&&E.x2-S.x2<=0&&E.y2-S.y2<=0&&!g.status.lock&&!g.status.hide&&T.setTargetSelectChart(g.id,!0)}})},30),m=()=>{y.cancel(),T.setEditCanvas(ae.IS_SELECT,!1),T.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",m)};document.addEventListener("mousemove",y),document.addEventListener("mouseup",m)},Lt=()=>({mouseClickHandle:(s,d)=>{var p;if(s.preventDefault(),s.stopPropagation(),!d.status.lock&&(p=window.$KeyboardActive)!=null&&p.ctrl)if(T.targetChart.selectId.includes(d.id)){const y=T.targetChart.selectId.filter(m=>m!==d.id);T.setTargetSelectChart(y)}else T.setTargetSelectChart(d.id,!0)},mousedownHandle:(s,d)=>{var h;if(s.preventDefault(),s.stopPropagation(),d.status.lock||(Dn(),s.buttons===Ge.LEFT&&((h=window.$KeyboardActive)==null?void 0:h.ctrl)))return;const p=T.getTargetChart.selectId;if(s.buttons===Ge.RIGHT&&p.length>1&&p.includes(d.id)||(T.setTargetSelectChart(d.id),s.buttons===Ge.RIGHT))return;const y=T.getEditCanvas.scale,m=T.getEditCanvasConfig.width,f=T.getEditCanvasConfig.height,C=new Map;T.getTargetChart.selectId.forEach(u=>{const w=T.fetchTargetIndex(u);if(w!==-1){const{x:E,y:k,w:I,h:X}=Zt(T.getComponentList[w]).attr;C.set(u,{x:E,y:k,w:I,h:X})}});const i=s.screenX,c=s.screenY;let S=[];T.getTargetChart.selectId.forEach(u=>{if(!C.has(u))return;const w=T.fetchTargetIndex(u);S.push(Re.exports.cloneDeep(T.getComponentList[w]))}),T.setMousePosition(void 0,void 0,i,c);const g=Re.exports.throttle(u=>{T.setEditCanvas(ae.IS_DRAG,!0),T.setMousePosition(u.screenX,u.screenY);let w=(u.screenX-i)/y,E=(u.screenY-c)/y;T.getTargetChart.selectId.forEach(k=>{if(!C.has(k))return;const I=T.fetchTargetIndex(k),{x:X,y:q,w:A,h:v}=C.get(k),P=T.getComponentList[I];let K=Math.round(X+w),x=Math.round(q+E);const B=50;K=K<-A+B?-A+B:K,x=x<-v+B?-v+B:x,K=K>m-B?m-B:K,x=x>f-B?f-B:x,P&&!Number.isNaN(K)&&!Number.isNaN(x)&&(P.attr=Object.assign(P.attr,{x:K,y:x}))})},20),_=()=>{try{T.setMousePosition(0,0,0,0),T.setEditCanvas(ae.IS_DRAG,!1),S.length&&(T.getTargetChart.selectId.forEach(u=>{if(!C.has(u))return;const w=T.fetchTargetIndex(u),E=T.getComponentList[w];S.forEach(k=>{k.id===u&&(k.attr=Object.assign(k.attr,{offsetX:E.attr.x-k.attr.x,offsetY:E.attr.y-k.attr.y}))})}),T.moveComponentList(S)),document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",_)}catch(u){console.log(u)}};document.addEventListener("mousemove",g),document.addEventListener("mouseup",_)},mouseenterHandle:(s,d)=>{s.preventDefault(),s.stopPropagation(),T.getEditCanvas.isSelect||T.setTargetHoverChart(d.id)},mouseleaveHandle:(s,d)=>{s.preventDefault(),s.stopPropagation(),T.setEditCanvas(ae.IS_DRAG,!1),T.setTargetHoverChart(void 0)}}),Fn=(e,n,t)=>{e.stopPropagation(),e.preventDefault(),T.setEditCanvas(ae.IS_DRAG,!0);const a=T.getEditCanvas.scale,s=t.x,d=t.y,p=t.w,y=t.h,m=e.screenX,f=e.screenY;T.setMousePosition(m,f);const C=Re.exports.throttle(c=>{T.setMousePosition(c.screenX,c.screenY);let S=Math.round((c.screenX-m)/a),g=Math.round((c.screenY-f)/a);const _=/t/.test(n),h=/b/.test(n),u=/l/.test(n),w=/r/.test(n),E=y+(_?-g:h?g:0),k=p+(u?-S:w?S:0);t.h=E>0?E:0,t.w=k>0?k:0,t.x=s+(u?S:0),t.y=d+(_?g:0)},50),i=()=>{T.setEditCanvas(ae.IS_DRAG,!1),T.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",i)};document.addEventListener("mousemove",C),document.addEventListener("mouseup",i)};const bn=["onMousedown"],On=ue({__name:"index",props:{item:{type:Object,required:!0},hiddenPoint:{type:Boolean,required:!1}},setup(e){const n=e;Ae(i=>({"026d39a0":o(p)}));const t=ke(),a=re(),s=["t","r","b","l","lt","rt","lb","rb"],d=["n","e","s","w","nw","ne","sw","se"],p=$(()=>t.getAppTheme),y=$(()=>n.item.status.lock?!1:n.item.id===a.getTargetChart.hoverId),m=$(()=>{const i=n.item.id;return n.item.status.lock?!1:a.getTargetChart.selectId.find(c=>c===i)}),f=$(()=>n.item.status.lock),C=$(()=>n.item.status.hide);return(i,c)=>(D(),z("div",{class:ie(["go-shape-box",{lock:o(f),hide:o(C)}])},[at(i.$slots,"default",{},void 0,!0),e.hiddenPoint?fe("",!0):(D(!0),z(he,{key:0},_e(o(m)?s:[],(S,g)=>(D(),z("div",{class:ie(`shape-point ${S}`),key:g,style:oe(o(Yt)(S,g,e.item.attr,d)),onMousedown:_=>o(Fn)(_,S,e.item.attr)},null,46,bn))),128)),W("div",{class:"shape-modal",style:oe(o(Ce)(e.item.attr))},[W("div",{class:ie(["shape-modal-select",{active:o(m)}])},null,2),W("div",{class:ie(["shape-modal-change",{selectActive:o(m),hoverActive:o(y)}])},null,2)],4)],2))}});var et=ce(On,[["__scopeId","data-v-5f8854aa"]]);const Ln={class:"go-edit-group-box"},Mn=ue({__name:"index",props:{groupData:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){const n=re(),{handleContextMenu:t}=ut(),{mouseenterHandle:a,mouseleaveHandle:s,mousedownHandle:d,mouseClickHandle:p}=Lt(),y=(C,i,c)=>{const S=g=>i.filter(_=>g.includes(_.key));if(n.getTargetChart.selectId.length>1)return S([F.GROUP,F.DELETE]);{const g=[];c.status.lock?g.push(F.LOCK):g.push(F.UNLOCK),c.status.hide?g.push(F.HIDE):g.push(F.SHOW);const _=[F.UN_GROUP];return[...S(_),vn(),...C.filter(h=>!g.includes(h.key))]}},m=$(()=>{const C=n.getEditCanvasConfig.chartThemeColor;return Et[C]}),f=$(()=>n.getEditCanvasConfig.chartThemeSetting);return(C,i)=>(D(),z("div",Ln,[(D(),U(o(et),{key:e.groupData.id,"data-id":e.groupData.id,index:e.groupIndex,item:e.groupData,hiddenPoint:!0,class:ie(o(Qe)(e.groupData.styles.animations)),style:oe(Y(Y(Y(Y(Y({},o(Ie)(e.groupData.attr,e.groupIndex)),o(Ce)(e.groupData.attr)),o(He)(e.groupData.styles)),o(Ze)(e.groupData.styles)),o(Dt)(e.groupData.styles))),onClick:i[0]||(i[0]=c=>o(p)(c,e.groupData)),onMousedown:i[1]||(i[1]=c=>o(d)(c,e.groupData)),onMouseenter:i[2]||(i[2]=c=>o(a)(c,e.groupData)),onMouseleave:i[3]||(i[3]=c=>o(s)(c,e.groupData)),onContextmenu:i[4]||(i[4]=c=>o(t)(c,e.groupData,y))},{default:b(()=>[(D(!0),z(he,null,_e(e.groupData.groupList,c=>(D(),U(o(et),{key:c.id,"data-id":c.id,index:e.groupIndex,item:c,hiddenPoint:!0,style:oe(Y({},o(Ie)(c.attr,e.groupIndex)))},{default:b(()=>[(D(),U(me(c.chartConfig.chartKey),{class:ie(["edit-content-chart",o(Qe)(c.styles.animations)]),chartConfig:c,themeSetting:o(f),themeColor:o(m),style:oe(Y(Y(Y({},o(Ce)(c.attr)),o(He)(c.styles)),o(Ze)(c.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","item","style"]))),128))]),_:1},8,["data-id","index","item","class","style"]))]))}});const Bn={class:"go-edit-align-line"},Rn=ue({__name:"index",setup(e){Ae(g=>({42514545:o(p)}));const n=ke(),t=re(),a=rt(),s=$e({lineArr:["rowt","rowc","rowb","coll","colc","colr"],select:new Map,sorptioned:{x:!1,y:!1}}),d=g=>g?{left:`${g.x?g.x:0}px`,top:`${g.y?g.y:0}px`}:{},p=$(()=>n.getAppTheme),y=$(()=>a.getChartAlignRange),m=$(()=>t.getEditCanvas[ae.IS_DRAG]),f=(g,_)=>Math.abs(g-_)<=y.value,C=$(()=>t.getTargetChart.selectId),i=$(()=>t.getComponentList[t.fetchTargetIndex()]),c=$(()=>{var g;return((g=i.value)==null?void 0:g.attr)||{}}),S=$(()=>({id:"0",attr:{w:dt(t.getEditCanvasConfig.width),h:dt(t.getEditCanvasConfig.height),x:0,y:0,offsetX:0,offsetY:0,zIndex:0}}));return pe(()=>t.getMousePosition,se(()=>{try{if(!m.value||C.value.length!==1)return;const g=c.value.w,_=c.value.h,h=c.value.x,u=h+g/2,w=h+g,E=[h,u,w],k=c.value.y,I=k+_/2,X=k+_,q=[k,I,X];s.select.clear(),s.sorptioned.y=!1;const A=t.getComponentList.map(v=>({id:v.id,attr:v.attr}));A.push(S.value),s.lineArr.forEach(v=>{A.forEach(P=>{if(C.value[0]===P.id)return;const K=P.attr.w,x=P.attr.h,B=P.attr.x,r=B+K/2,l=B+K,O=[B,r,l],L=P.attr.y,G=L+x/2,N=L+x,le=[L,G,N];v.includes("rowt")&&(f(k,L)&&(s.select.set(v,{y:L}),j(i.value,h,L)),f(k,G)&&(s.select.set(v,{y:G}),j(i.value,h,G)),f(k,N)&&(s.select.set(v,{y:N}),j(i.value,h,N))),v.includes("rowc")&&(f(I,L)&&(s.select.set(v,{y:L}),j(i.value,h,L-_/2)),f(I,G)&&(s.select.set(v,{y:G}),j(i.value,h,G-_/2)),f(I,N)&&(s.select.set(v,{y:N}),j(i.value,h,N-_/2))),v.includes("rowb")&&(f(X,L)&&(s.select.set(v,{y:L}),j(i.value,h,L-_)),f(X,G)&&(s.select.set(v,{y:G}),j(i.value,h,G-_)),f(X,N)&&(s.select.set(v,{y:N}),j(i.value,h,N-_))),v.includes("coll")&&(f(h,B)&&(s.select.set(v,{x:B}),j(i.value,B,k)),f(h,r)&&(s.select.set(v,{x:r}),j(i.value,r,k)),f(h,l)&&(s.select.set(v,{x:l}),j(i.value,l,k))),v.includes("colc")&&(f(u,B)&&(s.select.set(v,{x:B}),j(i.value,B-g/2,k)),f(u,r)&&(s.select.set(v,{x:r}),j(i.value,r-g/2,k)),f(u,l)&&(s.select.set(v,{x:l}),j(i.value,l-g/2,k))),v.includes("colr")&&(f(w,B)&&(s.select.set(v,{x:B}),j(i.value,B-g,k)),f(w,r)&&(s.select.set(v,{x:r}),j(i.value,r-g,k)),f(w,l)&&(s.select.set(v,{x:l}),j(i.value,l-g,k)))})})}catch(g){console.log(g)}},200),{deep:!0}),pe(()=>m.value,g=>{g||(s.select.clear(),s.sorptioned.y=!1)}),(g,_)=>(D(),z("div",Bn,[(D(!0),z(he,null,_e(s.lineArr,h=>(D(),z("div",{class:ie(["line",[h.includes("row")?"row":"col",s.select.has(h)&&"visible"]]),key:h,style:oe(d(s.select.get(h)))},null,6))),128))]))}});var In=ce(Rn,[["__scopeId","data-v-403a9eed"]]);const Hn=ue({__name:"index",setup(e){return(n,t)=>{const a=H("n-watermark");return D(),U(a,{id:"go-edit-watermark",content:o(en),cross:"",selectable:"","font-size":16,"line-height":16,width:500,height:150,"x-offset":12,"y-offset":80,rotate:-15},null,8,["content"])}}});var Pn=ce(Hn,[["__scopeId","data-v-e5cd93da"]]);const Mt=e=>(At("data-v-71d41248"),e=e(),kt(),e),$n=Mt(()=>W("div",{class:"select-background"},null,-1)),Un=Mt(()=>W("div",{class:"select-border"},null,-1)),Nn=[$n,Un],Kn=ue({__name:"index",setup(e){Ae(y=>({c29aca42:o(d)}));const n=ke(),t=re(),{isSelect:a,scale:s}=Ue(t.getEditCanvas),d=$(()=>n.getAppTheme),p=Q();return pe(()=>t.getMousePosition,y=>{if(!a.value)return;const{startX:m,startY:f,x:C,y:i}=y,c={zIndex:ft,x:0,y:0,w:0,h:0,offsetX:0,offsetY:0};C>m&&i>f?(c.x=m,c.y=f,c.w=Math.round((C-m)/s.value),c.h=Math.round((i-f)/s.value)):C>m&&i<f?(c.x=m,c.w=Math.round((C-m)/s.value),c.h=Math.round((f-i)/s.value),c.y=f-c.h):C<m&&i>f?(c.y=f,c.w=Math.round((m-C)/s.value),c.h=Math.round((i-f)/s.value),c.x=m-c.w):(c.w=Math.round((m-C)/s.value),c.h=Math.round((f-i)/s.value),c.x=m-c.w,c.y=f-c.h),p.value=Y(Y({},Ie(c,ft)),Ce(c))},{deep:!0}),(y,m)=>o(a)?(D(),z("div",{key:0,class:"go-edit-select",style:oe(p.value)},Nn,4)):fe("",!0)}});var Yn=ce(Kn,[["__scopeId","data-v-71d41248"]]);const Gn=ue({__name:"index",setup(e){const n=re(),{getEditCanvasConfig:t,getEditCanvas:a}=Ue(n),s=$(()=>({w:t.value.width,h:t.value.height})),d=$(()=>{const y={transform:`scale(${a.value.scale})`};return Y(Y({},Ce(s.value)),y)}),p=$(()=>{const y=a.value.isCreate&&{"z-index":99999};return Y(Y({},Ce(s.value)),y)});return(y,m)=>(D(),z("div",{class:"go-edit-range go-transition",style:oe(o(d)),onMousedown:m[0]||(m[0]=f=>o(kn)(f,void 0))},[at(y.$slots,"default",{},void 0,!0),M(o(Pn)),M(o(In)),M(o(Yn)),W("div",{class:"go-edit-range-model",style:oe(o(p))},null,4)],36))}});var Xn=ce(Gn,[["__scopeId","data-v-52e445d0"]]),Bt=!!(typeof window!="undefined"&&window.document&&window.document.createElement),tt=!1,nt=!1;try{var qe={get passive(){return tt=!0},get once(){return nt=tt=!0}};Bt&&(window.addEventListener("test",qe,qe),window.removeEventListener("test",qe,!0))}catch(e){}function Wn(e,n,t,a){if(a&&typeof a!="boolean"&&!nt){var s=a.once,d=a.capture,p=t;!nt&&s&&(p=t.__once||function y(m){this.removeEventListener(n,y,d),t.call(this,m)},t.__once=p),e.addEventListener(n,p,tt?a:d)}e.addEventListener(n,t,a)}function zn(e,n,t,a){var s=a&&typeof a!="boolean"?a.capture:a;e.removeEventListener(n,t,s),t.__once&&e.removeEventListener(n,t.__once,s)}function gt(e,n,t,a){return Wn(e,n,t,a),function(){zn(e,n,t,a)}}var _t=new Date().getTime();function jn(e){var n=new Date().getTime(),t=Math.max(0,16-(n-_t)),a=setTimeout(e,t);return _t=n,a}var qn=["","webkit","moz","o","ms"],mt=jn,Ct=function(n,t){return n+(n?t[0].toUpperCase()+t.substr(1):t)+"AnimationFrame"};Bt&&qn.some(function(e){var n=Ct(e,"request");return n in window&&(Ct(e,"cancel"),mt=function(a){return window[n](a)}),!!mt});Function.prototype.bind.call(Function.prototype.call,[].slice);Function.prototype.bind.call(Function.prototype.call,[].slice);const Jn={class:"go-sketch-rule"},Vn={key:1,class:"fix-edit-screens-block"},Qn=ue({__name:"index",setup(e){Ae(x=>({"6f694401":o(I),ed8dd9a8:o(E),"58b617f4":c.value}));const n=re(),t=Gt(),a=ke(),s=20;let d=[0,0],p=[0,0];const y=Q(),m=Q(!0),f=Q(),C=Q(),i=Q(!1),c=Q("auto"),{width:S,height:g}=Ue(n.getEditCanvasConfig),_=Q(0),h=Q(0),u=$e({h:[],v:[]}),w=$(()=>n.getEditCanvas.scale),E=$(()=>`${g.value*2}px`),k=$(()=>a.getDarkTheme?{bgColor:"#18181c",longfgColor:"#4d4d4d",shortfgColor:"#4d4d4d",fontColor:"#4d4d4d",shadowColor:"#18181c",borderColor:"#18181c",cornerActiveColor:"#18181c"}:{}),I=$(()=>a.getAppTheme),X=x=>{if(x.ctrlKey||x.metaKey){x.preventDefault();let B=w.value;if(x.wheelDelta>=0&&w.value<2){B=w.value+.05,n.setScale(B);return}x.wheelDelta<0&&w.value>.1&&(B=w.value-.05,n.setScale(B))}},q=()=>{if(!y.value)return;const x=y.value.getBoundingClientRect(),B=f.value.getBoundingClientRect();_.value=(x.left+s-B.left)/w.value,h.value=(x.top+s-B.top)/w.value},A=x=>{var L,G;if(x.preventDefault(),x.stopPropagation(),x.which==2)i.value=!0;else if(!((L=window.$KeyboardActive)!=null&&L.space))return;(G=document.activeElement)==null||G.blur();const B=x.pageX,r=x.pageY,l=gt(window,"mousemove",N=>{const le=N.pageX-B,Ee=N.pageY-r,[Ne,Fe]=d,[Ke,be]=p;d=[Fe,le],p=[be,Ee],y.value.scrollLeft-=Fe>Ne?Math.abs(Fe-Ne):-Math.abs(Fe-Ne),y.value.scrollTop-=be>Ke?Math.abs(be-Ke):-Math.abs(be-Ke)}),O=gt(window,"mouseup",()=>{l(),O(),d=[0,0],p=[0,0],i.value=!1})},v=()=>{const x=document.getElementById("go-chart-edit-layout");return x?{height:x.clientHeight-25,width:x.clientWidth}:{width:S.value,height:g.value}},P=()=>{m.value=!1,setTimeout(()=>{m.value=!0},10)},K=()=>{const{width:x,height:B}=C.value.getBoundingClientRect(),{width:r,height:l}=v();y.value.scrollLeft=x/2-r/2,y.value.scrollTop=B/2-l/2};return pe(()=>a.getDarkTheme,()=>{P()}),pe(()=>w.value,(x,B)=>{B!==x?(t.setItemUnHandle(Xt.RE_POSITION_CANVAS,!1),q(),setTimeout(()=>{K(),P()},400)):se(P,20)}),pe(()=>i.value,x=>{c.value=x?"grab":"auto"}),ot(()=>{y.value&&(y.value.addEventListener("wheel",X,{passive:!1}),K())}),St(()=>{y.value&&y.value.removeEventListener("wheel",X)}),window.onKeySpacePressHold=x=>{i.value=x},(x,B)=>{const r=H("sketch-rule");return D(),z("div",Jn,[m.value?(D(),U(r,{key:0,thick:s,scale:o(w),width:v().width,height:v().height,startX:_.value,startY:h.value,lines:u,palette:o(k)},null,8,["scale","width","height","startX","startY","lines","palette"])):fe("",!0),W("div",{ref_key:"$app",ref:y,class:"edit-screens",onScroll:q},[W("div",{ref_key:"$container",ref:C,class:"edit-screen-container",style:oe({width:o(S)*2+"px"})},[W("div",{ref_key:"refSketchRuleBox",ref:f,class:"canvas",onMousedown:A,style:oe({marginLeft:"-"+(v().width/2-25)+"px"})},[W("div",{style:oe({pointerEvents:i.value?"none":"auto"})},[at(x.$slots,"default",{},void 0,!0)],4)],36)],4)],544),o(a).getDarkTheme?(D(),z("div",Vn)):fe("",!0)])}}});var Zn=ce(Qn,[["__scopeId","data-v-12b70182"]]);const Je={[R.ADD]:"\u65B0\u589E",[R.DELETE]:"\u5220\u9664",[R.UPDATE]:"\u66F4\u65B0",[R.MOVE]:"\u79FB\u52A8",[R.PASTE]:"\u7C98\u8D34",[R.COPY]:"\u590D\u5236",[R.CUT]:"\u526A\u5207",[R.TOP]:"\u7F6E\u9876",[R.BOTTOM]:"\u7F6E\u5E95",[R.UP]:"\u4E0A\u79FB",[R.DOWN]:"\u4E0B\u79FB",[R.GROUP]:"\u6210\u7EC4",[R.UN_GROUP]:"\u89E3\u7EC4",[R.LOCK]:"\u9501\u5B9A",[R.UNLOCK]:"\u89E3\u9501",[R.HIDE]:"\u9690\u85CF",[R.SHOW]:"\u663E\u793A",[Be.CANVAS]:"\u753B\u5E03\u521D\u59CB\u5316"};var es=Array.prototype,ts=es.reverse;function ns(e){return e==null?e:ts.call(e)}var ss=ns;const Rt=e=>(At("data-v-5a4fd660"),e=e(),kt(),e),os={class:"go-flex-items-center"},as=Rt(()=>W("span",{class:"btn-text"},"\u5386\u53F2\u8BB0\u5F55",-1)),rs={class:"history-list-box"},us=["title"],cs=Rt(()=>W("div",{class:"popover-modal"},null,-1)),ls=ue({__name:"index",setup(e){const{DesktopOutlineIcon:n,PencilIcon:t,TrashIcon:a,CopyIcon:s,LayersIcon:d,DuplicateIcon:p,HelpOutlineIcon:y,LockClosedOutlineIcon:m,LockOpenOutlineIcon:f,EyeOffOutlineIcon:C,EyeOutlineIcon:i}=De.ionicons5,{StackedMoveIcon:c,Carbon3DCursorIcon:S,Carbon3DSoftwareIcon:g}=De.carbon,_=Wt(),h=E=>{if(E.targetType===Be.CANVAS)return n;switch(E.actionType){case R.UPDATE:return t;case R.DELETE:return a;case R.PASTE:return s;case R.TOP:return d;case R.BOTTOM:return d;case R.UP:return d;case R.DOWN:return d;case R.MOVE:return c;case R.ADD:return p;case R.GROUP:return S;case R.UN_GROUP:return g;case R.LOCK:return m;case R.UNLOCK:return f;case R.HIDE:return C;case R.SHOW:return i;default:return t}},u=E=>{if(E.targetType===Be.CANVAS)return Je[Be.CANVAS];if(E.actionType===R.GROUP||E.actionType===R.UN_GROUP)return`${Je[E.actionType]}`;if(E.historyData.length)return`${Je[E.actionType]} - ${E.historyData[0].chartConfig.title}`},w=$(()=>{const k=_.getBackStack.map(I=>({label:u(I),icon:h(I)}));return ss(k.filter(I=>I.label))});return(E,k)=>{const I=H("n-button"),X=H("n-icon"),q=H("n-text"),A=H("n-scrollbar"),v=H("n-popover"),P=H("n-tooltip");return D(),z("div",os,[M(v,{class:"edit-history-popover","show-arrow":!1,size:"small",trigger:"click",placement:"top-start"},{trigger:b(()=>[M(I,{class:"mr-10",secondary:"",size:"small",disabled:o(w).length===0},{default:b(()=>[as]),_:1},8,["disabled"])]),default:b(()=>[W("div",rs,[M(A,{style:{"max-height":"500px"}},{default:b(()=>[(D(!0),z(he,null,_e(o(w),(K,x)=>(D(),z("div",{class:"list-item go-flex-items-center go-ellipsis-1",key:x,title:K.label},[M(X,{class:"item-icon",size:"16",depth:2,component:K.icon},null,8,["component"]),M(q,{depth:"2"},{default:b(()=>[ye(de(K.label),1)]),_:2},1024)],8,us))),128))]),_:1}),cs])]),_:1}),M(P,{trigger:"hover"},{trigger:b(()=>[M(X,{size:"21",depth:3},{default:b(()=>[M(o(y))]),_:1})]),default:b(()=>[W("span",null,"\u6700\u591A\u53EA\u4FDD\u7559"+de(o(tn))+"\u6761\u8BB0\u5F55",1)]),_:1})])}}});var is=ce(ls,[["__scopeId","data-v-5a4fd660"]]);const ds={class:"go-edit-bottom"},fs=ue({__name:"index",setup(e){Ae(h=>({f3add9fc:s.value}));const{LockClosedOutlineIcon:n,LockOpenOutlineIcon:t}=De.ionicons5,a=ke(),s=Q(a.getAppTheme),d=re(),{lockScale:p,scale:y}=Ue(d.getEditCanvas);let m=[{label:"200%",value:200},{label:"150%",value:150},{label:"100%",value:100},{label:"50%",value:50},{label:"\u81EA\u9002\u5E94",value:0}];const f=Q(""),C=h=>{if(h===0){d.computedScale();return}d.setScale(h/100)},i=()=>{d.setEditCanvas(ae.LOCK_SCALE,!p.value)},c=Q(100),S=h=>`${h}%`,g=h=>{d.setScale(h/100)},_=$e({100:""});return nn(()=>{const h=(y.value*100).toFixed(0);f.value=`${h}%`,c.value=parseInt(h)}),(h,u)=>{const w=H("n-text"),E=H("n-space"),k=H("n-select"),I=H("n-icon"),X=H("n-button"),q=H("n-tooltip"),A=H("n-slider");return D(),z("div",ds,[M(E,null,{default:b(()=>[M(o(is)),M(w,{id:"keyboard-dress-show",depth:"3"})]),_:1}),M(E,{class:"bottom-ri"},{default:b(()=>[M(yn),M(k,{disabled:o(p),class:"scale-btn",value:f.value,"onUpdate:value":[u[0]||(u[0]=v=>f.value=v),C],size:"mini",options:o(m)},null,8,["disabled","value","options"]),M(q,{trigger:"hover"},{trigger:b(()=>[M(X,{onClick:i,text:""},{default:b(()=>[M(I,{class:ie(["lock-icon",{color:o(p)}]),size:"18",depth:2},{default:b(()=>[o(p)?(D(),U(o(n),{key:0})):(D(),U(o(t),{key:1}))]),_:1},8,["class"])]),_:1})]),default:b(()=>[W("span",null,de(o(p)?"\u89E3\u9501":"\u9501\u5B9A")+"\u5F53\u524D\u6BD4\u4F8B",1)]),_:1}),M(A,{class:"scale-slider",value:c.value,"onUpdate:value":[u[1]||(u[1]=v=>c.value=v),g],"default-value":50,min:10,max:200,step:5,"format-tooltip":S,disabled:o(p),marks:_},null,8,["value","disabled","marks"])]),_:1})])}}});var ps=ce(fs,[["__scopeId","data-v-99a534fc"]]);const hs=ye("\u7CFB\u7EDF\u8BBE\u7F6E"),vs=ue({__name:"index",props:{modelShow:Boolean},emits:["update:modelShow"],setup(e,{emit:n}){const t=e,{HelpOutlineIcon:a,CloseIcon:s}=De.ionicons5,d=rt(),p=Q(!1),y=$e([{key:ve.ASIDE_ALL_COLLAPSED,value:d.getAsideAllCollapsed,type:"switch",name:"\u83DC\u5355\u6298\u53E0",desc:"\u9996\u9875\u83DC\u5355\u6298\u53E0\u65F6\u9690\u85CF\u81F3\u754C\u9762\u5916"},{key:ve.HIDE_PACKAGE_ONE_CATEGORY,value:d.getHidePackageOneCategory,type:"switch",name:"\u9690\u85CF\u5206\u7C7B",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u8868\u5355\u5206\u7C7B\u53EA\u6709\u5355\u9879\u65F6\u9690\u85CF"},{key:ve.CHANGE_LANG_RELOAD,value:d.getChangeLangReload,type:"switch",name:"\u5207\u6362\u8BED\u8A00",desc:"\u5207\u6362\u8BED\u8A00\u91CD\u65B0\u52A0\u8F7D\u9875\u9762",tip:"\u82E5\u9047\u5230\u90E8\u5206\u533A\u57DF\u8BED\u8A00\u5207\u6362\u5931\u8D25\uFF0C\u5219\u5EFA\u8BAE\u5F00\u542F"},{key:"divider1",type:"divider",name:"",desc:"",value:""},{key:ve.CHART_TOOLS_STATUS_HIDE,value:d.getChartToolsStatusHide,type:"switch",name:"\u9690\u85CF\u5DE5\u5177\u680F",desc:"\u9F20\u6807\u79FB\u5165\u65F6\uFF0C\u4F1A\u5C55\u793A\u5207\u6362\u5230\u5C55\u5F00\u6A21\u5F0F"},{key:ve.CHART_TOOLS_STATUS,value:d.getChartToolsStatus,type:"select",name:"\u5DE5\u5177\u680F\u5C55\u793A",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u5DE5\u5177\u680F\u5C55\u793A\u65B9\u5F0F",options:[{label:"\u4FA7\u8FB9\u680F",value:Pe.ASIDE},{label:"\u5E95\u90E8 Dock",value:Pe.DOCK}]},{key:"divider0",type:"divider",name:"",desc:"",value:""},{key:ve.CHART_MOVE_DISTANCE,value:d.getChartMoveDistance,type:"number",name:"\u79FB\u52A8\u8DDD\u79BB",min:1,step:1,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u65B9\u5411\u952E\u63A7\u5236\u79FB\u52A8\u8DDD\u79BB"},{key:ve.CHART_ALIGN_RANGE,value:d.getChartAlignRange,type:"number",name:"\u5438\u9644\u8DDD\u79BB",min:10,step:2,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u79FB\u52A8\u56FE\u8868\u65F6\u7684\u5438\u9644\u8DDD\u79BB"}]);pe(()=>t.modelShow,C=>{p.value=C});const m=()=>{n("update:modelShow",!1)},f=(C,i)=>{d.setItem(i.key,i.value)};return(C,i)=>{const c=H("n-h3"),S=H("n-icon"),g=H("n-space"),_=H("n-divider"),h=H("n-text"),u=H("n-switch"),w=H("n-input-number"),E=H("n-select"),k=H("n-tooltip"),I=H("n-list-item"),X=H("n-list"),q=H("n-modal");return D(),U(q,{show:p.value,"onUpdate:show":i[0]||(i[0]=A=>p.value=A),onAfterLeave:m},{default:b(()=>[M(X,{bordered:"",class:"go-system-setting"},{header:b(()=>[M(g,{justify:"space-between"},{default:b(()=>[M(c,{class:"go-mb-0"},{default:b(()=>[hs]),_:1}),M(S,{size:"20",class:"go-cursor-pointer",onClick:m},{default:b(()=>[M(o(s))]),_:1})]),_:1})]),default:b(()=>[(D(!0),z(he,null,_e(y,A=>(D(),U(I,{key:A.key},{default:b(()=>[A.type==="divider"?(D(),U(_,{key:0,style:{margin:"0"}})):(D(),U(g,{key:1,size:40},{default:b(()=>[M(g,null,{default:b(()=>[M(h,{class:"item-left"},{default:b(()=>[ye(de(A.name),1)]),_:2},1024),A.type==="switch"?(D(),U(u,{key:0,value:A.value,"onUpdate:value":[v=>A.value=v,v=>f(v,A)],size:"small"},null,8,["value","onUpdate:value"])):A.type==="number"?(D(),U(w,{key:1,value:A.value,"onUpdate:value":[v=>A.value=v,v=>f(v,A)],class:"input-num-width",size:"small",step:A.step||null,suffix:A.suffix||null,min:A.min||0},null,8,["value","onUpdate:value","step","suffix","min"])):A.type==="select"?(D(),U(E,{key:2,class:"select-min-width",value:A.value,"onUpdate:value":[v=>A.value=v,v=>f(v,A)],size:"small",options:A.options},null,8,["value","onUpdate:value","options"])):fe("",!0)]),_:2},1024),M(g,null,{default:b(()=>[M(h,{class:"item-right"},{default:b(()=>[ye(de(A.desc),1)]),_:2},1024),A.tip?(D(),U(k,{key:0,trigger:"hover"},{trigger:b(()=>[M(S,{size:"21"},{default:b(()=>[M(o(a))]),_:1})]),default:b(()=>[W("span",null,de(A.tip),1)]),_:2},1024)):fe("",!0)]),_:2},1024)]),_:2},1024))]),_:2},1024))),128))]),_:1})]),_:1},8,["show"])}}});var gs=ce(vs,[["__scopeId","data-v-7cea0aa5"]]);const xe=re(),_s=()=>{xe.setTargetSelectChart(void 0),sn(on(xe.getStorageInfo||[]),void 0,"json");const e=document.querySelector(".go-edit-range"),n=document.getElementById("go-edit-watermark");if(!e||!n){window.$message.error("\u5BFC\u51FA\u5931\u8D25\uFF01");return}const t=xe.getEditCanvas.scale;xe.setScale(1,!0),n.style.display="block",setTimeout(()=>{an(e,()=>{n&&(n.style.display="none"),xe.setScale(t,!0)})},600)};var st=(e=>(e.TXT="text/plain",e.JSON="application/json",e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e))(st||{});const ms=()=>{const e=Q(),{updateComponent:n}=wt();return{importUploadFileListRef:e,importBeforeUpload:({file:s})=>{e.value=[];const d=s.file.type;return d!==st.JSON&&d!==st.TXT?(window.$message.warning("\u4EC5\u652F\u6301\u4E0A\u4F20 \u3010JSON\u3011 \u683C\u5F0F\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20\uFF01"),!1):!0},importCustomRequest:s=>{const{file:d}=s;rn(()=>{d.file?un(d.file).then(p=>{mn({message:"\u8BF7\u9009\u62E9\u5BFC\u5165\u65B9\u5F0F:",positiveText:"\u65B0\u589E\uFF08\u53EF\u64A4\u56DE\uFF09",negativeText:"\u8986\u76D6\uFF08\u4E0D\u53EF\u64A4\u56DE\uFF09",negativeButtonProps:{type:"info",ghost:!1},onPositiveCallback:()=>Se(void 0,null,function*(){try{p=Ve(p),yield n(p,!1,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(y){console.log(y),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}}),onNegativeCallback:()=>Se(void 0,null,function*(){try{p=Ve(p),yield n(p,!0,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(y){console.log(y),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}})})}):window.$message.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6216\u8054\u7CFB\u7BA1\u7406\u5458\uFF01")})}}},{updateComponent:Cs,dataSyncUpdate:yt}=wt(),ys=re(),Es=()=>{const e=d=>Cs(d.detail,!0,!1),n=()=>Se(void 0,null,function*(){yt&&(yield yt()),dispatchEvent(new CustomEvent(Xe.CHART,{detail:ys.getStorageInfo}))}),t=()=>{addEventListener("blur",n),addEventListener(Xe.JSON,e)},a=()=>{removeEventListener(Xe.JSON,e),removeEventListener("blur",n)};return(d,p)=>{p==pt.CHART_HOME_NAME&&a(),d==pt.CHART_HOME_NAME&&t()}},ws=()=>{const e=Ft();pe(()=>e.name,Es(),{immediate:!0})};var ge=(e=>(e.BUTTON="button",e.IMPORTUPLOAD="importUpload",e))(ge||{});const Ss={class:"btn-item"},Ts=ue({__name:"index",setup(e){const{DownloadIcon:n,ShareIcon:t,PawIcon:a,SettingsSharpIcon:s,CreateIcon:d}=De.ionicons5,p=rt(),y=re();Ft(),ws();let m=null;const f=Q(!1),C=Q(!0),i=Q(!0),{importUploadFileListRef:c,importCustomRequest:S,importBeforeUpload:g}=ms(),_=$(()=>p.getChartToolsStatus===Pe.ASIDE),h=$(()=>p.getChartToolsStatusHide),u=$(()=>C.value&&h.value),w=$(()=>{if(!_.value)return q;const A=[];return q.map(v=>{A.unshift(v)}),A}),E=()=>{m=setTimeout(()=>{C.value&&(C.value=!1,i.value=!0)},200),setTimeout(()=>{i.value=!1},400)},k=()=>{clearTimeout(m),C.value||(C.value=!0)},I=()=>{window.$message.warning("\u5C06\u5F00\u542F\u5931\u7126\u66F4\u65B0\uFF01"),setTimeout(()=>{const A=ln(dn.CHART_EDIT_NAME,"href");if(!A)return;const v=fn();X(v),pn(A,[v],void 0,!0)},1e3)},X=A=>{const v=y.getStorageInfo,P=hn(Oe.GO_CHART_STORAGE_LIST)||[];if(P!=null&&P.length){const K=P.findIndex(x=>x.id===A);K!==-1?(P.splice(K,1,we(Y({},v),{id:A})),je(Oe.GO_CHART_STORAGE_LIST,P)):(P.push(we(Y({},v),{id:A})),je(Oe.GO_CHART_STORAGE_LIST,P))}else je(Oe.GO_CHART_STORAGE_LIST,[we(Y({},v),{id:A})])},q=[{key:"import",type:ge.IMPORTUPLOAD,name:"\u5BFC\u5165",icon:t},{key:"export",type:ge.BUTTON,name:"\u5BFC\u51FA",icon:n,handle:_s},{key:"edit",type:ge.BUTTON,name:"\u7F16\u8F91",icon:d,handle:I},{key:"setting",type:ge.BUTTON,name:"\u8BBE\u7F6E",icon:s,handle:()=>{f.value=!0}}];return(A,v)=>{const P=H("n-icon"),K=H("n-text"),x=H("n-button"),B=H("n-upload"),r=H("n-tooltip");return D(),z(he,null,[W("div",{class:ie(["go-chart-edit-tools",[o(p).getChartToolsStatus,o(u)?"isMini":"unMini"]]),onClick:v[1]||(v[1]=l=>C.value&&(C.value=!1)),onMouseenter:E,onMouseleave:k},[We(M(P,{class:"asideLogo",size:"22"},{default:b(()=>[M(o(a))]),_:1},512),[[ze,o(p).getChartToolsStatus===o(Pe).ASIDE&&o(u)]]),(D(!0),z(he,null,_e(o(w),(l,O)=>(D(),U(r,{key:l.key,disabled:!o(_)||o(h)&&i.value,trigger:"hover",placement:"left"},{trigger:b(()=>[W("div",Ss,[l.type===o(ge).BUTTON?(D(),U(x,{key:0,circle:o(_),secondary:"",onClick:l.handle},{icon:b(()=>[o(_)?(D(),U(P,{key:0,size:"22"},{default:b(()=>[(D(),U(me(l.icon)))]),_:2},1024)):(D(),U(me(l.icon),{key:1}))]),default:b(()=>[We(M(K,{depth:"3"},{default:b(()=>[ye(de(l.name),1)]),_:2},1536),[[ze,!o(_)]])]),_:2},1032,["circle","onClick"])):l.type===o(ge).IMPORTUPLOAD?(D(),U(B,{key:1,"file-list":o(c),"onUpdate:file-list":v[0]||(v[0]=L=>cn(c)?c.value=L:null),"show-file-list":!1,customRequest:o(S),onBeforeUpload:o(g)},{default:b(()=>[M(x,{circle:o(_),secondary:""},{icon:b(()=>[o(_)?(D(),U(P,{key:0,size:"22"},{default:b(()=>[(D(),U(me(l.icon)))]),_:2},1024)):(D(),U(me(l.icon),{key:1}))]),default:b(()=>[We(M(K,{depth:"3"},{default:b(()=>[ye(de(l.name),1)]),_:2},1536),[[ze,!o(_)]])]),_:2},1032,["circle"])]),_:2},1032,["file-list","customRequest","onBeforeUpload"])):fe("",!0)])]),default:b(()=>[W("span",null,de(l.name),1)]),_:2},1032,["disabled"]))),128))],34),M(o(gs),{modelShow:f.value,"onUpdate:modelShow":v[2]||(v[2]=l=>f.value=l)},null,8,["modelShow"])],64)}}});var xs=ce(Ts,[["__scopeId","data-v-4c257f27"]]);const Ds=ue({__name:"index",setup(e){const n=re(),{handleContextMenu:t}=ut();En();const{mouseenterHandle:a,mouseleaveHandle:s,mousedownHandle:d,mouseClickHandle:p}=Lt(),y=(_,h,u)=>{if(n.getTargetChart.selectId.length>1)return h.filter(E=>[F.GROUP,F.DELETE].includes(E.key));const w=[];return u.status.lock?w.push(F.LOCK):w.push(F.UNLOCK),u.status.hide?w.push(F.HIDE):w.push(F.SHOW),_.filter(E=>!w.includes(E.key))},m=_=>{var h;return!!((h=_.chartConfig.filters)!=null&&h.length)},f=_=>{var u,w;return!!(_.chartConfig.package=="Charts"&&((w=(u=_==null?void 0:_.option)==null?void 0:u.title)==null?void 0:w.titleShow))},C=_=>f(_)?40:0,i=_=>{var k;const h=(k=_.chartConfig.filters)==null?void 0:k.map(I=>I.type==Jt.DATE&&I.from!="query"?221:450);if(!(h!=null&&h.length))return 0;const u=h==null?void 0:h.reduce((I,X)=>I+X+8),w=u?Math.ceil(u/_.attr.w):0;return w*24+(w-1)*8+32},c=$(()=>n.getEditCanvasConfig.chartThemeSetting),S=$(()=>{const _=n.getEditCanvasConfig.chartThemeColor;return Et[_]});$(()=>n.getEditCanvasConfig.filterShow);const g=$(()=>{const _=n.getEditCanvasConfig.background,h=n.getEditCanvasConfig.backgroundImage,E=n.getEditCanvasConfig.selectColor?{background:_||void 0}:{background:`url(${h}) no-repeat center center / cover !important`};return we(Y({},E),{width:"inherit",height:"inherit"})});return ot(()=>{xn()}),(_,h)=>(D(),U(o(Cn),{id:"go-chart-edit-layout",flex:!0,showTop:!1,showBottom:!0,depth:1,xScroll:!0,disabledScroll:!0,onMousedown:o(Ot),onDrop:o(An),onDragover:o(vt),onDragenter:o(vt)},{aside:b(()=>[M(o(xs))]),bottom:b(()=>[M(o(ps))]),default:b(()=>[M(o(Zn),null,{default:b(()=>[W("div",{id:"go-chart-edit-content",onContextmenu:h[0]||(h[0]=(...u)=>o(t)&&o(t)(...u))},[M(o(Xn),null,{default:b(()=>[W("div",{style:oe(Y(Y({},o(He)(o(n).getEditCanvasConfig)),o(g)))},[(D(!0),z(he,null,_e(o(n).getComponentList,(u,w)=>(D(),z("div",{key:u.id},[u.isGroup?(D(),U(o(Mn),{key:0,groupData:u,groupIndex:w},null,8,["groupData","groupIndex"])):(D(),U(o(et),{key:1,"data-id":u.id,index:w,style:oe(Y(Y({},o(Ie)(u.attr,w)),o(Dt)(u.styles))),item:u,onClick:E=>o(p)(E,u),onMousedown:E=>o(d)(E,u),onMouseenter:E=>o(a)(E,u),onMouseleave:E=>o(s)(E,u),onContextmenu:E=>o(t)(E,u,y)},{default:b(()=>{var E,k,I;return[f(u)?(D(),U(o(zt),{key:0,title:u.chartConfig.package=="Charts"&&(I=(k=(E=u.option)==null?void 0:E.title)==null?void 0:k.text)!=null?I:u.chartConfig.title},null,8,["title"])):fe("",!0),m(u)?(D(),U(o(jt),{key:1,class:"filter-content",componentIdx:u.id,attr:u.attr,filters:u.chartConfig.filters,type:u.chartConfig.category},null,8,["componentIdx","attr","filters","type"])):fe("",!0),(D(),U(me(u.chartConfig.chartKey),{class:ie(["edit-content-chart",o(Qe)(u.styles.animations)]),chartConfig:u,themeSetting:o(c),themeColor:o(S),style:oe(Y(Y(Y({},o(qt)(u.attr,C(u)+i(u))),o(He)(u.styles)),o(Ze)(u.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]}),_:2},1032,["data-id","index","style","item","onClick","onMousedown","onMouseenter","onMouseleave","onContextmenu"]))]))),128))],4)]),_:1})],32)]),_:1})]),_:1},8,["onMousedown","onDrop","onDragover","onDragenter"]))}});var Ps=ce(Ds,[["__scopeId","data-v-63b45954"]]);export{Ps as default};
