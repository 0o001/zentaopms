var oe=Object.defineProperty,ie=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var k=(e,t,n)=>t in e?oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,u=(e,t)=>{for(var n in t||(t={}))re.call(t,n)&&k(e,n,t[n]);if(O)for(var n of O(t))ae.call(t,n)&&k(e,n,t[n]);return e},T=(e,t)=>ie(e,se(t));var F=(e,t,n)=>new Promise((o,i)=>{var r=c=>{try{d(n.next(c))}catch(l){i(l)}},s=c=>{try{d(n.throw(c))}catch(l){i(l)}},d=c=>c.done?o(c.value):Promise.resolve(c.value).then(r,s);d((n=n.apply(e,t)).next())});import{g as D}from"./storage-653ce378.js";import{az as _,aH as ce,j as $,d as R,o as w,m as p,A as B,ad as L,f as a,aI as G,aJ as C,aK as b,aL as M,aM as A,c as y,aN as V,aO as q,L as U,F as j,a5 as S,x as K,ab as z,z as X,v,aP as g,a6 as m,e as W,aQ as I,aR as de,S as le}from"./index.js";import{u as Y,c as he,C as E}from"./chartEditStore-08b7867a.js";import{t as x,_ as ue,u as we,f as pe}from"./index-6bb56023.js";import"./plugin-8471cd7e.js";import"./icon-d59d56ff.js";import"./table_scrollboard-3667f4b7.js";/* empty css                                                                */import"./SettingItemBox-a90524c1.js";import"./CollapseItem-4a85a0e3.js";import"./useTargetData.hook-5df1ece2.js";const ve=(e,t,n,o)=>{const i=e,r=t,s={width:1,height:1},d=parseFloat((i/r).toFixed(5)),c=()=>{const ne=parseFloat((window.innerWidth/window.innerHeight).toFixed(5));n&&(ne>d?(s.width=parseFloat((window.innerHeight*d/i).toFixed(5)),s.height=parseFloat((window.innerHeight/r).toFixed(5)),n.style.transform=`scale(${s.width}, ${s.height})`):(s.height=parseFloat((window.innerWidth/d/r).toFixed(5)),s.width=parseFloat((window.innerWidth/i).toFixed(5)),n.style.transform=`scale(${s.width}, ${s.height})`),o&&o(s))},l=x(()=>{c()},200);return{calcRate:c,windowResize:()=>{window.addEventListener("resize",l)},unWindowResize:()=>{window.removeEventListener("resize",l)}}},ge=(e,t,n,o)=>{const i=e,r=t,s={width:1,height:1},d=parseFloat((i/r).toFixed(5)),c=()=>{n&&(s.height=parseFloat((window.innerWidth/d/r).toFixed(5)),s.width=parseFloat((window.innerWidth/i).toFixed(5)),n.style.transform=`scale(${s.width}, ${s.height})`,o&&o(s))},l=x(()=>{c()},200);return{calcRate:c,windowResize:()=>{window.addEventListener("resize",l)},unWindowResize:()=>{window.removeEventListener("resize",l)}}},fe=(e,t,n,o)=>{const i=e,r=t,s={height:1,width:1},d=parseFloat((i/r).toFixed(5)),c=()=>{n&&(s.width=parseFloat((window.innerHeight*d/i).toFixed(5)),s.height=parseFloat((window.innerHeight/r).toFixed(5)),n.style.transform=`scale(${s.width}, ${s.height})`,o&&o(s))},l=x(()=>{c()},200);return{calcRate:c,windowResize:()=>{window.addEventListener("resize",l)},unWindowResize:()=>{window.removeEventListener("resize",l)}}},ye=(e,t,n,o)=>{const i={width:1,height:1},r=()=>{n&&(i.width=parseFloat((window.innerWidth/e).toFixed(5)),i.height=parseFloat((window.innerHeight/t).toFixed(5)),n.style.transform=`scale(${i.width}, ${i.height})`,o&&o(i))},s=x(()=>{r()},200);return{calcRate:r,windowResize:()=>{window.addEventListener("resize",s)},unWindowResize:()=>{window.removeEventListener("resize",s)}}},J={},P={echarts:ce},Q=e=>{if(!e.events)return{};const t={};for(const i in e.events.baseEvent){const r=e.events.baseEvent[i];r&&(t[i]=_e(r))}const n=e.events.advancedEvents||{},o={[_.VNODE_BEFORE_MOUNT](i){J[e.id]=i.component;const r=(n[_.VNODE_BEFORE_MOUNT]||"").trim();N(r,i)},[_.VNODE_MOUNTED](i){const r=(n[_.VNODE_MOUNTED]||"").trim();N(r,i)}};return u(u({},t),o)};function _e(e){try{return new Function(`
      return (
        async function(mouseEvent){
          ${e}
        }
      )`)()}catch(t){console.error(t)}}function N(e,t){try{Function(`
      "use strict";
      return (
        async function(e, components, node_modules){
          const {${Object.keys(P).join()}} = node_modules;
          ${e}
        }
      )`)().bind(t==null?void 0:t.component)(t,J,P)}catch(n){console.error(n)}}const Z=(e,t)=>({zIndex:t+1,left:`${e.x}px`,top:`${e.y}px`}),me=(e,t)=>({width:`${t?t*e.w:e.w}px`,height:`${t?t*e.h:e.h}px`}),Ce=(e,t,n)=>{if(!e)return{};const o=t?40*3:0;return{width:`${n?n*e.w:e.w}px`,height:`${n?n*e.h-o:e.h-o}px`}},ee=e=>({display:e.hide?"none":"block"}),te=e=>{const t={};return e&&e.overFlowHidden&&(t.overflow="hidden"),t},Se=e=>{const t=e.selectColor?{background:e.background}:{background:`url(${e.backgroundImage}) center center / cover no-repeat !important`};return u({position:"relative",width:e.width?`${e.width||100}px`:"100%",height:e.height?`${e.height}px`:"100%"},t)};const Re=R({__name:"index",props:{groupData:{type:Object,required:!0},themeSetting:{type:Object,required:!0},themeColor:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){return(t,n)=>(w(!0),p(j,null,B(e.groupData.groupList,o=>(w(),p("div",{class:L(["chart-item",a(G)(o.styles.animations)]),key:o.id,style:C(u(u(u(u(u(u({},a(Z)(o.attr,e.groupIndex)),a(b)(o.styles)),a(M)(o.styles)),a(ee)(o.status)),a(te)(o.preview)),a(A)(o.styles)))},[(w(),y(U(o.chartConfig.chartKey),V({id:o.id,chartConfig:o,themeSetting:e.themeSetting,themeColor:e.themeColor,style:u({},a(me)(o.attr))},q(a(Q)(o))),null,16,["id","chartConfig","themeSetting","themeColor","style"]))],6))),128))}});var xe=$(Re,[["__scopeId","data-v-78cb40c3"]]);const Fe=R({__name:"index",setup(e){const{initDataPond:t,clearMittDataPondMap:n}=we(),o=Y(),i=c=>{var l;return!!((l=c.chartConfig.filters)!=null&&l.length)},r=c=>{const l=c.chartConfig.filters;return!!(l!=null&&l.length)&&l[0].from!="query"},s=S(()=>o.editCanvasConfig.chartThemeSetting),d=S(()=>{const c=o.editCanvasConfig.chartThemeColor;return he[c]});return n(),K(()=>{t(o.requestGlobalConfig)}),(c,l)=>(w(!0),p(j,null,B(a(o).componentList,(h,f)=>(w(),p("div",{key:h.id,class:"chart-item",style:C(u(u(u(u(u(u({},a(Z)(h.attr,f)),a(b)(h.styles)),a(M)(h.styles)),a(ee)(h.status)),a(te)(h.preview)),a(A)(h.styles)))},[i(h)&&r(h)?(w(),y(a(ue),{key:0,componentIdx:h.id,attr:h.attr,filters:h.chartConfig.filters},null,8,["componentIdx","attr","filters"])):z("",!0),X("div",{class:L(a(G)(h.styles.animations))},[h.isGroup?(w(),y(a(xe),{key:0,groupData:h,groupIndex:f,themeSetting:a(s),themeColor:a(d)},null,8,["groupData","groupIndex","themeSetting","themeColor"])):(w(),y(U(h.chartConfig.chartKey),V({key:1,id:h.id,chartConfig:h,themeSetting:a(s),themeColor:a(d),style:u({},a(Ce)(h.attr,i(h)))},q(a(Q)(h))),null,16,["id","chartConfig","themeSetting","themeColor","style"]))],2)],4))),128))}});var H=$(Fe,[["__scopeId","data-v-236680c9"]]);const Ee=e=>{const t=v(!1),n=setInterval(()=>{if(window.$vue.component){clearInterval(n);const o=i=>{window.$vue.component(i.chartConfig.chartKey)||window.$vue.component(i.chartConfig.chartKey,pe(i.chartConfig))};e.componentList.forEach(i=>F(void 0,null,function*(){i.isGroup?i.groupList.forEach(r=>{o(r)}):o(i)})),t.value=!0}},200);return{show:t}},ze=e=>{const t=v(),n=v(),o=v(e.editCanvasConfig.width),i=v(e.editCanvasConfig.height);return K(()=>{switch(e.editCanvasConfig.previewScaleType){case g.FIT:(()=>{const{calcRate:r,windowResize:s,unWindowResize:d}=ve(o.value,i.value,n.value);r(),s(),m(()=>{d()})})();break;case g.SCROLL_Y:(()=>{const{calcRate:r,windowResize:s,unWindowResize:d}=ge(o.value,i.value,n.value,c=>{const l=t.value;l.style.width=`${o.value*c.width}px`,l.style.height=`${i.value*c.height}px`});r(),s(),m(()=>{d()})})();break;case g.SCROLL_X:(()=>{const{calcRate:r,windowResize:s,unWindowResize:d}=fe(o.value,i.value,n.value,c=>{const l=t.value;l.style.width=`${o.value*c.width}px`,l.style.height=`${i.value*c.height}px`});r(),s(),m(()=>{d()})})();break;case g.FULL:(()=>{const{calcRate:r,windowResize:s,unWindowResize:d}=ye(o.value,i.value,n.value);r(),s(),m(()=>{d()})})();break}}),{entityRef:t,previewRef:n}},$e=e=>{const t=Y();t.requestGlobalConfig=e[E.REQUEST_GLOBAL_CONFIG],t.editCanvasConfig=e[E.EDIT_CANVAS_CONFIG],t.componentList=e[E.COMPONENT_LIST]};const Le=R({__name:"index",setup(e){let t=D();const n=S(()=>u(u({},Se(t.editCanvasConfig)),b(t.editCanvasConfig))),o=S(()=>{const d=t.editCanvasConfig.previewScaleType;return d===g.SCROLL_Y||d===g.SCROLL_X});$e(t);const{entityRef:i,previewRef:r}=ze(t),{show:s}=Ee(t);return(d,c)=>(w(),p("div",{class:L(`go-preview ${a(t).editCanvasConfig.previewScaleType}`)},[a(o)?(w(),p("div",{key:0,ref_key:"entityRef",ref:i,class:"go-preview-entity"},[X("div",{ref_key:"previewRef",ref:r,class:"go-preview-scale"},[a(s)?(w(),p("div",{key:0,style:C(a(n))},[W(a(H))],4)):z("",!0)],512)],512)):(w(),p("div",{key:1,ref_key:"previewRef",ref:r,class:"go-preview-scale"},[a(s)?(w(),p("div",{key:0,style:C(a(n))},[W(a(H))],4)):z("",!0)],512))],2))}});var be=$(Le,[["__scopeId","data-v-25130ef2"]]);const Ae=R({__name:"wrapper",setup(e){let t=v(Date.now());return[I.JSON,I.CHART].forEach(n=>{!window.opener||window.opener.addEventListener(n,o=>F(this,null,function*(){const i=yield D();de(le.GO_CHART_STORAGE_LIST,[T(u({},o.detail),{id:i.id})]),t.value=Date.now()}))}),(n,o)=>(w(),y(be,{key:a(t)}))}});export{Ae as default};
