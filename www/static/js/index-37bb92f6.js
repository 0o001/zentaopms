var It=Object.defineProperty,Ht=Object.defineProperties;var Pt=Object.getOwnPropertyDescriptors;var lt=Object.getOwnPropertySymbols;var $t=Object.prototype.hasOwnProperty,Ut=Object.prototype.propertyIsEnumerable;var it=(e,n,t)=>n in e?It(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,N=(e,n)=>{for(var t in n||(n={}))$t.call(n,t)&&it(e,t,n[t]);if(lt)for(var t of lt(n))Ut.call(n,t)&&it(e,t,n[t]);return e},we=(e,n)=>Ht(e,Pt(n));var Se=(e,n,t)=>new Promise((a,s)=>{var f=m=>{try{E(t.next(m))}catch(p){s(p)}},h=m=>{try{E(t.throw(m))}catch(p){s(p)}},E=m=>m.done?a(m.value):Promise.resolve(m.value).then(f,h);E((t=t.apply(e,n)).next())});import{u as re,E as ae,t as se,D as Ge,G as Kt,B as Nt,J as Re,K as Gt,M as ye,c as wt,O as Ie,g as Yt,h as Xt,Q as R,R as Be,a as Wt,b as ot,F as zt,S as qt,e as Jt}from"./useSync.hook-cae0f7f7.js";import{x as at,a6 as St,b3 as jt,aj as D,c5 as Tt,c6 as xt,cl as dt,ck as Vt,c3 as Ve,cm as q,ca as Ye,ak as Qt,j as ce,d as ue,bJ as Ae,f as o,u as ke,a5 as P,o as x,m as z,n as rt,F as pe,A as _e,ad as ie,aP as oe,aa as he,z as W,c as U,w as A,L as me,bU as Qe,bV as He,bW as Ze,bX as Dt,a4 as ut,y as $e,al as ft,R as fe,r as I,cn as Zt,a3 as Ue,v as Q,co as pt,G as At,H as kt,e as L,p as Ce,t as de,aI as en,aS as tn,cp as ve,cq as Pe,cr as nn,c2 as sn,cs as on,am as an,ct as rn,J as Ft,Q as ht,b$ as Xe,X as We,Y as ze,bS as un,V as cn,cu as ln,cv as dn,W as fn,aO as pn,S as Oe,c0 as qe}from"./index.js";import{u as ct,d as hn}from"./index-f3f1cf53.js";import{a as vn,b as vt,l as gn,g as _n}from"./plugin-25b8b76b.js";import{C as mn}from"./index-864882c6.js";import{i as De}from"./icon-a9afa6f2.js";import{E as Cn}from"./index-91e9054e.js";import"./tables_list-a4e5b822.js";import"./index-bda8e617.js";import"./index-565d14ab.js";const Te=re(),yn=()=>{at(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,document.getElementById("go-chart-edit-layout")),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,document.getElementById("go-chart-edit-content"));const e=Te.listenerScale();St(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,null),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,null),e()})})};var bt={exports:{}};(function(e){(function(n){var t,a={},s={16:!1,18:!1,17:!1,91:!1},f="all",h={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},E={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},m=function(r){return E[r]||r.toUpperCase().charCodeAt(0)},p=[];for(t=1;t<20;t++)E["f"+t]=111+t;function C(r,c){for(var k=r.length;k--;)if(r[k]===c)return k;return-1}function d(r,c){if(r.length!=c.length)return!1;for(var k=0;k<r.length;k++)if(r[k]!==c[k])return!1;return!0}var u={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function _(r){for(t in s)s[t]=r[u[t]]}function l(r){var c,k,F,Y,$,le;if(c=r.keyCode,C(p,c)==-1&&p.push(c),(c==93||c==224)&&(c=91),c in s){s[c]=!0;for(F in h)h[F]==c&&(y[F]=!0);return}if(_(r),!!y.filter.call(this,r)&&c in a){for(le=J(),Y=0;Y<a[c].length;Y++)if(k=a[c][Y],k.scope==le||k.scope=="all"){$=k.mods.length>0;for(F in s)(!s[F]&&C(k.mods,+F)>-1||s[F]&&C(k.mods,+F)==-1)&&($=!1);(k.mods.length==0&&!s[16]&&!s[18]&&!s[17]&&!s[91]||$)&&k.method(r,k)===!1&&(r.preventDefault?r.preventDefault():r.returnValue=!1,r.stopPropagation&&r.stopPropagation(),r.cancelBubble&&(r.cancelBubble=!0))}}}function i(r){var c=r.keyCode,k,F=C(p,c);if(F>=0&&p.splice(F,1),(c==93||c==224)&&(c=91),c in s){s[c]=!1;for(k in h)h[k]==c&&(y[k]=!1)}}function g(){for(t in s)s[t]=!1;for(t in h)y[t]=!1}function y(r,c,k){var F,Y;F=v(r),k===void 0&&(k=c,c="all");for(var $=0;$<F.length;$++)Y=[],r=F[$].split("+"),r.length>1&&(Y=H(r),r=[r[r.length-1]]),r=r[0],r=m(r),r in a||(a[r]=[]),a[r].push({shortcut:F[$],scope:c,method:k,key:F[$],mods:Y})}function M(r,c){var k,F,Y=[],$,le,Ee;for(k=v(r),le=0;le<k.length;le++){if(F=k[le].split("+"),F.length>1&&(Y=H(F),r=F[F.length-1]),r=m(r),c===void 0&&(c=J()),!a[r])return;for($=0;$<a[r].length;$++)Ee=a[r][$],Ee.scope===c&&d(Ee.mods,Y)&&(a[r][$]={})}}function O(r){return typeof r=="string"&&(r=m(r)),C(p,r)!=-1}function b(){return p.slice(0)}function G(r){var c=(r.target||r.srcElement).tagName;return!(c=="INPUT"||c=="SELECT"||c=="TEXTAREA")}for(t in h)y[t]=!1;function X(r){f=r||"all"}function J(){return f||"all"}function S(r){var c,k,F;for(c in a)for(k=a[c],F=0;F<k.length;)k[F].scope===r?k.splice(F,1):F++}function v(r){var c;return r=r.replace(/\s/g,""),c=r.split(","),c[c.length-1]==""&&(c[c.length-2]+=","),c}function H(r){for(var c=r.slice(0,r.length-1),k=0;k<c.length;k++)c[k]=h[c[k]];return c}function K(r,c,k){r.addEventListener?r.addEventListener(c,k,!1):r.attachEvent&&r.attachEvent("on"+c,function(){k(window.event)})}K(document,"keydown",function(r){l(r)}),K(document,"keyup",i),K(window,"focus",g);var T=n.key;function B(){var r=n.key;return n.key=T,r}n.key=y,n.key.setScope=X,n.key.getScope=J,n.key.deleteScope=S,n.key.filter=G,n.key.isPressed=O,n.key.getPressedKeyCodes=b,n.key.noConflict=B,n.key.unbind=M,e.exports=y})(jt)})(bt);var Z=bt.exports;const ee=re(),ne=e=>`${Tt.CTRL}+${e}`,Le=e=>`${Tt.SHIFT}+${e}`,j={[D.ARROW_UP]:ne("up"),[D.ARROW_RIGHT]:ne("right"),[D.ARROW_DOWN]:ne("down"),[D.ARROW_LEFT]:ne("left"),[D.COPY]:ne("c"),[D.CUT]:ne("x"),[D.PARSE]:ne("v"),[D.DELETE]:"delete",[D.BACK]:ne("z"),[D.FORWORD]:ne(Le("z")),[D.GROUP]:ne("g"),[D.UN_GROUP]:ne(Le("g")),[D.LOCK]:ne("l"),[D.UNLOCK]:ne(Le("l")),[D.HIDE]:ne("h"),[D.SHOW]:ne(Le("h"))},te=e=>`${xt.CTRL}+${e}`,Me=e=>`${xt.SHIFT}+${e}`,V={[D.ARROW_UP]:te("arrowup"),[D.ARROW_RIGHT]:te("arrowright"),[D.ARROW_DOWN]:te("arrowdown"),[D.ARROW_LEFT]:te("arrowleft"),[D.COPY]:te("c"),[D.CUT]:te("x"),[D.PARSE]:te("v"),[D.DELETE]:te("backspace"),[D.BACK]:te("z"),[D.FORWORD]:te(Me("z")),[D.GROUP]:te("g"),[D.UN_GROUP]:te(Me("g")),[D.LOCK]:te("l"),[D.UNLOCK]:te(Me("l")),[D.HIDE]:te("h"),[D.SHOW]:te(Me("h"))},En=[j.up,j.right,j.down,j.left,j.delete,j.copy,j.cut,j.parse,j.back,j.forward,j.group,j.unGroup,j.lock,j.unLock,j.hide,j.show],wn=[V.up,V.right,V.down,V.left,V.delete,V.copy,V.cut,V.parse,V.back,V.forward,V.group,V.unGroup,V.lock,V.unLock,V.hide,V.show],Sn=()=>{window.$KeyboardActive={ctrl:!1,space:!1},document.onkeydown=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(dt(e.keyCode),n){case 17:window.$KeyboardActive.ctrl=!0;break;case 32:window.$KeyboardActive.space=!0;break}},document.onkeyup=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(dt(),n){case 17:window.$KeyboardActive.ctrl=!1;break;case 32:window.$KeyboardActive.space=!1;break}}},Tn=()=>{const n=(t,a)=>{switch(a){case t.up:Z(a,se(()=>(ee.setMove(D.ARROW_UP),!1),50));break;case t.right:Z(a,se(()=>(ee.setMove(D.ARROW_RIGHT),!1),50));break;case t.down:Z(a,se(()=>(ee.setMove(D.ARROW_DOWN),!1),50));break;case t.left:Z(a,se(()=>(ee.setMove(D.ARROW_LEFT),!1),50));break;case t.delete:Z(a,Ge(()=>(ee.removeComponentList(),!1),50));break;case t.copy:Z(a,Ge(()=>(ee.setCopy(),!1),50));break;case t.cut:Z(a,Ge(()=>(ee.setCut(),!1),50));break;case t.parse:Z(a,se(()=>(ee.setParse(),!1),50));break;case t.back:Z(a,se(()=>(ee.setBack(),!1),50));break;case t.forward:Z(a,se(()=>(ee.setForward(),!1),50));break;case t.group:Z(a,se(()=>(ee.setGroup(),!1),50));break;case t.unGroup:Z(a,se(()=>(ee.setUnGroup(),!1),50));break;case t.lock:Z(a,se(()=>(ee.setLock(),!1),50));break;case t.unLock:Z(a,se(()=>(ee.setUnLock(),!1),50));break;case t.hide:Z(a,se(()=>(ee.setHide(),!1),50));break;case t.show:Z(a,se(()=>(ee.setShow(),!1),50));break}};En.forEach(t=>{n(j,t)}),wn.forEach(t=>{n(V,t)}),Sn()},w=re(),{onClickOutSide:xn}=ct(),Dn=e=>Se(void 0,null,function*(){e.preventDefault();try{vn();const n=e.dataTransfer.getData(Vt.DRAG_KEY);if(!n){vt();return}w.setEditCanvas(ae.IS_CREATE,!1);const t=Ve(n);let a;if(t.sourceID){let f=yield Kt(t.sourceID,t.category);if(!f){window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...");return}a=f.chartConfig}else a=t;let s=yield Nt(a);q(s,e.offsetX-s.attr.w/2,e.offsetY-s.attr.h/2),w.addComponentList(s,!1,!0),w.setTargetSelectChart(s.id),vt()}catch(n){gn(),window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...")}}),gt=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},Ot=(e,n)=>{if(n){w.setTargetSelectChart(n.id);return}w.setTargetSelectChart(void 0)},An=(e,n)=>{var p;if(e.which==2||(p=window.$KeyboardActive)!=null&&p.space)return;Ot();const t=e.offsetX,a=e.offsetY,s=e.screenX,f=e.screenY,h=w.getEditCanvas.scale;w.setMousePosition(void 0,void 0,t,a);const E=Re.exports.throttle(C=>{w.setTargetSelectChart(),w.setEditCanvas(ae.IS_SELECT,!0);const d=t+C.screenX-s,u=a+C.screenY-f;w.setMousePosition(d,u);const _={x1:0,y1:0,x2:0,y2:0};d>t&&u>a?(_.x1=t,_.y1=a,_.x2=Math.round(t+(C.screenX-s)/h),_.y2=Math.round(a+(C.screenY-f)/h)):d>t&&u<a?(_.x1=t,_.y1=Math.round(a-(f-C.screenY)/h),_.x2=Math.round(t+(C.screenX-s)/h),_.y2=a):d<t&&u>a?(_.x1=Math.round(t-(s-C.screenX)/h),_.y1=a,_.x2=t,_.y2=Math.round(a+(C.screenY-f)/h)):(_.x1=Math.round(t-(s-C.screenX)/h),_.y1=Math.round(a-(f-C.screenY)/h),_.x2=t,_.y2=a),w.getComponentList.forEach(l=>{if(!w.getTargetChart.selectId.includes(l.id)){const{x:i,y:g,w:y,h:M}=l.attr,O={x1:i,y1:g,x2:i+y,y2:g+M};O.x1-_.x1>=0&&O.y1-_.y1>=0&&O.x2-_.x2<=0&&O.y2-_.y2<=0&&!l.status.lock&&!l.status.hide&&w.setTargetSelectChart(l.id,!0)}})},30),m=()=>{E.cancel(),w.setEditCanvas(ae.IS_SELECT,!1),w.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",m)};document.addEventListener("mousemove",E),document.addEventListener("mouseup",m)},Lt=()=>({mouseClickHandle:(s,f)=>{var h;if(s.preventDefault(),s.stopPropagation(),!f.status.lock&&(h=window.$KeyboardActive)!=null&&h.ctrl)if(w.targetChart.selectId.includes(f.id)){const E=w.targetChart.selectId.filter(m=>m!==f.id);w.setTargetSelectChart(E)}else w.setTargetSelectChart(f.id,!0)},mousedownHandle:(s,f)=>{var g;if(s.preventDefault(),s.stopPropagation(),f.status.lock||(xn(),s.buttons===Ye.LEFT&&((g=window.$KeyboardActive)==null?void 0:g.ctrl)))return;const h=w.getTargetChart.selectId;if(s.buttons===Ye.RIGHT&&h.length>1&&h.includes(f.id)||(w.setTargetSelectChart(f.id),s.buttons===Ye.RIGHT))return;const E=w.getEditCanvas.scale,m=w.getEditCanvasConfig.width,p=w.getEditCanvasConfig.height,C=new Map;w.getTargetChart.selectId.forEach(y=>{const M=w.fetchTargetIndex(y);if(M!==-1){const{x:O,y:b,w:G,h:X}=Qt(w.getComponentList[M]).attr;C.set(y,{x:O,y:b,w:G,h:X})}});const d=s.screenX,u=s.screenY;let _=[];w.getTargetChart.selectId.forEach(y=>{if(!C.has(y))return;const M=w.fetchTargetIndex(y);_.push(Re.exports.cloneDeep(w.getComponentList[M]))}),w.setMousePosition(void 0,void 0,d,u);const l=Re.exports.throttle(y=>{w.setEditCanvas(ae.IS_DRAG,!0),w.setMousePosition(y.screenX,y.screenY);let M=(y.screenX-d)/E,O=(y.screenY-u)/E;w.getTargetChart.selectId.forEach(b=>{if(!C.has(b))return;const G=w.fetchTargetIndex(b),{x:X,y:J,w:S,h:v}=C.get(b),H=w.getComponentList[G];let K=Math.round(X+M),T=Math.round(J+O);const B=50;K=K<-S+B?-S+B:K,T=T<-v+B?-v+B:T,K=K>m-B?m-B:K,T=T>p-B?p-B:T,H&&(H.attr=Object.assign(H.attr,{x:K,y:T}))})},20),i=()=>{try{w.setMousePosition(0,0,0,0),w.setEditCanvas(ae.IS_DRAG,!1),_.length&&(w.getTargetChart.selectId.forEach(y=>{if(!C.has(y))return;const M=w.fetchTargetIndex(y),O=w.getComponentList[M];_.forEach(b=>{b.id===y&&(b.attr=Object.assign(b.attr,{offsetX:O.attr.x-b.attr.x,offsetY:O.attr.y-b.attr.y}))})}),w.moveComponentList(_)),document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",i)}catch(y){console.log(y)}};document.addEventListener("mousemove",l),document.addEventListener("mouseup",i)},mouseenterHandle:(s,f)=>{s.preventDefault(),s.stopPropagation(),w.getEditCanvas.isSelect||w.setTargetHoverChart(f.id)},mouseleaveHandle:(s,f)=>{s.preventDefault(),s.stopPropagation(),w.setEditCanvas(ae.IS_DRAG,!1),w.setTargetHoverChart(void 0)}}),kn=(e,n,t)=>{e.stopPropagation(),e.preventDefault(),w.setEditCanvas(ae.IS_DRAG,!0);const a=w.getEditCanvas.scale,s=t.x,f=t.y,h=t.w,E=t.h,m=e.screenX,p=e.screenY;w.setMousePosition(m,p);const C=Re.exports.throttle(u=>{w.setMousePosition(u.screenX,u.screenY);let _=Math.round((u.screenX-m)/a),l=Math.round((u.screenY-p)/a);const i=/t/.test(n),g=/b/.test(n),y=/l/.test(n),M=/r/.test(n),O=E+(i?-l:g?l:0),b=h+(y?-_:M?_:0);t.h=O>0?O:0,t.w=b>0?b:0,t.x=s+(y?_:0),t.y=f+(i?l:0)},50),d=()=>{w.setEditCanvas(ae.IS_DRAG,!1),w.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",d)};document.addEventListener("mousemove",C),document.addEventListener("mouseup",d)};const Fn=["onMousedown"],bn=ue({__name:"index",props:{item:{type:Object,required:!0},hiddenPoint:{type:Boolean,required:!1}},setup(e){const n=e;Ae(d=>({"026d39a0":o(h)}));const t=ke(),a=re(),s=["t","r","b","l","lt","rt","lb","rb"],f=["n","e","s","w","nw","ne","sw","se"],h=P(()=>t.getAppTheme),E=P(()=>n.item.status.lock?!1:n.item.id===a.getTargetChart.hoverId),m=P(()=>{const d=n.item.id;return n.item.status.lock?!1:a.getTargetChart.selectId.find(u=>u===d)}),p=P(()=>n.item.status.lock),C=P(()=>n.item.status.hide);return(d,u)=>(x(),z("div",{class:ie(["go-shape-box",{lock:o(p),hide:o(C)}])},[rt(d.$slots,"default",{},void 0,!0),e.hiddenPoint?he("",!0):(x(!0),z(pe,{key:0},_e(o(m)?s:[],(_,l)=>(x(),z("div",{class:ie(`shape-point ${_}`),key:l,style:oe(o(Gt)(_,l,e.item.attr,f)),onMousedown:i=>o(kn)(i,_,e.item.attr)},null,46,Fn))),128)),W("div",{class:"shape-modal",style:oe(o(ye)(e.item.attr))},[W("div",{class:ie(["shape-modal-select",{active:o(m)}])},null,2),W("div",{class:ie(["shape-modal-change",{selectActive:o(m),hoverActive:o(E)}])},null,2)],4)],2))}});var et=ce(bn,[["__scopeId","data-v-5f8854aa"]]);const On={class:"go-edit-group-box"},Ln=ue({__name:"index",props:{groupData:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){const n=re(),{handleContextMenu:t}=ct(),{mouseenterHandle:a,mouseleaveHandle:s,mousedownHandle:f,mouseClickHandle:h}=Lt(),E=(C,d,u)=>{const _=l=>d.filter(i=>l.includes(i.key));if(n.getTargetChart.selectId.length>1)return _([D.GROUP,D.DELETE]);{const l=[];u.status.lock?l.push(D.LOCK):l.push(D.UNLOCK),u.status.hide?l.push(D.HIDE):l.push(D.SHOW);const i=[D.UN_GROUP];return[..._(i),hn(),...C.filter(g=>!l.includes(g.key))]}},m=P(()=>{const C=n.getEditCanvasConfig.chartThemeColor;return wt[C]}),p=P(()=>n.getEditCanvasConfig.chartThemeSetting);return(C,d)=>(x(),z("div",On,[(x(),U(o(et),{key:e.groupData.id,"data-id":e.groupData.id,index:e.groupIndex,item:e.groupData,hiddenPoint:!0,class:ie(o(Qe)(e.groupData.styles.animations)),style:oe(N(N(N(N(N({},o(Ie)(e.groupData.attr,e.groupIndex)),o(ye)(e.groupData.attr)),o(He)(e.groupData.styles)),o(Ze)(e.groupData.styles)),o(Dt)(e.groupData.styles))),onClick:d[0]||(d[0]=u=>o(h)(u,e.groupData)),onMousedown:d[1]||(d[1]=u=>o(f)(u,e.groupData)),onMouseenter:d[2]||(d[2]=u=>o(a)(u,e.groupData)),onMouseleave:d[3]||(d[3]=u=>o(s)(u,e.groupData)),onContextmenu:d[4]||(d[4]=u=>o(t)(u,e.groupData,E))},{default:A(()=>[(x(!0),z(pe,null,_e(e.groupData.groupList,u=>(x(),U(o(et),{key:u.id,"data-id":u.id,index:e.groupIndex,item:u,hiddenPoint:!0,style:oe(N({},o(Ie)(u.attr,e.groupIndex)))},{default:A(()=>[(x(),U(me(u.chartConfig.chartKey),{class:ie(["edit-content-chart",o(Qe)(u.styles.animations)]),chartConfig:u,themeSetting:o(p),themeColor:o(m),style:oe(N(N(N({},o(ye)(u.attr)),o(He)(u.styles)),o(Ze)(u.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","item","style"]))),128))]),_:1},8,["data-id","index","item","class","style"]))]))}});const Mn={class:"go-edit-align-line"},Bn=ue({__name:"index",setup(e){Ae(l=>({42514545:o(h)}));const n=ke(),t=re(),a=ut(),s=$e({lineArr:["rowt","rowc","rowb","coll","colc","colr"],select:new Map,sorptioned:{x:!1,y:!1}}),f=l=>l?{left:`${l.x?l.x:0}px`,top:`${l.y?l.y:0}px`}:{},h=P(()=>n.getAppTheme),E=P(()=>a.getChartAlignRange),m=P(()=>t.getEditCanvas[ae.IS_DRAG]),p=(l,i)=>Math.abs(l-i)<=E.value,C=P(()=>t.getTargetChart.selectId),d=P(()=>t.getComponentList[t.fetchTargetIndex()]),u=P(()=>{var l;return((l=d.value)==null?void 0:l.attr)||{}}),_=P(()=>({id:"0",attr:{w:ft(t.getEditCanvasConfig.width),h:ft(t.getEditCanvasConfig.height),x:0,y:0,offsetX:0,offsetY:0,zIndex:0}}));return fe(()=>t.getMousePosition,se(()=>{try{if(!m.value||C.value.length!==1)return;const l=u.value.w,i=u.value.h,g=u.value.x,y=g+l/2,M=g+l,O=[g,y,M],b=u.value.y,G=b+i/2,X=b+i,J=[b,G,X];s.select.clear(),s.sorptioned.y=!1;const S=t.getComponentList.map(v=>({id:v.id,attr:v.attr}));S.push(_.value),s.lineArr.forEach(v=>{S.forEach(H=>{if(C.value[0]===H.id)return;const K=H.attr.w,T=H.attr.h,B=H.attr.x,r=B+K/2,c=B+K,k=[B,r,c],F=H.attr.y,Y=F+T/2,$=F+T,le=[F,Y,$];v.includes("rowt")&&(p(b,F)&&(s.select.set(v,{y:F}),q(d.value,g,F)),p(b,Y)&&(s.select.set(v,{y:Y}),q(d.value,g,Y)),p(b,$)&&(s.select.set(v,{y:$}),q(d.value,g,$))),v.includes("rowc")&&(p(G,F)&&(s.select.set(v,{y:F}),q(d.value,g,F-i/2)),p(G,Y)&&(s.select.set(v,{y:Y}),q(d.value,g,Y-i/2)),p(G,$)&&(s.select.set(v,{y:$}),q(d.value,g,$-i/2))),v.includes("rowb")&&(p(X,F)&&(s.select.set(v,{y:F}),q(d.value,g,F-i)),p(X,Y)&&(s.select.set(v,{y:Y}),q(d.value,g,Y-i)),p(X,$)&&(s.select.set(v,{y:$}),q(d.value,g,$-i))),v.includes("coll")&&(p(g,B)&&(s.select.set(v,{x:B}),q(d.value,B,b)),p(g,r)&&(s.select.set(v,{x:r}),q(d.value,r,b)),p(g,c)&&(s.select.set(v,{x:c}),q(d.value,c,b))),v.includes("colc")&&(p(y,B)&&(s.select.set(v,{x:B}),q(d.value,B-l/2,b)),p(y,r)&&(s.select.set(v,{x:r}),q(d.value,r-l/2,b)),p(y,c)&&(s.select.set(v,{x:c}),q(d.value,c-l/2,b))),v.includes("colr")&&(p(M,B)&&(s.select.set(v,{x:B}),q(d.value,B-l,b)),p(M,r)&&(s.select.set(v,{x:r}),q(d.value,r-l,b)),p(M,c)&&(s.select.set(v,{x:c}),q(d.value,c-l,b)))})})}catch(l){console.log(l)}},200),{deep:!0}),fe(()=>m.value,l=>{l||(s.select.clear(),s.sorptioned.y=!1)}),(l,i)=>(x(),z("div",Mn,[(x(!0),z(pe,null,_e(s.lineArr,g=>(x(),z("div",{class:ie(["line",[g.includes("row")?"row":"col",s.select.has(g)&&"visible"]]),key:g,style:oe(f(s.select.get(g)))},null,6))),128))]))}});var Rn=ce(Bn,[["__scopeId","data-v-403a9eed"]]);const In=ue({__name:"index",setup(e){return(n,t)=>{const a=I("n-watermark");return x(),U(a,{id:"go-edit-watermark",content:o(Zt),cross:"",selectable:"","font-size":16,"line-height":16,width:500,height:150,"x-offset":12,"y-offset":80,rotate:-15},null,8,["content"])}}});var Hn=ce(In,[["__scopeId","data-v-e5cd93da"]]);const Mt=e=>(At("data-v-71d41248"),e=e(),kt(),e),Pn=Mt(()=>W("div",{class:"select-background"},null,-1)),$n=Mt(()=>W("div",{class:"select-border"},null,-1)),Un=[Pn,$n],Kn=ue({__name:"index",setup(e){Ae(E=>({c29aca42:o(f)}));const n=ke(),t=re(),{isSelect:a,scale:s}=Ue(t.getEditCanvas),f=P(()=>n.getAppTheme),h=Q();return fe(()=>t.getMousePosition,E=>{if(!a.value)return;const{startX:m,startY:p,x:C,y:d}=E,u={zIndex:pt,x:0,y:0,w:0,h:0,offsetX:0,offsetY:0};C>m&&d>p?(u.x=m,u.y=p,u.w=Math.round((C-m)/s.value),u.h=Math.round((d-p)/s.value)):C>m&&d<p?(u.x=m,u.w=Math.round((C-m)/s.value),u.h=Math.round((p-d)/s.value),u.y=p-u.h):C<m&&d>p?(u.y=p,u.w=Math.round((m-C)/s.value),u.h=Math.round((d-p)/s.value),u.x=m-u.w):(u.w=Math.round((m-C)/s.value),u.h=Math.round((p-d)/s.value),u.x=m-u.w,u.y=p-u.h),h.value=N(N({},Ie(u,pt)),ye(u))},{deep:!0}),(E,m)=>o(a)?(x(),z("div",{key:0,class:"go-edit-select",style:oe(h.value)},Un,4)):he("",!0)}});var Nn=ce(Kn,[["__scopeId","data-v-71d41248"]]);const Gn=ue({__name:"index",setup(e){const n=re(),{getEditCanvasConfig:t,getEditCanvas:a}=Ue(n),s=P(()=>({w:t.value.width,h:t.value.height})),f=P(()=>{const E={transform:`scale(${a.value.scale})`};return N(N({},ye(s.value)),E)}),h=P(()=>{const E=a.value.isCreate&&{"z-index":99999};return N(N({},ye(s.value)),E)});return(E,m)=>(x(),z("div",{class:"go-edit-range go-transition",style:oe(o(f)),onMousedown:m[0]||(m[0]=p=>o(An)(p,void 0))},[rt(E.$slots,"default",{},void 0,!0),L(o(Hn)),L(o(Rn)),L(o(Nn)),W("div",{class:"go-edit-range-model",style:oe(o(h))},null,4)],36))}});var Yn=ce(Gn,[["__scopeId","data-v-52e445d0"]]),Bt=!!(typeof window!="undefined"&&window.document&&window.document.createElement),tt=!1,nt=!1;try{var Je={get passive(){return tt=!0},get once(){return nt=tt=!0}};Bt&&(window.addEventListener("test",Je,Je),window.removeEventListener("test",Je,!0))}catch(e){}function Xn(e,n,t,a){if(a&&typeof a!="boolean"&&!nt){var s=a.once,f=a.capture,h=t;!nt&&s&&(h=t.__once||function E(m){this.removeEventListener(n,E,f),t.call(this,m)},t.__once=h),e.addEventListener(n,h,tt?a:f)}e.addEventListener(n,t,a)}function Wn(e,n,t,a){var s=a&&typeof a!="boolean"?a.capture:a;e.removeEventListener(n,t,s),t.__once&&e.removeEventListener(n,t.__once,s)}function _t(e,n,t,a){return Xn(e,n,t,a),function(){Wn(e,n,t,a)}}var mt=new Date().getTime();function zn(e){var n=new Date().getTime(),t=Math.max(0,16-(n-mt)),a=setTimeout(e,t);return mt=n,a}var qn=["","webkit","moz","o","ms"],Ct=zn,yt=function(n,t){return n+(n?t[0].toUpperCase()+t.substr(1):t)+"AnimationFrame"};Bt&&qn.some(function(e){var n=yt(e,"request");return n in window&&(yt(e,"cancel"),Ct=function(a){return window[n](a)}),!!Ct});Function.prototype.bind.call(Function.prototype.call,[].slice);Function.prototype.bind.call(Function.prototype.call,[].slice);const Jn={class:"go-sketch-rule"},jn={key:1,class:"fix-edit-screens-block"},Vn=ue({__name:"index",setup(e){Ae(T=>({"6f694401":o(G),ed8dd9a8:o(O),"58b617f4":u.value}));const n=re(),t=Yt(),a=ke(),s=20;let f=[0,0],h=[0,0];const E=Q(),m=Q(!0),p=Q(),C=Q(),d=Q(!1),u=Q("auto"),{width:_,height:l}=Ue(n.getEditCanvasConfig),i=Q(0),g=Q(0),y=$e({h:[],v:[]}),M=P(()=>n.getEditCanvas.scale),O=P(()=>`${l.value*2}px`),b=P(()=>a.getDarkTheme?{bgColor:"#18181c",longfgColor:"#4d4d4d",shortfgColor:"#4d4d4d",fontColor:"#4d4d4d",shadowColor:"#18181c",borderColor:"#18181c",cornerActiveColor:"#18181c"}:{}),G=P(()=>a.getAppTheme),X=T=>{if(T.ctrlKey||T.metaKey){T.preventDefault();let B=M.value;if(T.wheelDelta>=0&&M.value<2){B=M.value+.05,n.setScale(B);return}T.wheelDelta<0&&M.value>.1&&(B=M.value-.05,n.setScale(B))}},J=()=>{if(!E.value)return;const T=E.value.getBoundingClientRect(),B=p.value.getBoundingClientRect();i.value=(T.left+s-B.left)/M.value,g.value=(T.top+s-B.top)/M.value},S=T=>{var F,Y;if(T.preventDefault(),T.stopPropagation(),T.which==2)d.value=!0;else if(!((F=window.$KeyboardActive)!=null&&F.space))return;(Y=document.activeElement)==null||Y.blur();const B=T.pageX,r=T.pageY,c=_t(window,"mousemove",$=>{const le=$.pageX-B,Ee=$.pageY-r,[Ke,Fe]=f,[Ne,be]=h;f=[Fe,le],h=[be,Ee],E.value.scrollLeft-=Fe>Ke?Math.abs(Fe-Ke):-Math.abs(Fe-Ke),E.value.scrollTop-=be>Ne?Math.abs(be-Ne):-Math.abs(be-Ne)}),k=_t(window,"mouseup",()=>{c(),k(),f=[0,0],h=[0,0],d.value=!1})},v=()=>{const T=document.getElementById("go-chart-edit-layout");return T?{height:T.clientHeight-25,width:T.clientWidth}:{width:_.value,height:l.value}},H=()=>{m.value=!1,setTimeout(()=>{m.value=!0},10)},K=()=>{const{width:T,height:B}=C.value.getBoundingClientRect(),{width:r,height:c}=v();E.value.scrollLeft=T/2-r/2,E.value.scrollTop=B/2-c/2};return fe(()=>a.getDarkTheme,()=>{H()}),fe(()=>M.value,(T,B)=>{B!==T?(t.setItemUnHandle(Xt.RE_POSITION_CANVAS,!1),J(),setTimeout(()=>{K(),H()},400)):se(H,20)}),fe(()=>d.value,T=>{u.value=T?"grab":"auto"}),at(()=>{E.value&&(E.value.addEventListener("wheel",X,{passive:!1}),K())}),St(()=>{E.value&&E.value.removeEventListener("wheel",X)}),window.onKeySpacePressHold=T=>{d.value=T},(T,B)=>{const r=I("sketch-rule");return x(),z("div",Jn,[m.value?(x(),U(r,{key:0,thick:s,scale:o(M),width:v().width,height:v().height,startX:i.value,startY:g.value,lines:y,palette:o(b)},null,8,["scale","width","height","startX","startY","lines","palette"])):he("",!0),W("div",{ref_key:"$app",ref:E,class:"edit-screens",onScroll:J},[W("div",{ref_key:"$container",ref:C,class:"edit-screen-container",style:oe({width:o(_)*2+"px"})},[W("div",{ref_key:"refSketchRuleBox",ref:p,class:"canvas",onMousedown:S,style:oe({marginLeft:"-"+(v().width/2-25)+"px"})},[W("div",{style:oe({pointerEvents:d.value?"none":"auto"})},[rt(T.$slots,"default",{},void 0,!0)],4)],36)],4)],544),o(a).getDarkTheme?(x(),z("div",jn)):he("",!0)])}}});var Qn=ce(Vn,[["__scopeId","data-v-12b70182"]]);const je={[R.ADD]:"\u65B0\u589E",[R.DELETE]:"\u5220\u9664",[R.UPDATE]:"\u66F4\u65B0",[R.MOVE]:"\u79FB\u52A8",[R.PASTE]:"\u7C98\u8D34",[R.COPY]:"\u590D\u5236",[R.CUT]:"\u526A\u5207",[R.TOP]:"\u7F6E\u9876",[R.BOTTOM]:"\u7F6E\u5E95",[R.UP]:"\u4E0A\u79FB",[R.DOWN]:"\u4E0B\u79FB",[R.GROUP]:"\u6210\u7EC4",[R.UN_GROUP]:"\u89E3\u7EC4",[R.LOCK]:"\u9501\u5B9A",[R.UNLOCK]:"\u89E3\u9501",[R.HIDE]:"\u9690\u85CF",[R.SHOW]:"\u663E\u793A",[Be.CANVAS]:"\u753B\u5E03\u521D\u59CB\u5316"};var Zn=Array.prototype,es=Zn.reverse;function ts(e){return e==null?e:es.call(e)}var ns=ts;const Rt=e=>(At("data-v-5a4fd660"),e=e(),kt(),e),ss={class:"go-flex-items-center"},os=Rt(()=>W("span",{class:"btn-text"},"\u5386\u53F2\u8BB0\u5F55",-1)),as={class:"history-list-box"},rs=["title"],us=Rt(()=>W("div",{class:"popover-modal"},null,-1)),cs=ue({__name:"index",setup(e){const{DesktopOutlineIcon:n,PencilIcon:t,TrashIcon:a,CopyIcon:s,LayersIcon:f,DuplicateIcon:h,HelpOutlineIcon:E,LockClosedOutlineIcon:m,LockOpenOutlineIcon:p,EyeOffOutlineIcon:C,EyeOutlineIcon:d}=De.ionicons5,{StackedMoveIcon:u,Carbon3DCursorIcon:_,Carbon3DSoftwareIcon:l}=De.carbon,i=Wt(),g=O=>{if(O.targetType===Be.CANVAS)return n;switch(O.actionType){case R.UPDATE:return t;case R.DELETE:return a;case R.PASTE:return s;case R.TOP:return f;case R.BOTTOM:return f;case R.UP:return f;case R.DOWN:return f;case R.MOVE:return u;case R.ADD:return h;case R.GROUP:return _;case R.UN_GROUP:return l;case R.LOCK:return m;case R.UNLOCK:return p;case R.HIDE:return C;case R.SHOW:return d;default:return t}},y=O=>{if(O.targetType===Be.CANVAS)return je[Be.CANVAS];if(O.actionType===R.GROUP||O.actionType===R.UN_GROUP)return`${je[O.actionType]}`;if(O.historyData.length)return`${je[O.actionType]} - ${O.historyData[0].chartConfig.title}`},M=P(()=>{const b=i.getBackStack.map(G=>({label:y(G),icon:g(G)}));return ns(b.filter(G=>G.label))});return(O,b)=>{const G=I("n-button"),X=I("n-icon"),J=I("n-text"),S=I("n-scrollbar"),v=I("n-popover"),H=I("n-tooltip");return x(),z("div",ss,[L(v,{class:"edit-history-popover","show-arrow":!1,size:"small",trigger:"click",placement:"top-start"},{trigger:A(()=>[L(G,{class:"mr-10",secondary:"",size:"small",disabled:o(M).length===0},{default:A(()=>[os]),_:1},8,["disabled"])]),default:A(()=>[W("div",as,[L(S,{style:{"max-height":"500px"}},{default:A(()=>[(x(!0),z(pe,null,_e(o(M),(K,T)=>(x(),z("div",{class:"list-item go-flex-items-center go-ellipsis-1",key:T,title:K.label},[L(X,{class:"item-icon",size:"16",depth:2,component:K.icon},null,8,["component"]),L(J,{depth:"2"},{default:A(()=>[Ce(de(K.label),1)]),_:2},1024)],8,rs))),128))]),_:1}),us])]),_:1}),L(H,{trigger:"hover"},{trigger:A(()=>[L(X,{size:"21",depth:3},{default:A(()=>[L(o(E))]),_:1})]),default:A(()=>[W("span",null,"\u6700\u591A\u53EA\u4FDD\u7559"+de(o(en))+"\u6761\u8BB0\u5F55",1)]),_:1})])}}});var ls=ce(cs,[["__scopeId","data-v-5a4fd660"]]);const is={class:"go-edit-bottom"},ds=ue({__name:"index",setup(e){Ae(g=>({f3add9fc:s.value}));const{LockClosedOutlineIcon:n,LockOpenOutlineIcon:t}=De.ionicons5,a=ke(),s=Q(a.getAppTheme),f=re(),{lockScale:h,scale:E}=Ue(f.getEditCanvas);let m=[{label:"200%",value:200},{label:"150%",value:150},{label:"100%",value:100},{label:"50%",value:50},{label:"\u81EA\u9002\u5E94",value:0}];const p=Q(""),C=g=>{if(g===0){f.computedScale();return}f.setScale(g/100)},d=()=>{f.setEditCanvas(ae.LOCK_SCALE,!h.value)},u=Q(100),_=g=>`${g}%`,l=g=>{f.setScale(g/100)},i=$e({100:""});return tn(()=>{const g=(E.value*100).toFixed(0);p.value=`${g}%`,u.value=parseInt(g)}),(g,y)=>{const M=I("n-text"),O=I("n-space"),b=I("n-select"),G=I("n-icon"),X=I("n-button"),J=I("n-tooltip"),S=I("n-slider");return x(),z("div",is,[L(O,null,{default:A(()=>[L(o(ls)),L(M,{id:"keyboard-dress-show",depth:"3"})]),_:1}),L(O,{class:"bottom-ri"},{default:A(()=>[L(Cn),L(b,{disabled:o(h),class:"scale-btn",value:p.value,"onUpdate:value":[y[0]||(y[0]=v=>p.value=v),C],size:"mini",options:o(m)},null,8,["disabled","value","options"]),L(J,{trigger:"hover"},{trigger:A(()=>[L(X,{onClick:d,text:""},{default:A(()=>[L(G,{class:ie(["lock-icon",{color:o(h)}]),size:"18",depth:2},{default:A(()=>[o(h)?(x(),U(o(n),{key:0})):(x(),U(o(t),{key:1}))]),_:1},8,["class"])]),_:1})]),default:A(()=>[W("span",null,de(o(h)?"\u89E3\u9501":"\u9501\u5B9A")+"\u5F53\u524D\u6BD4\u4F8B",1)]),_:1}),L(S,{class:"scale-slider",value:u.value,"onUpdate:value":[y[1]||(y[1]=v=>u.value=v),l],"default-value":50,min:10,max:200,step:5,"format-tooltip":_,disabled:o(h),marks:i},null,8,["value","disabled","marks"])]),_:1})])}}});var fs=ce(ds,[["__scopeId","data-v-99a534fc"]]);const ps=ue({__name:"index",props:{modelShow:Boolean},emits:["update:modelShow"],setup(e,{emit:n}){const t=e,{HelpOutlineIcon:a,CloseIcon:s}=De.ionicons5,f=ut(),h=Q(!1),E=$e([{key:ve.ASIDE_ALL_COLLAPSED,value:f.getAsideAllCollapsed,type:"switch",name:"\u83DC\u5355\u6298\u53E0",desc:"\u9996\u9875\u83DC\u5355\u6298\u53E0\u65F6\u9690\u85CF\u81F3\u754C\u9762\u5916"},{key:ve.HIDE_PACKAGE_ONE_CATEGORY,value:f.getHidePackageOneCategory,type:"switch",name:"\u9690\u85CF\u5206\u7C7B",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u8868\u5355\u5206\u7C7B\u53EA\u6709\u5355\u9879\u65F6\u9690\u85CF"},{key:ve.CHANGE_LANG_RELOAD,value:f.getChangeLangReload,type:"switch",name:"\u5207\u6362\u8BED\u8A00",desc:"\u5207\u6362\u8BED\u8A00\u91CD\u65B0\u52A0\u8F7D\u9875\u9762",tip:"\u82E5\u9047\u5230\u90E8\u5206\u533A\u57DF\u8BED\u8A00\u5207\u6362\u5931\u8D25\uFF0C\u5219\u5EFA\u8BAE\u5F00\u542F"},{key:"divider1",type:"divider",name:"",desc:"",value:""},{key:ve.CHART_TOOLS_STATUS_HIDE,value:f.getChartToolsStatusHide,type:"switch",name:"\u9690\u85CF\u5DE5\u5177\u680F",desc:"\u9F20\u6807\u79FB\u5165\u65F6\uFF0C\u4F1A\u5C55\u793A\u5207\u6362\u5230\u5C55\u5F00\u6A21\u5F0F"},{key:ve.CHART_TOOLS_STATUS,value:f.getChartToolsStatus,type:"select",name:"\u5DE5\u5177\u680F\u5C55\u793A",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u5DE5\u5177\u680F\u5C55\u793A\u65B9\u5F0F",options:[{label:"\u4FA7\u8FB9\u680F",value:Pe.ASIDE},{label:"\u5E95\u90E8 Dock",value:Pe.DOCK}]},{key:"divider0",type:"divider",name:"",desc:"",value:""},{key:ve.CHART_MOVE_DISTANCE,value:f.getChartMoveDistance,type:"number",name:"\u79FB\u52A8\u8DDD\u79BB",min:1,step:1,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u65B9\u5411\u952E\u63A7\u5236\u79FB\u52A8\u8DDD\u79BB"},{key:ve.CHART_ALIGN_RANGE,value:f.getChartAlignRange,type:"number",name:"\u5438\u9644\u8DDD\u79BB",min:10,step:2,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u79FB\u52A8\u56FE\u8868\u65F6\u7684\u5438\u9644\u8DDD\u79BB"}]);fe(()=>t.modelShow,C=>{h.value=C});const m=()=>{n("update:modelShow",!1)},p=(C,d)=>{f.setItem(d.key,d.value)};return(C,d)=>{const u=I("n-h3"),_=I("n-icon"),l=I("n-space"),i=I("n-divider"),g=I("n-text"),y=I("n-switch"),M=I("n-input-number"),O=I("n-select"),b=I("n-tooltip"),G=I("n-list-item"),X=I("n-list"),J=I("n-modal");return x(),U(J,{show:h.value,"onUpdate:show":d[0]||(d[0]=S=>h.value=S),onAfterLeave:m},{default:A(()=>[L(X,{bordered:"",class:"go-system-setting"},{header:A(()=>[L(l,{justify:"space-between"},{default:A(()=>[L(u,{class:"go-mb-0"},{default:A(()=>[Ce("\u7CFB\u7EDF\u8BBE\u7F6E")]),_:1}),L(_,{size:"20",class:"go-cursor-pointer",onClick:m},{default:A(()=>[L(o(s))]),_:1})]),_:1})]),default:A(()=>[(x(!0),z(pe,null,_e(E,S=>(x(),U(G,{key:S.key},{default:A(()=>[S.type==="divider"?(x(),U(i,{key:0,style:{margin:"0"}})):(x(),U(l,{key:1,size:40},{default:A(()=>[L(l,null,{default:A(()=>[L(g,{class:"item-left"},{default:A(()=>[Ce(de(S.name),1)]),_:2},1024),S.type==="switch"?(x(),U(y,{key:0,value:S.value,"onUpdate:value":[v=>S.value=v,v=>p(v,S)],size:"small"},null,8,["value","onUpdate:value"])):S.type==="number"?(x(),U(M,{key:1,value:S.value,"onUpdate:value":[v=>S.value=v,v=>p(v,S)],class:"input-num-width",size:"small",step:S.step||null,suffix:S.suffix||null,min:S.min||0},null,8,["value","onUpdate:value","step","suffix","min"])):S.type==="select"?(x(),U(O,{key:2,class:"select-min-width",value:S.value,"onUpdate:value":[v=>S.value=v,v=>p(v,S)],size:"small",options:S.options},null,8,["value","onUpdate:value","options"])):he("",!0)]),_:2},1024),L(l,null,{default:A(()=>[L(g,{class:"item-right"},{default:A(()=>[Ce(de(S.desc),1)]),_:2},1024),S.tip?(x(),U(b,{key:0,trigger:"hover"},{trigger:A(()=>[L(_,{size:"21"},{default:A(()=>[L(o(a))]),_:1})]),default:A(()=>[W("span",null,de(S.tip),1)]),_:2},1024)):he("",!0)]),_:2},1024)]),_:2},1024))]),_:2},1024))),128))]),_:1})]),_:1},8,["show"])}}});var hs=ce(ps,[["__scopeId","data-v-7cea0aa5"]]);const xe=re(),vs=()=>{xe.setTargetSelectChart(void 0),nn(sn(xe.getStorageInfo||[]),void 0,"json");const e=document.querySelector(".go-edit-range"),n=document.getElementById("go-edit-watermark");if(!e||!n){window.$message.error("\u5BFC\u51FA\u5931\u8D25\uFF01");return}const t=xe.getEditCanvas.scale;xe.setScale(1,!0),n.style.display="block",setTimeout(()=>{on(e,()=>{n&&(n.style.display="none"),xe.setScale(t,!0)})},600)};var st=(e=>(e.TXT="text/plain",e.JSON="application/json",e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e))(st||{});const gs=()=>{const e=Q(),{updateComponent:n}=ot();return{importUploadFileListRef:e,importBeforeUpload:({file:s})=>{e.value=[];const f=s.file.type;return f!==st.JSON&&f!==st.TXT?(window.$message.warning("\u4EC5\u652F\u6301\u4E0A\u4F20 \u3010JSON\u3011 \u683C\u5F0F\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20\uFF01"),!1):!0},importCustomRequest:s=>{const{file:f}=s;an(()=>{f.file?rn(f.file).then(h=>{_n({message:"\u8BF7\u9009\u62E9\u5BFC\u5165\u65B9\u5F0F:",positiveText:"\u65B0\u589E\uFF08\u53EF\u64A4\u56DE\uFF09",negativeText:"\u8986\u76D6\uFF08\u4E0D\u53EF\u64A4\u56DE\uFF09",negativeButtonProps:{type:"info",ghost:!1},onPositiveCallback:()=>Se(void 0,null,function*(){try{h=Ve(h),yield n(h,!1,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(E){console.log(E),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}}),onNegativeCallback:()=>Se(void 0,null,function*(){try{h=Ve(h),yield n(h,!0,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(E){console.log(E),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}})})}):window.$message.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6216\u8054\u7CFB\u7BA1\u7406\u5458\uFF01")})}}},{updateComponent:_s,dataSyncUpdate:Et}=ot(),ms=re(),Cs=()=>{const e=f=>_s(f.detail,!0,!1),n=()=>Se(void 0,null,function*(){Et&&(yield Et()),dispatchEvent(new CustomEvent(Xe.CHART,{detail:ms.getStorageInfo}))}),t=()=>{addEventListener("blur",n),addEventListener(Xe.JSON,e)},a=()=>{removeEventListener(Xe.JSON,e),removeEventListener("blur",n)};return(f,h)=>{h==ht.CHART_HOME_NAME&&a(),f==ht.CHART_HOME_NAME&&t()}},ys=()=>{const e=Ft();fe(()=>e.name,Cs(),{immediate:!0})};var ge=(e=>(e.BUTTON="button",e.IMPORTUPLOAD="importUpload",e))(ge||{});const Es={class:"btn-item"},ws=ue({__name:"index",setup(e){const{DownloadIcon:n,ShareIcon:t,PawIcon:a,SettingsSharpIcon:s,CreateIcon:f}=De.ionicons5,h=ut(),E=re();Ft(),ys();let m=null;const p=Q(!1),C=Q(!0),d=Q(!0),{importUploadFileListRef:u,importCustomRequest:_,importBeforeUpload:l}=gs(),i=P(()=>h.getChartToolsStatus===Pe.ASIDE),g=P(()=>h.getChartToolsStatusHide),y=P(()=>C.value&&g.value),M=P(()=>{if(!i.value)return J;const S=[];return J.map(v=>{S.unshift(v)}),S}),O=()=>{m=setTimeout(()=>{C.value&&(C.value=!1,d.value=!0)},200),setTimeout(()=>{d.value=!1},400)},b=()=>{clearTimeout(m),C.value||(C.value=!0)},G=()=>{window.$message.warning("\u5C06\u5F00\u542F\u5931\u7126\u66F4\u65B0\uFF01"),setTimeout(()=>{const S=cn(ln.CHART_EDIT_NAME,"href");if(!S)return;const v=dn();X(v),fn(S,[v],void 0,!0)},1e3)},X=S=>{const v=E.getStorageInfo,H=pn(Oe.GO_CHART_STORAGE_LIST)||[];if(H!=null&&H.length){const K=H.findIndex(T=>T.id===S);K!==-1?(H.splice(K,1,we(N({},v),{id:S})),qe(Oe.GO_CHART_STORAGE_LIST,H)):(H.push(we(N({},v),{id:S})),qe(Oe.GO_CHART_STORAGE_LIST,H))}else qe(Oe.GO_CHART_STORAGE_LIST,[we(N({},v),{id:S})])},J=[{key:"import",type:ge.IMPORTUPLOAD,name:"\u5BFC\u5165",icon:t},{key:"export",type:ge.BUTTON,name:"\u5BFC\u51FA",icon:n,handle:vs},{key:"edit",type:ge.BUTTON,name:"\u7F16\u8F91",icon:f,handle:G},{key:"setting",type:ge.BUTTON,name:"\u8BBE\u7F6E",icon:s,handle:()=>{p.value=!0}}];return(S,v)=>{const H=I("n-icon"),K=I("n-text"),T=I("n-button"),B=I("n-upload"),r=I("n-tooltip");return x(),z(pe,null,[W("div",{class:ie(["go-chart-edit-tools",[o(h).getChartToolsStatus,o(y)?"isMini":"unMini"]]),onClick:v[1]||(v[1]=c=>C.value&&(C.value=!1)),onMouseenter:O,onMouseleave:b},[We(L(H,{class:"asideLogo",size:"22"},{default:A(()=>[L(o(a))]),_:1},512),[[ze,o(h).getChartToolsStatus===o(Pe).ASIDE&&o(y)]]),(x(!0),z(pe,null,_e(o(M),(c,k)=>(x(),U(r,{key:c.key,disabled:!o(i)||o(g)&&d.value,trigger:"hover",placement:"left"},{trigger:A(()=>[W("div",Es,[c.type===o(ge).BUTTON?(x(),U(T,{key:0,circle:o(i),secondary:"",onClick:c.handle},{icon:A(()=>[o(i)?(x(),U(H,{key:0,size:"22"},{default:A(()=>[(x(),U(me(c.icon)))]),_:2},1024)):(x(),U(me(c.icon),{key:1}))]),default:A(()=>[We(L(K,{depth:"3"},{default:A(()=>[Ce(de(c.name),1)]),_:2},1536),[[ze,!o(i)]])]),_:2},1032,["circle","onClick"])):c.type===o(ge).IMPORTUPLOAD?(x(),U(B,{key:1,"file-list":o(u),"onUpdate:fileList":v[0]||(v[0]=F=>un(u)?u.value=F:null),"show-file-list":!1,customRequest:o(_),onBeforeUpload:o(l)},{default:A(()=>[L(T,{circle:o(i),secondary:""},{icon:A(()=>[o(i)?(x(),U(H,{key:0,size:"22"},{default:A(()=>[(x(),U(me(c.icon)))]),_:2},1024)):(x(),U(me(c.icon),{key:1}))]),default:A(()=>[We(L(K,{depth:"3"},{default:A(()=>[Ce(de(c.name),1)]),_:2},1536),[[ze,!o(i)]])]),_:2},1032,["circle"])]),_:2},1032,["file-list","customRequest","onBeforeUpload"])):he("",!0)])]),default:A(()=>[W("span",null,de(c.name),1)]),_:2},1032,["disabled"]))),128))],34),L(o(hs),{modelShow:p.value,"onUpdate:modelShow":v[2]||(v[2]=c=>p.value=c)},null,8,["modelShow"])],64)}}});var Ss=ce(ws,[["__scopeId","data-v-4c257f27"]]);const Ts=ue({__name:"index",setup(e){const n=re(),{handleContextMenu:t}=ct();ot(),yn();const{mouseenterHandle:a,mouseleaveHandle:s,mousedownHandle:f,mouseClickHandle:h}=Lt(),E=(_,l,i)=>{if(n.getTargetChart.selectId.length>1)return l.filter(y=>[D.GROUP,D.DELETE].includes(y.key));const g=[];return i.status.lock?g.push(D.LOCK):g.push(D.UNLOCK),i.status.hide?g.push(D.HIDE):g.push(D.SHOW),_.filter(y=>!g.includes(y.key))},m=_=>{var l;return!!((l=_.chartConfig.filters)!=null&&l.length)},p=_=>{var M;const l=(M=_.chartConfig.filters)==null?void 0:M.map(O=>O.type==Jt.DATE&&O.from!="query"?221:450);if(!(l!=null&&l.length))return 0;const i=l==null?void 0:l.reduce((O,b)=>O+b+8),g=i?Math.ceil(i/_.attr.w):0;return g*24+(g-1)*8+16},C=P(()=>n.getEditCanvasConfig.chartThemeSetting),d=P(()=>{const _=n.getEditCanvasConfig.chartThemeColor;return wt[_]});P(()=>n.getEditCanvasConfig.filterShow);const u=P(()=>{const _=n.getEditCanvasConfig.background,l=n.getEditCanvasConfig.backgroundImage,y=n.getEditCanvasConfig.selectColor?{background:_||void 0}:{background:`url(${l}) no-repeat center center / cover !important`};return we(N({},y),{width:"inherit",height:"inherit"})});return at(()=>{Tn()}),(_,l)=>(x(),U(o(mn),{id:"go-chart-edit-layout",flex:!0,showTop:!1,showBottom:!0,depth:1,xScroll:!0,disabledScroll:!0,onMousedown:o(Ot),onDrop:o(Dn),onDragover:o(gt),onDragenter:o(gt)},{aside:A(()=>[L(o(Ss))]),bottom:A(()=>[L(o(fs))]),default:A(()=>[L(o(Qn),null,{default:A(()=>[W("div",{id:"go-chart-edit-content",onContextmenu:l[0]||(l[0]=(...i)=>o(t)&&o(t)(...i))},[L(o(Yn),null,{default:A(()=>[W("div",{style:oe(N(N({},o(He)(o(n).getEditCanvasConfig)),o(u)))},[(x(!0),z(pe,null,_e(o(n).getComponentList,(i,g)=>(x(),z("div",{key:i.id},[i.isGroup?(x(),U(o(Ln),{key:0,groupData:i,groupIndex:g},null,8,["groupData","groupIndex"])):(x(),U(o(et),{key:1,"data-id":i.id,index:g,style:oe(N(N({},o(Ie)(i.attr,g)),o(Dt)(i.styles))),item:i,onClick:y=>o(h)(y,i),onMousedown:y=>o(f)(y,i),onMouseenter:y=>o(a)(y,i),onMouseleave:y=>o(s)(y,i),onContextmenu:y=>o(t)(y,i,E)},{default:A(()=>[m(i)?(x(),U(o(zt),{key:0,class:"filter-content",componentIdx:i.id,attr:i.attr,filters:i.chartConfig.filters,type:i.chartConfig.category},null,8,["componentIdx","attr","filters","type"])):he("",!0),(x(),U(me(i.chartConfig.chartKey),{class:ie(["edit-content-chart",o(Qe)(i.styles.animations)]),chartConfig:i,themeSetting:o(C),themeColor:o(d),style:oe(N(N(N({},o(qt)(i.attr,p(i))),o(He)(i.styles)),o(Ze)(i.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","style","item","onClick","onMousedown","onMouseenter","onMouseleave","onContextmenu"]))]))),128))],4)]),_:1})],32)]),_:1})]),_:1},8,["onMousedown","onDrop","onDragover","onDragenter"]))}});var Is=ce(Ts,[["__scopeId","data-v-2425a4bc"]]);export{Is as default};
