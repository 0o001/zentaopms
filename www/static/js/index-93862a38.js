var Wt=Object.defineProperty,zt=Object.defineProperties;var Vt=Object.getOwnPropertyDescriptors;var ht=Object.getOwnPropertySymbols;var qt=Object.prototype.hasOwnProperty,Jt=Object.prototype.propertyIsEnumerable;var gt=(e,t,n)=>t in e?Wt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,P=(e,t)=>{for(var n in t||(t={}))qt.call(t,n)&&gt(e,n,t[n]);if(ht)for(var n of ht(t))Jt.call(t,n)&&gt(e,n,t[n]);return e},fe=(e,t)=>zt(e,Vt(t));var le=(e,t,n)=>new Promise((o,s)=>{var p=g=>{try{m(n.next(g))}catch(v){s(v)}},l=g=>{try{m(n.throw(g))}catch(v){s(v)}},m=g=>g.done?o(g.value):Promise.resolve(g.value).then(p,l);m((n=n.apply(e,t)).next())});import{u as re,E as j,d as Xe,a as Ft,C as Qt,j as Zt,c as Lt,H as B,k as Ie}from"./chartEditStore-ac923661.js";import{x as lt,a6 as Ot,bd as jt,aj as x,c5 as Mt,c6 as bt,cl as _t,U as We,aC as ze,aV as Ve,ay as Me,az as mt,ck as en,c2 as nt,cm as V,ca as qe,ak as tn,j as ce,d as ue,bT as ke,f as a,u as Fe,a5 as U,o as D,m as z,n as dt,F as he,A as Ee,ad as de,aJ as ae,aa as Ce,z as W,c as N,w as A,L as Se,aI as ot,aK as He,aL as st,aM as Rt,a4 as ft,y as Ne,al as Ct,R as ve,r as I,cn as nn,a3 as Ke,v as Z,co as yt,G as Bt,H as It,e as O,p as we,t as pe,aB as on,b0 as sn,cp as ge,cq as Pe,cr as an,c1 as rn,cs as un,am as cn,ct as ln,J as Ht,Q as Et,aQ as Je,X as Qe,Y as Ze,c0 as dn,V as fn,cu as pn,cv as vn,W as hn,c4 as gn,S as be,aR as je}from"./index.js";import{u as pt,d as _n}from"./index-44e84cf4.js";import{t as oe,f as mn,b as Cn,h as Pt,l as Ue}from"./index-760f71cb.js";import{u as Ut,C as at}from"./chartLayoutStore-9d5c33b6.js";import{a as yn,b as St,l as En,g as Sn}from"./plugin-b83a6fcc.js";import{C as wn}from"./index-0abf7ae9.js";import{i as De}from"./icon-5c6b1271.js";import{E as Tn}from"./index-50ec0fd6.js";import"./index-d59ca57a.js";import"./index-d6d7fe8e.js";import"./tables_list-3a60c537.js";import"./SizeSetting.vue_vue_type_style_index_0_scoped_true_lang-3bf74432.js";import"./useTargetData.hook-da2b6121.js";const xe=re(),xn=()=>{lt(()=>{xe.setEditCanvas(j.EDIT_LAYOUT_DOM,document.getElementById("go-chart-edit-layout")),xe.setEditCanvas(j.EDIT_CONTENT_DOM,document.getElementById("go-chart-edit-content"));const e=xe.listenerScale();Ot(()=>{xe.setEditCanvas(j.EDIT_LAYOUT_DOM,null),xe.setEditCanvas(j.EDIT_CONTENT_DOM,null),e()})})};var $t={exports:{}};(function(e){(function(t){var n,o={},s={16:!1,18:!1,17:!1,91:!1},p="all",l={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},m={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},g=function(u){return m[u]||u.toUpperCase().charCodeAt(0)},v=[];for(n=1;n<20;n++)m["f"+n]=111+n;function d(u,f){for(var k=u.length;k--;)if(u[k]===f)return k;return-1}function c(u,f){if(u.length!=f.length)return!1;for(var k=0;k<u.length;k++)if(u[k]!==f[k])return!1;return!0}var r={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function C(u){for(n in s)s[n]=u[r[n]]}function i(u){var f,k,F,Y,$,ie;if(f=u.keyCode,d(v,f)==-1&&v.push(f),(f==93||f==224)&&(f=91),f in s){s[f]=!0;for(F in l)l[F]==f&&(S[F]=!0);return}if(C(u),!!S.filter.call(this,u)&&f in o){for(ie=q(),Y=0;Y<o[f].length;Y++)if(k=o[f][Y],k.scope==ie||k.scope=="all"){$=k.mods.length>0;for(F in s)(!s[F]&&d(k.mods,+F)>-1||s[F]&&d(k.mods,+F)==-1)&&($=!1);(k.mods.length==0&&!s[16]&&!s[18]&&!s[17]&&!s[91]||$)&&k.method(u,k)===!1&&(u.preventDefault?u.preventDefault():u.returnValue=!1,u.stopPropagation&&u.stopPropagation(),u.cancelBubble&&(u.cancelBubble=!0))}}}function y(u){var f=u.keyCode,k,F=d(v,f);if(F>=0&&v.splice(F,1),(f==93||f==224)&&(f=91),f in s){s[f]=!1;for(k in l)l[k]==f&&(S[k]=!1)}}function h(){for(n in s)s[n]=!1;for(n in l)S[n]=!1}function S(u,f,k){var F,Y;F=_(u),k===void 0&&(k=f,f="all");for(var $=0;$<F.length;$++)Y=[],u=F[$].split("+"),u.length>1&&(Y=H(u),u=[u[u.length-1]]),u=u[0],u=g(u),u in o||(o[u]=[]),o[u].push({shortcut:F[$],scope:f,method:k,key:F[$],mods:Y})}function M(u,f){var k,F,Y=[],$,ie,Te;for(k=_(u),ie=0;ie<k.length;ie++){if(F=k[ie].split("+"),F.length>1&&(Y=H(F),u=F[F.length-1]),u=g(u),f===void 0&&(f=q()),!o[u])return;for($=0;$<o[u].length;$++)Te=o[u][$],Te.scope===f&&c(Te.mods,Y)&&(o[u][$]={})}}function R(u){return typeof u=="string"&&(u=g(u)),d(v,u)!=-1}function L(){return v.slice(0)}function G(u){var f=(u.target||u.srcElement).tagName;return!(f=="INPUT"||f=="SELECT"||f=="TEXTAREA")}for(n in l)S[n]=!1;function X(u){p=u||"all"}function q(){return p||"all"}function w(u){var f,k,F;for(f in o)for(k=o[f],F=0;F<k.length;)k[F].scope===u?k.splice(F,1):F++}function _(u){var f;return u=u.replace(/\s/g,""),f=u.split(","),f[f.length-1]==""&&(f[f.length-2]+=","),f}function H(u){for(var f=u.slice(0,u.length-1),k=0;k<f.length;k++)f[k]=l[f[k]];return f}function K(u,f,k){u.addEventListener?u.addEventListener(f,k,!1):u.attachEvent&&u.attachEvent("on"+f,function(){k(window.event)})}K(document,"keydown",function(u){i(u)}),K(document,"keyup",y),K(window,"focus",h);var T=t.key;function b(){var u=t.key;return t.key=T,u}t.key=S,t.key.setScope=X,t.key.getScope=q,t.key.deleteScope=w,t.key.filter=G,t.key.isPressed=R,t.key.getPressedKeyCodes=L,t.key.noConflict=b,t.key.unbind=M,e.exports=S})(jt)})($t);var ee=$t.exports;const te=re(),se=e=>`${Mt.CTRL}+${e}`,Re=e=>`${Mt.SHIFT}+${e}`,J={[x.ARROW_UP]:se("up"),[x.ARROW_RIGHT]:se("right"),[x.ARROW_DOWN]:se("down"),[x.ARROW_LEFT]:se("left"),[x.COPY]:se("c"),[x.CUT]:se("x"),[x.PARSE]:se("v"),[x.DELETE]:"delete",[x.BACK]:se("z"),[x.FORWORD]:se(Re("z")),[x.GROUP]:se("g"),[x.UN_GROUP]:se(Re("g")),[x.LOCK]:se("l"),[x.UNLOCK]:se(Re("l")),[x.HIDE]:se("h"),[x.SHOW]:se(Re("h"))},ne=e=>`${bt.CTRL}+${e}`,Be=e=>`${bt.SHIFT}+${e}`,Q={[x.ARROW_UP]:ne("arrowup"),[x.ARROW_RIGHT]:ne("arrowright"),[x.ARROW_DOWN]:ne("arrowdown"),[x.ARROW_LEFT]:ne("arrowleft"),[x.COPY]:ne("c"),[x.CUT]:ne("x"),[x.PARSE]:ne("v"),[x.DELETE]:ne("backspace"),[x.BACK]:ne("z"),[x.FORWORD]:ne(Be("z")),[x.GROUP]:ne("g"),[x.UN_GROUP]:ne(Be("g")),[x.LOCK]:ne("l"),[x.UNLOCK]:ne(Be("l")),[x.HIDE]:ne("h"),[x.SHOW]:ne(Be("h"))},An=[J.up,J.right,J.down,J.left,J.delete,J.copy,J.cut,J.parse,J.back,J.forward,J.group,J.unGroup,J.lock,J.unLock,J.hide,J.show],Dn=[Q.up,Q.right,Q.down,Q.left,Q.delete,Q.copy,Q.cut,Q.parse,Q.back,Q.forward,Q.group,Q.unGroup,Q.lock,Q.unLock,Q.hide,Q.show],kn=()=>{window.$KeyboardActive={ctrl:!1,space:!1},document.onkeydown=e=>{const{keyCode:t}=e;if(t==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(t)&&window.$KeyboardActive)switch(_t(e.keyCode),t){case 17:window.$KeyboardActive.ctrl=!0;break;case 32:window.$KeyboardActive.space=!0;break}},document.onkeyup=e=>{const{keyCode:t}=e;if(t==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(t)&&window.$KeyboardActive)switch(_t(),t){case 17:window.$KeyboardActive.ctrl=!1;break;case 32:window.$KeyboardActive.space=!1;break}}},Fn=()=>{const t=(n,o)=>{switch(o){case n.up:ee(o,oe(()=>(te.setMove(x.ARROW_UP),!1),50));break;case n.right:ee(o,oe(()=>(te.setMove(x.ARROW_RIGHT),!1),50));break;case n.down:ee(o,oe(()=>(te.setMove(x.ARROW_DOWN),!1),50));break;case n.left:ee(o,oe(()=>(te.setMove(x.ARROW_LEFT),!1),50));break;case n.delete:ee(o,Xe(()=>(te.removeComponentList(),!1),50));break;case n.copy:ee(o,Xe(()=>(te.setCopy(),!1),50));break;case n.cut:ee(o,Xe(()=>(te.setCut(),!1),50));break;case n.parse:ee(o,oe(()=>(te.setParse(),!1),50));break;case n.back:ee(o,oe(()=>(te.setBack(),!1),50));break;case n.forward:ee(o,oe(()=>(te.setForward(),!1),50));break;case n.group:ee(o,oe(()=>(te.setGroup(),!1),50));break;case n.unGroup:ee(o,oe(()=>(te.setUnGroup(),!1),50));break;case n.lock:ee(o,oe(()=>(te.setLock(),!1),50));break;case n.unLock:ee(o,oe(()=>(te.setUnLock(),!1),50));break;case n.hide:ee(o,oe(()=>(te.setHide(),!1),50));break;case n.show:ee(o,oe(()=>(te.setShow(),!1),50));break}};An.forEach(n=>{t(J,n)}),Dn.forEach(n=>{t(Q,n)}),kn()},Ln=e=>e,On=(e,t)=>{try{if(t.id){const n="vnodeBeforeMount"in t.events,o="vnodeMounted"in t.events;return n&&(e.events.advancedEvents.vnodeBeforeMount=t==null?void 0:t.events.vnodeBeforeMount),o&&(e.events.advancedEvents.vnodeMounted=t==null?void 0:t.events.vnodeMounted),(n||o)&&(t.events={baseEvent:{[Me.ON_CLICK]:void 0,[Me.ON_DBL_CLICK]:void 0,[Me.ON_MOUSE_ENTER]:void 0,[Me.ON_MOUSE_LEAVE]:void 0},advancedEvents:{[mt.VNODE_MOUNTED]:void 0,[mt.VNODE_BEFORE_MOUNT]:void 0}}),e}}catch(n){return e}},_e=(e,t,n=!1)=>{if(On(e,t),n)return Ve(e,t);const o=t.option;if(!o)return Ve(e,t);if(t.option=void 0,o)return fe(P({},Ve(e,t)),{option:o})},vt=()=>{const e=re(),t=Ft(),n=Ut(),o=(l,m=!1,g=!1)=>le(void 0,null,function*(){m&&(e.componentList=[],t.clearBackStack(),t.clearForwardStack()),l.editCanvasConfig=Ln(l.editCanvasConfig),l.componentList.forEach(d=>le(void 0,null,function*(){const c=r=>{window.$vue.component(r.chartConfig.chartKey)||(window.$vue.component(r.chartConfig.chartKey,mn(r.chartConfig)),window.$vue.component(r.chartConfig.conKey,Cn(r.chartConfig)))};d.isGroup?d.groupList.forEach(r=>{c(r)}):c(d)}));const v=(d,c)=>le(void 0,null,function*(){let r=yield Pt(d.chartConfig);c?c(g?_e(r,fe(P({},d),{id:We()})):_e(r,d)):g?e.addComponentList(_e(r,fe(P({},d),{id:We()})),!1,!0):e.addComponentList(_e(r,d),!1,!0)});for(const d in l)if(d===Qt.COMPONENT_LIST){let c=0;const r=l[d].length;for(const C of l[d]){let i=parseInt((parseFloat(`${++c/r}`)*100).toString());if(n.setItemUnHandle(at.PERCENTAGE,i),C.isGroup){let y=new Zt;g?y=_e(y,fe(P({},C),{id:We()})):y=_e(y,C);const h=[];for(const S of C.groupList)yield v(S,M=>{h.push(M)});y.groupList=h,e.addComponentList(y,!1,!0)}else yield v(C)}}else(d==="editCanvasConfig"||d==="requestGlobalConfig")&&_e(e[d],l[d],!0);n.setItemUnHandle(at.PERCENTAGE,0)}),s=()=>le(void 0,null,function*(){e.componentList=[],e.setEditCanvas(j.SAVE_STATUS,ze.START);const l=window.chartData;l&&(yield o(l))}),p=oe((l=!0)=>le(void 0,null,function*(){e.setEditCanvas(j.SAVE_STATUS,ze.START),e.getStorageInfo,setTimeout(()=>{e.setEditCanvas(j.SAVE_STATUS,ze.SUCCESS)},1e3)}),3e3);return{updateComponent:o,dataSyncFetch:s,dataSyncUpdate:p}},E=re(),{onClickOutSide:Mn}=pt(),bn=e=>le(void 0,null,function*(){e.preventDefault();try{yn();const t=e.dataTransfer.getData(en.DRAG_KEY);if(!t){St();return}E.setEditCanvas(j.IS_CREATE,!1);const n=nt(t);let o=yield Pt(n);V(o,e.offsetX-o.attr.w/2,e.offsetY-o.attr.h/2),E.addComponentList(o,!1,!0),E.setTargetSelectChart(o.id),St()}catch(t){En(),window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...")}}),wt=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},Nt=(e,t)=>{if(t){E.setTargetSelectChart(t.id);return}E.setTargetSelectChart(void 0)},Rn=(e,t)=>{var v;if(e.which==2||(v=window.$KeyboardActive)!=null&&v.space)return;Nt();const n=e.offsetX,o=e.offsetY,s=e.screenX,p=e.screenY,l=E.getEditCanvas.scale;E.setMousePosition(void 0,void 0,n,o);const m=Ue.exports.throttle(d=>{E.setTargetSelectChart(),E.setEditCanvas(j.IS_SELECT,!0);const c=n+d.screenX-s,r=o+d.screenY-p;E.setMousePosition(c,r);const C={x1:0,y1:0,x2:0,y2:0};c>n&&r>o?(C.x1=n,C.y1=o,C.x2=Math.round(n+(d.screenX-s)/l),C.y2=Math.round(o+(d.screenY-p)/l)):c>n&&r<o?(C.x1=n,C.y1=Math.round(o-(p-d.screenY)/l),C.x2=Math.round(n+(d.screenX-s)/l),C.y2=o):c<n&&r>o?(C.x1=Math.round(n-(s-d.screenX)/l),C.y1=o,C.x2=n,C.y2=Math.round(o+(d.screenY-p)/l)):(C.x1=Math.round(n-(s-d.screenX)/l),C.y1=Math.round(o-(p-d.screenY)/l),C.x2=n,C.y2=o),E.getComponentList.forEach(i=>{if(!E.getTargetChart.selectId.includes(i.id)){const{x:y,y:h,w:S,h:M}=i.attr,R={x1:y,y1:h,x2:y+S,y2:h+M};R.x1-C.x1>=0&&R.y1-C.y1>=0&&R.x2-C.x2<=0&&R.y2-C.y2<=0&&!i.status.lock&&!i.status.hide&&E.setTargetSelectChart(i.id,!0)}})},30),g=()=>{m.cancel(),E.setEditCanvas(j.IS_SELECT,!1),E.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",g)};document.addEventListener("mousemove",m),document.addEventListener("mouseup",g)},Kt=()=>({mouseClickHandle:(s,p)=>{var l;if(s.preventDefault(),s.stopPropagation(),!p.status.lock&&(l=window.$KeyboardActive)!=null&&l.ctrl)if(E.targetChart.selectId.includes(p.id)){const m=E.targetChart.selectId.filter(g=>g!==p.id);E.setTargetSelectChart(m)}else E.setTargetSelectChart(p.id,!0)},mousedownHandle:(s,p)=>{var h;if(s.preventDefault(),s.stopPropagation(),p.status.lock||(Mn(),s.buttons===qe.LEFT&&((h=window.$KeyboardActive)==null?void 0:h.ctrl)))return;const l=E.getTargetChart.selectId;if(s.buttons===qe.RIGHT&&l.length>1&&l.includes(p.id)||(E.setTargetSelectChart(p.id),s.buttons===qe.RIGHT))return;const m=E.getEditCanvas.scale,g=E.getEditCanvasConfig.width,v=E.getEditCanvasConfig.height,d=new Map;E.getTargetChart.selectId.forEach(S=>{const M=E.fetchTargetIndex(S);if(M!==-1){const{x:R,y:L,w:G,h:X}=tn(E.getComponentList[M]).attr;d.set(S,{x:R,y:L,w:G,h:X})}});const c=s.screenX,r=s.screenY;let C=[];E.getTargetChart.selectId.forEach(S=>{if(!d.has(S))return;const M=E.fetchTargetIndex(S);C.push(Ue.exports.cloneDeep(E.getComponentList[M]))}),E.setMousePosition(void 0,void 0,c,r);const i=Ue.exports.throttle(S=>{E.setEditCanvas(j.IS_DRAG,!0),E.setMousePosition(S.screenX,S.screenY);let M=(S.screenX-c)/m,R=(S.screenY-r)/m;E.getTargetChart.selectId.forEach(L=>{if(!d.has(L))return;const G=E.fetchTargetIndex(L),{x:X,y:q,w,h:_}=d.get(L),H=E.getComponentList[G];let K=Math.round(X+M),T=Math.round(q+R);const b=50;K=K<-w+b?-w+b:K,T=T<-_+b?-_+b:T,K=K>g-b?g-b:K,T=T>v-b?v-b:T,H&&(H.attr=Object.assign(H.attr,{x:K,y:T}))})},20),y=()=>{try{E.setMousePosition(0,0,0,0),E.setEditCanvas(j.IS_DRAG,!1),C.length&&(E.getTargetChart.selectId.forEach(S=>{if(!d.has(S))return;const M=E.fetchTargetIndex(S),R=E.getComponentList[M];C.forEach(L=>{L.id===S&&(L.attr=Object.assign(L.attr,{offsetX:R.attr.x-L.attr.x,offsetY:R.attr.y-L.attr.y}))})}),E.moveComponentList(C)),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",y)}catch(S){console.log(S)}};document.addEventListener("mousemove",i),document.addEventListener("mouseup",y)},mouseenterHandle:(s,p)=>{s.preventDefault(),s.stopPropagation(),E.getEditCanvas.isSelect||E.setTargetHoverChart(p.id)},mouseleaveHandle:(s,p)=>{s.preventDefault(),s.stopPropagation(),E.setEditCanvas(j.IS_DRAG,!1),E.setTargetHoverChart(void 0)}}),Bn=(e,t,n)=>{e.stopPropagation(),e.preventDefault(),E.setEditCanvas(j.IS_DRAG,!0);const o=E.getEditCanvas.scale,s=n.x,p=n.y,l=n.w,m=n.h,g=e.screenX,v=e.screenY;E.setMousePosition(g,v);const d=Ue.exports.throttle(r=>{E.setMousePosition(r.screenX,r.screenY);let C=Math.round((r.screenX-g)/o),i=Math.round((r.screenY-v)/o);const y=/t/.test(t),h=/b/.test(t),S=/l/.test(t),M=/r/.test(t),R=m+(y?-i:h?i:0),L=l+(S?-C:M?C:0);n.h=R>0?R:0,n.w=L>0?L:0,n.x=s+(S?C:0),n.y=p+(y?i:0)},50),c=()=>{E.setEditCanvas(j.IS_DRAG,!1),E.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",c)};document.addEventListener("mousemove",d),document.addEventListener("mouseup",c)},$e=(e,t)=>e?{zIndex:t+1,left:`${e.x}px`,top:`${e.y}px`}:{},ye=(e,t)=>e?{width:`${t?t*e.w:e.w}px`,height:`${t?t*e.h:e.h}px`}:{},In=(e,t,n,o)=>{const{w:s,h:p}=n,l=/t/.test(e),m=/b/.test(e),g=/l/.test(e),v=/r/.test(e);let d=0,c=0;return e.length===2?(d=g?0:s,c=l?0:p):((l||m)&&(d=s/2,c=l?0:p),(g||v)&&(d=g?0:s,c=Math.floor(p/2))),{left:`${d}px`,top:`${c}px`,cursor:o[t]+"-resize"}};const Hn=["onMousedown"],Pn=ue({__name:"index",props:{item:{type:Object,required:!0},hiddenPoint:{type:Boolean,required:!1}},setup(e){const t=e;ke(c=>({"026d39a0":a(l)}));const n=Fe(),o=re(),s=["t","r","b","l","lt","rt","lb","rb"],p=["n","e","s","w","nw","ne","sw","se"],l=U(()=>n.getAppTheme),m=U(()=>t.item.status.lock?!1:t.item.id===o.getTargetChart.hoverId),g=U(()=>{const c=t.item.id;return t.item.status.lock?!1:o.getTargetChart.selectId.find(r=>r===c)}),v=U(()=>t.item.status.lock),d=U(()=>t.item.status.hide);return(c,r)=>(D(),z("div",{class:de(["go-shape-box",{lock:a(v),hide:a(d)}])},[dt(c.$slots,"default",{},void 0,!0),e.hiddenPoint?Ce("",!0):(D(!0),z(he,{key:0},Ee(a(g)?s:[],(C,i)=>(D(),z("div",{class:de(`shape-point ${C}`),key:i,style:ae(a(In)(C,i,e.item.attr,p)),onMousedown:y=>a(Bn)(y,C,e.item.attr)},null,46,Hn))),128)),W("div",{class:"shape-modal",style:ae(a(ye)(e.item.attr))},[W("div",{class:de(["shape-modal-select",{active:a(g)}])},null,2),W("div",{class:de(["shape-modal-change",{selectActive:a(g),hoverActive:a(m)}])},null,2)],4)],2))}});var rt=ce(Pn,[["__scopeId","data-v-5f8854aa"]]);const Un={class:"go-edit-group-box"},$n=ue({__name:"index",props:{groupData:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){const t=re(),{handleContextMenu:n}=pt(),{mouseenterHandle:o,mouseleaveHandle:s,mousedownHandle:p,mouseClickHandle:l}=Kt(),m=(d,c,r)=>{const C=i=>c.filter(y=>i.includes(y.key));if(t.getTargetChart.selectId.length>1)return C([x.GROUP,x.DELETE]);{const i=[];r.status.lock?i.push(x.LOCK):i.push(x.UNLOCK),r.status.hide?i.push(x.HIDE):i.push(x.SHOW);const y=[x.UN_GROUP];return[...C(y),_n(),...d.filter(h=>!i.includes(h.key))]}},g=U(()=>{const d=t.getEditCanvasConfig.chartThemeColor;return Lt[d]}),v=U(()=>t.getEditCanvasConfig.chartThemeSetting);return(d,c)=>(D(),z("div",Un,[(D(),N(a(rt),{key:e.groupData.id,"data-id":e.groupData.id,index:e.groupIndex,item:e.groupData,hiddenPoint:!0,class:de(a(ot)(e.groupData.styles.animations)),style:ae(P(P(P(P(P({},a($e)(e.groupData.attr,e.groupIndex)),a(ye)(e.groupData.attr)),a(He)(e.groupData.styles)),a(st)(e.groupData.styles)),a(Rt)(e.groupData.styles))),onClick:c[0]||(c[0]=r=>a(l)(r,e.groupData)),onMousedown:c[1]||(c[1]=r=>a(p)(r,e.groupData)),onMouseenter:c[2]||(c[2]=r=>a(o)(r,e.groupData)),onMouseleave:c[3]||(c[3]=r=>a(s)(r,e.groupData)),onContextmenu:c[4]||(c[4]=r=>a(n)(r,e.groupData,m))},{default:A(()=>[(D(!0),z(he,null,Ee(e.groupData.groupList,r=>(D(),N(a(rt),{key:r.id,"data-id":r.id,index:e.groupIndex,item:r,hiddenPoint:!0,style:ae(P({},a($e)(r.attr,e.groupIndex)))},{default:A(()=>[(D(),N(Se(r.chartConfig.chartKey),{class:de(["edit-content-chart",a(ot)(r.styles.animations)]),chartConfig:r,themeSetting:a(v),themeColor:a(g),style:ae(P(P(P({},a(ye)(r.attr)),a(He)(r.styles)),a(st)(r.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","item","style"]))),128))]),_:1},8,["data-id","index","item","class","style"]))]))}});const Nn={class:"go-edit-align-line"},Kn=ue({__name:"index",setup(e){ke(i=>({42514545:a(l)}));const t=Fe(),n=re(),o=ft(),s=Ne({lineArr:["rowt","rowc","rowb","coll","colc","colr"],select:new Map,sorptioned:{x:!1,y:!1}}),p=i=>i?{left:`${i.x?i.x:0}px`,top:`${i.y?i.y:0}px`}:{},l=U(()=>t.getAppTheme),m=U(()=>o.getChartAlignRange),g=U(()=>n.getEditCanvas[j.IS_DRAG]),v=(i,y)=>Math.abs(i-y)<=m.value,d=U(()=>n.getTargetChart.selectId),c=U(()=>n.getComponentList[n.fetchTargetIndex()]),r=U(()=>{var i;return((i=c.value)==null?void 0:i.attr)||{}}),C=U(()=>({id:"0",attr:{w:Ct(n.getEditCanvasConfig.width),h:Ct(n.getEditCanvasConfig.height),x:0,y:0,offsetX:0,offsetY:0,zIndex:0}}));return ve(()=>n.getMousePosition,oe(()=>{try{if(!g.value||d.value.length!==1)return;const i=r.value.w,y=r.value.h,h=r.value.x,S=h+i/2,M=h+i,R=[h,S,M],L=r.value.y,G=L+y/2,X=L+y,q=[L,G,X];s.select.clear(),s.sorptioned.y=!1;const w=n.getComponentList.map(_=>({id:_.id,attr:_.attr}));w.push(C.value),s.lineArr.forEach(_=>{w.forEach(H=>{if(d.value[0]===H.id)return;const K=H.attr.w,T=H.attr.h,b=H.attr.x,u=b+K/2,f=b+K,k=[b,u,f],F=H.attr.y,Y=F+T/2,$=F+T,ie=[F,Y,$];_.includes("rowt")&&(v(L,F)&&(s.select.set(_,{y:F}),V(c.value,h,F)),v(L,Y)&&(s.select.set(_,{y:Y}),V(c.value,h,Y)),v(L,$)&&(s.select.set(_,{y:$}),V(c.value,h,$))),_.includes("rowc")&&(v(G,F)&&(s.select.set(_,{y:F}),V(c.value,h,F-y/2)),v(G,Y)&&(s.select.set(_,{y:Y}),V(c.value,h,Y-y/2)),v(G,$)&&(s.select.set(_,{y:$}),V(c.value,h,$-y/2))),_.includes("rowb")&&(v(X,F)&&(s.select.set(_,{y:F}),V(c.value,h,F-y)),v(X,Y)&&(s.select.set(_,{y:Y}),V(c.value,h,Y-y)),v(X,$)&&(s.select.set(_,{y:$}),V(c.value,h,$-y))),_.includes("coll")&&(v(h,b)&&(s.select.set(_,{x:b}),V(c.value,b,L)),v(h,u)&&(s.select.set(_,{x:u}),V(c.value,u,L)),v(h,f)&&(s.select.set(_,{x:f}),V(c.value,f,L))),_.includes("colc")&&(v(S,b)&&(s.select.set(_,{x:b}),V(c.value,b-i/2,L)),v(S,u)&&(s.select.set(_,{x:u}),V(c.value,u-i/2,L)),v(S,f)&&(s.select.set(_,{x:f}),V(c.value,f-i/2,L))),_.includes("colr")&&(v(M,b)&&(s.select.set(_,{x:b}),V(c.value,b-i,L)),v(M,u)&&(s.select.set(_,{x:u}),V(c.value,u-i,L)),v(M,f)&&(s.select.set(_,{x:f}),V(c.value,f-i,L)))})})}catch(i){console.log(i)}},200),{deep:!0}),ve(()=>g.value,i=>{i||(s.select.clear(),s.sorptioned.y=!1)}),(i,y)=>(D(),z("div",Nn,[(D(!0),z(he,null,Ee(s.lineArr,h=>(D(),z("div",{class:de(["line",[h.includes("row")?"row":"col",s.select.has(h)&&"visible"]]),key:h,style:ae(p(s.select.get(h)))},null,6))),128))]))}});var Gn=ce(Kn,[["__scopeId","data-v-403a9eed"]]);const Yn=ue({__name:"index",setup(e){return(t,n)=>{const o=I("n-watermark");return D(),N(o,{id:"go-edit-watermark",content:a(nn),cross:"",selectable:"","font-size":16,"line-height":16,width:500,height:150,"x-offset":12,"y-offset":80,rotate:-15},null,8,["content"])}}});var Xn=ce(Yn,[["__scopeId","data-v-e5cd93da"]]);const Gt=e=>(Bt("data-v-71d41248"),e=e(),It(),e),Wn=Gt(()=>W("div",{class:"select-background"},null,-1)),zn=Gt(()=>W("div",{class:"select-border"},null,-1)),Vn=[Wn,zn],qn=ue({__name:"index",setup(e){ke(m=>({c29aca42:a(p)}));const t=Fe(),n=re(),{isSelect:o,scale:s}=Ke(n.getEditCanvas),p=U(()=>t.getAppTheme),l=Z();return ve(()=>n.getMousePosition,m=>{if(!o.value)return;const{startX:g,startY:v,x:d,y:c}=m,r={zIndex:yt,x:0,y:0,w:0,h:0,offsetX:0,offsetY:0};d>g&&c>v?(r.x=g,r.y=v,r.w=Math.round((d-g)/s.value),r.h=Math.round((c-v)/s.value)):d>g&&c<v?(r.x=g,r.w=Math.round((d-g)/s.value),r.h=Math.round((v-c)/s.value),r.y=v-r.h):d<g&&c>v?(r.y=v,r.w=Math.round((g-d)/s.value),r.h=Math.round((c-v)/s.value),r.x=g-r.w):(r.w=Math.round((g-d)/s.value),r.h=Math.round((v-c)/s.value),r.x=g-r.w,r.y=v-r.h),l.value=P(P({},$e(r,yt)),ye(r))},{deep:!0}),(m,g)=>a(o)?(D(),z("div",{key:0,class:"go-edit-select",style:ae(l.value)},Vn,4)):Ce("",!0)}});var Jn=ce(qn,[["__scopeId","data-v-71d41248"]]);const Qn=ue({__name:"index",setup(e){const t=re(),{getEditCanvasConfig:n,getEditCanvas:o}=Ke(t),s=U(()=>({w:n.value.width,h:n.value.height})),p=U(()=>{const m={transform:`scale(${o.value.scale})`};return P(P({},ye(s.value)),m)}),l=U(()=>{const m=o.value.isCreate&&{"z-index":99999};return P(P({},ye(s.value)),m)});return(m,g)=>(D(),z("div",{class:"go-edit-range go-transition",style:ae(a(p)),onMousedown:g[0]||(g[0]=v=>a(Rn)(v,void 0))},[dt(m.$slots,"default",{},void 0,!0),O(a(Xn)),O(a(Gn)),O(a(Jn)),W("div",{class:"go-edit-range-model",style:ae(a(l))},null,4)],36))}});var Zn=ce(Qn,[["__scopeId","data-v-52e445d0"]]),Yt=!!(typeof window!="undefined"&&window.document&&window.document.createElement),ut=!1,ct=!1;try{var et={get passive(){return ut=!0},get once(){return ct=ut=!0}};Yt&&(window.addEventListener("test",et,et),window.removeEventListener("test",et,!0))}catch(e){}function jn(e,t,n,o){if(o&&typeof o!="boolean"&&!ct){var s=o.once,p=o.capture,l=n;!ct&&s&&(l=n.__once||function m(g){this.removeEventListener(t,m,p),n.call(this,g)},n.__once=l),e.addEventListener(t,l,ut?o:p)}e.addEventListener(t,n,o)}function eo(e,t,n,o){var s=o&&typeof o!="boolean"?o.capture:o;e.removeEventListener(t,n,s),n.__once&&e.removeEventListener(t,n.__once,s)}function Tt(e,t,n,o){return jn(e,t,n,o),function(){eo(e,t,n,o)}}var xt=new Date().getTime();function to(e){var t=new Date().getTime(),n=Math.max(0,16-(t-xt)),o=setTimeout(e,n);return xt=t,o}var no=["","webkit","moz","o","ms"],At=to,Dt=function(t,n){return t+(t?n[0].toUpperCase()+n.substr(1):n)+"AnimationFrame"};Yt&&no.some(function(e){var t=Dt(e,"request");return t in window&&(Dt(e,"cancel"),At=function(o){return window[t](o)}),!!At});Function.prototype.bind.call(Function.prototype.call,[].slice);Function.prototype.bind.call(Function.prototype.call,[].slice);const oo={class:"go-sketch-rule"},so={key:1,class:"fix-edit-screens-block"},ao=ue({__name:"index",setup(e){ke(T=>({"027e6d17":a(G),"66707d7c":a(R),"2846119e":r.value}));const t=re(),n=Ut(),o=Fe(),s=20;let p=[0,0],l=[0,0];const m=Z(),g=Z(!0),v=Z(),d=Z(),c=Z(!1),r=Z("auto"),{width:C,height:i}=Ke(t.getEditCanvasConfig),y=Z(0),h=Z(0),S=Ne({h:[],v:[]}),M=U(()=>t.getEditCanvas.scale),R=U(()=>`${i.value*2}px`),L=U(()=>o.getDarkTheme?{bgColor:"#18181c",longfgColor:"#4d4d4d",shortfgColor:"#4d4d4d",fontColor:"#4d4d4d",shadowColor:"#18181c",borderColor:"#18181c",cornerActiveColor:"#18181c"}:{}),G=U(()=>o.getAppTheme),X=T=>{if(T.ctrlKey||T.metaKey){T.preventDefault();let b=M.value;if(T.wheelDelta>=0&&M.value<2){b=M.value+.05,t.setScale(b);return}T.wheelDelta<0&&M.value>.1&&(b=M.value-.05,t.setScale(b))}},q=()=>{if(!m.value)return;const T=m.value.getBoundingClientRect(),b=v.value.getBoundingClientRect();y.value=(T.left+s-b.left)/M.value,h.value=(T.top+s-b.top)/M.value},w=T=>{var F,Y;if(T.preventDefault(),T.stopPropagation(),T.which==2)c.value=!0;else if(!((F=window.$KeyboardActive)!=null&&F.space))return;(Y=document.activeElement)==null||Y.blur();const b=T.pageX,u=T.pageY,f=Tt(window,"mousemove",$=>{const ie=$.pageX-b,Te=$.pageY-u,[Ge,Le]=p,[Ye,Oe]=l;p=[Le,ie],l=[Oe,Te],m.value.scrollLeft-=Le>Ge?Math.abs(Le-Ge):-Math.abs(Le-Ge),m.value.scrollTop-=Oe>Ye?Math.abs(Oe-Ye):-Math.abs(Oe-Ye)}),k=Tt(window,"mouseup",()=>{f(),k(),p=[0,0],l=[0,0],c.value=!1})},_=()=>{const T=document.getElementById("go-chart-edit-layout");return T?{height:T.clientHeight-25,width:T.clientWidth}:{width:C.value,height:i.value}},H=()=>{g.value=!1,setTimeout(()=>{g.value=!0},10)},K=()=>{const{width:T,height:b}=d.value.getBoundingClientRect(),{width:u,height:f}=_();m.value.scrollLeft=T/2-u/2,m.value.scrollTop=b/2-f/2};return ve(()=>o.getDarkTheme,()=>{H()}),ve(()=>M.value,(T,b)=>{b!==T&&n.getRePositionCanvas?(n.setItemUnHandle(at.RE_POSITION_CANVAS,!1),q(),setTimeout(()=>{K(),H()},400)):oe(H,20)}),ve(()=>c.value,T=>{r.value=T?"grab":"auto"}),lt(()=>{m.value&&(m.value.addEventListener("wheel",X,{passive:!1}),K())}),Ot(()=>{m.value&&m.value.removeEventListener("wheel",X)}),window.onKeySpacePressHold=T=>{c.value=T},(T,b)=>{const u=I("sketch-rule");return D(),z("div",oo,[g.value?(D(),N(u,{key:0,thick:s,scale:a(M),width:_().width,height:_().height,startX:y.value,startY:h.value,lines:S,palette:a(L)},null,8,["scale","width","height","startX","startY","lines","palette"])):Ce("",!0),W("div",{ref_key:"$app",ref:m,class:"edit-screens",onScroll:q},[W("div",{ref_key:"$container",ref:d,class:"edit-screen-container",style:ae({width:a(C)*2+"px"})},[W("div",{ref_key:"refSketchRuleBox",ref:v,class:"canvas",onMousedown:w,style:ae({marginLeft:"-"+(_().width/2-25)+"px"})},[W("div",{style:ae({pointerEvents:c.value?"none":"auto"})},[dt(T.$slots,"default",{},void 0,!0)],4)],36)],4)],544),a(o).getDarkTheme?(D(),z("div",so)):Ce("",!0)])}}});var ro=ce(ao,[["__scopeId","data-v-9b7f266a"]]);const tt={[B.ADD]:"\u65B0\u589E",[B.DELETE]:"\u5220\u9664",[B.UPDATE]:"\u66F4\u65B0",[B.MOVE]:"\u79FB\u52A8",[B.PASTE]:"\u7C98\u8D34",[B.COPY]:"\u590D\u5236",[B.CUT]:"\u526A\u5207",[B.TOP]:"\u7F6E\u9876",[B.BOTTOM]:"\u7F6E\u5E95",[B.UP]:"\u4E0A\u79FB",[B.DOWN]:"\u4E0B\u79FB",[B.GROUP]:"\u6210\u7EC4",[B.UN_GROUP]:"\u89E3\u7EC4",[B.LOCK]:"\u9501\u5B9A",[B.UNLOCK]:"\u89E3\u9501",[B.HIDE]:"\u9690\u85CF",[B.SHOW]:"\u663E\u793A",[Ie.CANVAS]:"\u753B\u5E03\u521D\u59CB\u5316"};var uo=Array.prototype,co=uo.reverse;function io(e){return e==null?e:co.call(e)}var lo=io;const Xt=e=>(Bt("data-v-5a4fd660"),e=e(),It(),e),fo={class:"go-flex-items-center"},po=Xt(()=>W("span",{class:"btn-text"},"\u5386\u53F2\u8BB0\u5F55",-1)),vo={class:"history-list-box"},ho=["title"],go=Xt(()=>W("div",{class:"popover-modal"},null,-1)),_o=ue({__name:"index",setup(e){const{DesktopOutlineIcon:t,PencilIcon:n,TrashIcon:o,CopyIcon:s,LayersIcon:p,DuplicateIcon:l,HelpOutlineIcon:m,LockClosedOutlineIcon:g,LockOpenOutlineIcon:v,EyeOffOutlineIcon:d,EyeOutlineIcon:c}=De.ionicons5,{StackedMoveIcon:r,Carbon3DCursorIcon:C,Carbon3DSoftwareIcon:i}=De.carbon,y=Ft(),h=R=>{if(R.targetType===Ie.CANVAS)return t;switch(R.actionType){case B.UPDATE:return n;case B.DELETE:return o;case B.PASTE:return s;case B.TOP:return p;case B.BOTTOM:return p;case B.UP:return p;case B.DOWN:return p;case B.MOVE:return r;case B.ADD:return l;case B.GROUP:return C;case B.UN_GROUP:return i;case B.LOCK:return g;case B.UNLOCK:return v;case B.HIDE:return d;case B.SHOW:return c;default:return n}},S=R=>{if(R.targetType===Ie.CANVAS)return tt[Ie.CANVAS];if(R.actionType===B.GROUP||R.actionType===B.UN_GROUP)return`${tt[R.actionType]}`;if(R.historyData.length)return`${tt[R.actionType]} - ${R.historyData[0].chartConfig.title}`},M=U(()=>{const L=y.getBackStack.map(G=>({label:S(G),icon:h(G)}));return lo(L.filter(G=>G.label))});return(R,L)=>{const G=I("n-button"),X=I("n-icon"),q=I("n-text"),w=I("n-scrollbar"),_=I("n-popover"),H=I("n-tooltip");return D(),z("div",fo,[O(_,{class:"edit-history-popover","show-arrow":!1,size:"small",trigger:"click",placement:"top-start"},{trigger:A(()=>[O(G,{class:"mr-10",secondary:"",size:"small",disabled:a(M).length===0},{default:A(()=>[po]),_:1},8,["disabled"])]),default:A(()=>[W("div",vo,[O(w,{style:{"max-height":"500px"}},{default:A(()=>[(D(!0),z(he,null,Ee(a(M),(K,T)=>(D(),z("div",{class:"list-item go-flex-items-center go-ellipsis-1",key:T,title:K.label},[O(X,{class:"item-icon",size:"16",depth:2,component:K.icon},null,8,["component"]),O(q,{depth:"2"},{default:A(()=>[we(pe(K.label),1)]),_:2},1024)],8,ho))),128))]),_:1}),go])]),_:1}),O(H,{trigger:"hover"},{trigger:A(()=>[O(X,{size:"21",depth:3},{default:A(()=>[O(a(m))]),_:1})]),default:A(()=>[W("span",null,"\u6700\u591A\u53EA\u4FDD\u7559"+pe(a(on))+"\u6761\u8BB0\u5F55",1)]),_:1})])}}});var mo=ce(_o,[["__scopeId","data-v-5a4fd660"]]);const Co={class:"go-edit-bottom"},yo=ue({__name:"index",setup(e){ke(h=>({f3add9fc:s.value}));const{LockClosedOutlineIcon:t,LockOpenOutlineIcon:n}=De.ionicons5,o=Fe(),s=Z(o.getAppTheme),p=re(),{lockScale:l,scale:m}=Ke(p.getEditCanvas);let g=[{label:"200%",value:200},{label:"150%",value:150},{label:"100%",value:100},{label:"50%",value:50},{label:"\u81EA\u9002\u5E94",value:0}];const v=Z(""),d=h=>{if(h===0){p.computedScale();return}p.setScale(h/100)},c=()=>{p.setEditCanvas(j.LOCK_SCALE,!l.value)},r=Z(100),C=h=>`${h}%`,i=h=>{p.setScale(h/100)},y=Ne({100:""});return sn(()=>{const h=(m.value*100).toFixed(0);v.value=`${h}%`,r.value=parseInt(h)}),(h,S)=>{const M=I("n-text"),R=I("n-space"),L=I("n-select"),G=I("n-icon"),X=I("n-button"),q=I("n-tooltip"),w=I("n-slider");return D(),z("div",Co,[O(R,null,{default:A(()=>[O(a(mo)),O(M,{id:"keyboard-dress-show",depth:"3"})]),_:1}),O(R,{class:"bottom-ri"},{default:A(()=>[O(Tn),O(L,{disabled:a(l),class:"scale-btn",value:v.value,"onUpdate:value":[S[0]||(S[0]=_=>v.value=_),d],size:"mini",options:a(g)},null,8,["disabled","value","options"]),O(q,{trigger:"hover"},{trigger:A(()=>[O(X,{onClick:c,text:""},{default:A(()=>[O(G,{class:de(["lock-icon",{color:a(l)}]),size:"18",depth:2},{default:A(()=>[a(l)?(D(),N(a(t),{key:0})):(D(),N(a(n),{key:1}))]),_:1},8,["class"])]),_:1})]),default:A(()=>[W("span",null,pe(a(l)?"\u89E3\u9501":"\u9501\u5B9A")+"\u5F53\u524D\u6BD4\u4F8B",1)]),_:1}),O(w,{class:"scale-slider",value:r.value,"onUpdate:value":[S[1]||(S[1]=_=>r.value=_),i],"default-value":50,min:10,max:200,step:5,"format-tooltip":C,disabled:a(l),marks:y},null,8,["value","disabled","marks"])]),_:1})])}}});var Eo=ce(yo,[["__scopeId","data-v-99a534fc"]]);const So=ue({__name:"index",props:{modelShow:Boolean},emits:["update:modelShow"],setup(e,{emit:t}){const n=e,{HelpOutlineIcon:o,CloseIcon:s}=De.ionicons5,p=ft(),l=Z(!1),m=Ne([{key:ge.ASIDE_ALL_COLLAPSED,value:p.getAsideAllCollapsed,type:"switch",name:"\u83DC\u5355\u6298\u53E0",desc:"\u9996\u9875\u83DC\u5355\u6298\u53E0\u65F6\u9690\u85CF\u81F3\u754C\u9762\u5916"},{key:ge.HIDE_PACKAGE_ONE_CATEGORY,value:p.getHidePackageOneCategory,type:"switch",name:"\u9690\u85CF\u5206\u7C7B",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u8868\u5355\u5206\u7C7B\u53EA\u6709\u5355\u9879\u65F6\u9690\u85CF"},{key:ge.CHANGE_LANG_RELOAD,value:p.getChangeLangReload,type:"switch",name:"\u5207\u6362\u8BED\u8A00",desc:"\u5207\u6362\u8BED\u8A00\u91CD\u65B0\u52A0\u8F7D\u9875\u9762",tip:"\u82E5\u9047\u5230\u90E8\u5206\u533A\u57DF\u8BED\u8A00\u5207\u6362\u5931\u8D25\uFF0C\u5219\u5EFA\u8BAE\u5F00\u542F"},{key:"divider1",type:"divider",name:"",desc:"",value:""},{key:ge.CHART_TOOLS_STATUS_HIDE,value:p.getChartToolsStatusHide,type:"switch",name:"\u9690\u85CF\u5DE5\u5177\u680F",desc:"\u9F20\u6807\u79FB\u5165\u65F6\uFF0C\u4F1A\u5C55\u793A\u5207\u6362\u5230\u5C55\u5F00\u6A21\u5F0F"},{key:ge.CHART_TOOLS_STATUS,value:p.getChartToolsStatus,type:"select",name:"\u5DE5\u5177\u680F\u5C55\u793A",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u5DE5\u5177\u680F\u5C55\u793A\u65B9\u5F0F",options:[{label:"\u4FA7\u8FB9\u680F",value:Pe.ASIDE},{label:"\u5E95\u90E8 Dock",value:Pe.DOCK}]},{key:"divider0",type:"divider",name:"",desc:"",value:""},{key:ge.CHART_MOVE_DISTANCE,value:p.getChartMoveDistance,type:"number",name:"\u79FB\u52A8\u8DDD\u79BB",min:1,step:1,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u65B9\u5411\u952E\u63A7\u5236\u79FB\u52A8\u8DDD\u79BB"},{key:ge.CHART_ALIGN_RANGE,value:p.getChartAlignRange,type:"number",name:"\u5438\u9644\u8DDD\u79BB",min:10,step:2,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u79FB\u52A8\u56FE\u8868\u65F6\u7684\u5438\u9644\u8DDD\u79BB"}]);ve(()=>n.modelShow,d=>{l.value=d});const g=()=>{t("update:modelShow",!1)},v=(d,c)=>{p.setItem(c.key,c.value)};return(d,c)=>{const r=I("n-h3"),C=I("n-icon"),i=I("n-space"),y=I("n-divider"),h=I("n-text"),S=I("n-switch"),M=I("n-input-number"),R=I("n-select"),L=I("n-tooltip"),G=I("n-list-item"),X=I("n-list"),q=I("n-modal");return D(),N(q,{show:l.value,"onUpdate:show":c[0]||(c[0]=w=>l.value=w),onAfterLeave:g},{default:A(()=>[O(X,{bordered:"",class:"go-system-setting"},{header:A(()=>[O(i,{justify:"space-between"},{default:A(()=>[O(r,{class:"go-mb-0"},{default:A(()=>[we("\u7CFB\u7EDF\u8BBE\u7F6E")]),_:1}),O(C,{size:"20",class:"go-cursor-pointer",onClick:g},{default:A(()=>[O(a(s))]),_:1})]),_:1})]),default:A(()=>[(D(!0),z(he,null,Ee(m,w=>(D(),N(G,{key:w.key},{default:A(()=>[w.type==="divider"?(D(),N(y,{key:0,style:{margin:"0"}})):(D(),N(i,{key:1,size:40},{default:A(()=>[O(i,null,{default:A(()=>[O(h,{class:"item-left"},{default:A(()=>[we(pe(w.name),1)]),_:2},1024),w.type==="switch"?(D(),N(S,{key:0,value:w.value,"onUpdate:value":[_=>w.value=_,_=>v(_,w)],size:"small"},null,8,["value","onUpdate:value"])):w.type==="number"?(D(),N(M,{key:1,value:w.value,"onUpdate:value":[_=>w.value=_,_=>v(_,w)],class:"input-num-width",size:"small",step:w.step||null,suffix:w.suffix||null,min:w.min||0},null,8,["value","onUpdate:value","step","suffix","min"])):w.type==="select"?(D(),N(R,{key:2,class:"select-min-width",value:w.value,"onUpdate:value":[_=>w.value=_,_=>v(_,w)],size:"small",options:w.options},null,8,["value","onUpdate:value","options"])):Ce("",!0)]),_:2},1024),O(i,null,{default:A(()=>[O(h,{class:"item-right"},{default:A(()=>[we(pe(w.desc),1)]),_:2},1024),w.tip?(D(),N(L,{key:0,trigger:"hover"},{trigger:A(()=>[O(C,{size:"21"},{default:A(()=>[O(a(o))]),_:1})]),default:A(()=>[W("span",null,pe(w.tip),1)]),_:2},1024)):Ce("",!0)]),_:2},1024)]),_:2},1024))]),_:2},1024))),128))]),_:1})]),_:1},8,["show"])}}});var wo=ce(So,[["__scopeId","data-v-7cea0aa5"]]);const Ae=re(),To=()=>{Ae.setTargetSelectChart(void 0),an(rn(Ae.getStorageInfo||[]),void 0,"json");const e=document.querySelector(".go-edit-range"),t=document.getElementById("go-edit-watermark");if(!e||!t){window.$message.error("\u5BFC\u51FA\u5931\u8D25\uFF01");return}const n=Ae.getEditCanvas.scale;Ae.setScale(1,!0),t.style.display="block",setTimeout(()=>{un(e,()=>{t&&(t.style.display="none"),Ae.setScale(n,!0)})},600)};var it=(e=>(e.TXT="text/plain",e.JSON="application/json",e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e))(it||{});const xo=()=>{const e=Z(),{updateComponent:t}=vt();return{importUploadFileListRef:e,importBeforeUpload:({file:s})=>{e.value=[];const p=s.file.type;return p!==it.JSON&&p!==it.TXT?(window.$message.warning("\u4EC5\u652F\u6301\u4E0A\u4F20 \u3010JSON\u3011 \u683C\u5F0F\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20\uFF01"),!1):!0},importCustomRequest:s=>{const{file:p}=s;cn(()=>{p.file?ln(p.file).then(l=>{Sn({message:"\u8BF7\u9009\u62E9\u5BFC\u5165\u65B9\u5F0F:",positiveText:"\u65B0\u589E\uFF08\u53EF\u64A4\u56DE\uFF09",negativeText:"\u8986\u76D6\uFF08\u4E0D\u53EF\u64A4\u56DE\uFF09",negativeButtonProps:{type:"info",ghost:!1},onPositiveCallback:()=>le(void 0,null,function*(){try{l=nt(l),yield t(l,!1,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(m){console.log(m),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}}),onNegativeCallback:()=>le(void 0,null,function*(){try{l=nt(l),yield t(l,!0,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(m){console.log(m),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}})})}):window.$message.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6216\u8054\u7CFB\u7BA1\u7406\u5458\uFF01")})}}},{updateComponent:Ao,dataSyncUpdate:kt}=vt(),Do=re(),ko=()=>{const e=p=>Ao(p.detail,!0,!1),t=()=>le(void 0,null,function*(){kt&&(yield kt()),dispatchEvent(new CustomEvent(Je.CHART,{detail:Do.getStorageInfo}))}),n=()=>{addEventListener("blur",t),addEventListener(Je.JSON,e)},o=()=>{removeEventListener(Je.JSON,e),removeEventListener("blur",t)};return(p,l)=>{l==Et.CHART_HOME_NAME&&o(),p==Et.CHART_HOME_NAME&&n()}},Fo=()=>{const e=Ht();ve(()=>e.name,ko(),{immediate:!0})};var me=(e=>(e.BUTTON="button",e.IMPORTUPLOAD="importUpload",e))(me||{});const Lo={class:"btn-item"},Oo=ue({__name:"index",setup(e){const{DownloadIcon:t,ShareIcon:n,PawIcon:o,SettingsSharpIcon:s,CreateIcon:p}=De.ionicons5,l=ft(),m=re();Ht(),Fo();let g=null;const v=Z(!1),d=Z(!0),c=Z(!0),{importUploadFileListRef:r,importCustomRequest:C,importBeforeUpload:i}=xo(),y=U(()=>l.getChartToolsStatus===Pe.ASIDE),h=U(()=>l.getChartToolsStatusHide),S=U(()=>d.value&&h.value),M=U(()=>{if(!y.value)return q;const w=[];return q.map(_=>{w.unshift(_)}),w}),R=()=>{g=setTimeout(()=>{d.value&&(d.value=!1,c.value=!0)},200),setTimeout(()=>{c.value=!1},400)},L=()=>{clearTimeout(g),d.value||(d.value=!0)},G=()=>{window.$message.warning("\u5C06\u5F00\u542F\u5931\u7126\u66F4\u65B0\uFF01"),setTimeout(()=>{const w=fn(pn.CHART_EDIT_NAME,"href");if(!w)return;const _=vn();X(_),hn(w,[_],void 0,!0)},1e3)},X=w=>{const _=m.getStorageInfo,H=gn(be.GO_CHART_STORAGE_LIST)||[];if(H!=null&&H.length){const K=H.findIndex(T=>T.id===w);K!==-1?(H.splice(K,1,fe(P({},_),{id:w})),je(be.GO_CHART_STORAGE_LIST,H)):(H.push(fe(P({},_),{id:w})),je(be.GO_CHART_STORAGE_LIST,H))}else je(be.GO_CHART_STORAGE_LIST,[fe(P({},_),{id:w})])},q=[{key:"import",type:me.IMPORTUPLOAD,name:"\u5BFC\u5165",icon:n},{key:"export",type:me.BUTTON,name:"\u5BFC\u51FA",icon:t,handle:To},{key:"edit",type:me.BUTTON,name:"\u7F16\u8F91",icon:p,handle:G},{key:"setting",type:me.BUTTON,name:"\u8BBE\u7F6E",icon:s,handle:()=>{v.value=!0}}];return(w,_)=>{const H=I("n-icon"),K=I("n-text"),T=I("n-button"),b=I("n-upload"),u=I("n-tooltip");return D(),z(he,null,[W("div",{class:de(["go-chart-edit-tools",[a(l).getChartToolsStatus,a(S)?"isMini":"unMini"]]),onClick:_[1]||(_[1]=f=>d.value&&(d.value=!1)),onMouseenter:R,onMouseleave:L},[Qe(O(H,{class:"asideLogo",size:"22"},{default:A(()=>[O(a(o))]),_:1},512),[[Ze,a(l).getChartToolsStatus===a(Pe).ASIDE&&a(S)]]),(D(!0),z(he,null,Ee(a(M),(f,k)=>(D(),N(u,{key:f.key,disabled:!a(y)||a(h)&&c.value,trigger:"hover",placement:"left"},{trigger:A(()=>[W("div",Lo,[f.type===a(me).BUTTON?(D(),N(T,{key:0,circle:a(y),secondary:"",onClick:f.handle},{icon:A(()=>[a(y)?(D(),N(H,{key:0,size:"22"},{default:A(()=>[(D(),N(Se(f.icon)))]),_:2},1024)):(D(),N(Se(f.icon),{key:1}))]),default:A(()=>[Qe(O(K,{depth:"3"},{default:A(()=>[we(pe(f.name),1)]),_:2},1536),[[Ze,!a(y)]])]),_:2},1032,["circle","onClick"])):f.type===a(me).IMPORTUPLOAD?(D(),N(b,{key:1,"file-list":a(r),"onUpdate:fileList":_[0]||(_[0]=F=>dn(r)?r.value=F:null),"show-file-list":!1,customRequest:a(C),onBeforeUpload:a(i)},{default:A(()=>[O(T,{circle:a(y),secondary:""},{icon:A(()=>[a(y)?(D(),N(H,{key:0,size:"22"},{default:A(()=>[(D(),N(Se(f.icon)))]),_:2},1024)):(D(),N(Se(f.icon),{key:1}))]),default:A(()=>[Qe(O(K,{depth:"3"},{default:A(()=>[we(pe(f.name),1)]),_:2},1536),[[Ze,!a(y)]])]),_:2},1032,["circle"])]),_:2},1032,["file-list","customRequest","onBeforeUpload"])):Ce("",!0)])]),default:A(()=>[W("span",null,pe(f.name),1)]),_:2},1032,["disabled"]))),128))],34),O(a(wo),{modelShow:v.value,"onUpdate:modelShow":_[2]||(_[2]=f=>v.value=f)},null,8,["modelShow"])],64)}}});var Mo=ce(Oo,[["__scopeId","data-v-4c257f27"]]);const bo=ue({__name:"index",setup(e){const t=re(),{handleContextMenu:n}=pt(),{dataSyncFetch:o}=vt();xn();const{mouseenterHandle:s,mouseleaveHandle:p,mousedownHandle:l,mouseClickHandle:m}=Kt(),g=(r,C,i)=>{if(t.getTargetChart.selectId.length>1)return C.filter(h=>[x.GROUP,x.DELETE].includes(h.key));const y=[];return i.status.lock?y.push(x.LOCK):y.push(x.UNLOCK),i.status.hide?y.push(x.HIDE):y.push(x.SHOW),r.filter(h=>!y.includes(h.key))},v=U(()=>t.getEditCanvasConfig.chartThemeSetting),d=U(()=>{const r=t.getEditCanvasConfig.chartThemeColor;return Lt[r]});U(()=>t.getEditCanvasConfig.filterShow);const c=U(()=>{const r=t.getEditCanvasConfig.background,C=t.getEditCanvasConfig.backgroundImage,h=t.getEditCanvasConfig.selectColor?{background:r||void 0}:{background:`url(${C}) no-repeat center center / cover !important`};return fe(P({},h),{width:"inherit",height:"inherit"})});return lt(()=>{Fn(),o()}),(r,C)=>(D(),N(a(wn),{id:"go-chart-edit-layout",flex:!0,showTop:!1,showBottom:!0,depth:1,xScroll:!0,disabledScroll:!0,onMousedown:a(Nt),onDrop:a(bn),onDragover:a(wt),onDragenter:a(wt)},{aside:A(()=>[O(a(Mo))]),bottom:A(()=>[O(a(Eo))]),default:A(()=>[O(a(ro),null,{default:A(()=>[W("div",{id:"go-chart-edit-content",onContextmenu:C[0]||(C[0]=(...i)=>a(n)&&a(n)(...i))},[O(a(Zn),null,{default:A(()=>[W("div",{style:ae(P(P({},a(He)(a(t).getEditCanvasConfig)),a(c)))},[(D(!0),z(he,null,Ee(a(t).getComponentList,(i,y)=>(D(),z("div",{key:i.id},[i.isGroup?(D(),N(a($n),{key:0,groupData:i,groupIndex:y},null,8,["groupData","groupIndex"])):(D(),N(a(rt),{key:1,"data-id":i.id,index:y,style:ae(P(P({},a($e)(i.attr,y)),a(Rt)(i.styles))),item:i,onClick:h=>a(m)(h,i),onMousedown:h=>a(l)(h,i),onMouseenter:h=>a(s)(h,i),onMouseleave:h=>a(p)(h,i),onContextmenu:h=>a(n)(h,i,g)},{default:A(()=>[(D(),N(Se(i.chartConfig.chartKey),{class:de(["edit-content-chart",a(ot)(i.styles.animations)]),chartConfig:i,themeSetting:a(v),themeColor:a(d),style:ae(P(P(P({},a(ye)(i.attr)),a(He)(i.styles)),a(st)(i.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","style","item","onClick","onMousedown","onMouseenter","onMouseleave","onContextmenu"]))]))),128))],4)]),_:1})],32)]),_:1})]),_:1},8,["onMousedown","onDrop","onDragover","onDragenter"]))}});var qo=ce(bo,[["__scopeId","data-v-71b3d0ba"]]);export{qo as default};
