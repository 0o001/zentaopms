var It=Object.defineProperty,Ht=Object.defineProperties;var Pt=Object.getOwnPropertyDescriptors;var ct=Object.getOwnPropertySymbols;var $t=Object.prototype.hasOwnProperty,Ut=Object.prototype.propertyIsEnumerable;var lt=(e,n,t)=>n in e?It(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Y=(e,n)=>{for(var t in n||(n={}))$t.call(n,t)&&lt(e,t,n[t]);if(ct)for(var t of ct(n))Ut.call(n,t)&&lt(e,t,n[t]);return e},we=(e,n)=>Ht(e,Pt(n));var Se=(e,n,t)=>new Promise((o,s)=>{var g=C=>{try{w(t.next(C))}catch(f){s(f)}},c=C=>{try{w(t.throw(C))}catch(f){s(f)}},w=C=>C.done?o(C.value):Promise.resolve(C.value).then(g,c);w((t=t.apply(e,n)).next())});import{u as re,E as ae,t as se,A as Ke,B as Nt,z as Kt,D as Re,G as Yt,J as Ee,d as Et,K as Ie,g as Gt,h as Xt,M as I,O as Be,a as Wt,b as wt,Q as zt,F as qt,R as jt,e as Jt}from"./useSync.hook-a181ea44.js";import{x as ot,a6 as St,b3 as Vt,aj as A,c5 as Tt,c6 as xt,cl as it,ck as Qt,c3 as Ve,cm as q,ca as Ye,ak as Zt,d as ue,bJ as Ae,u as ke,a5 as $,o as D,h as z,j as at,F as ve,A as me,ad as ie,aP as oe,f as d,a9 as fe,z as W,p as ce,c as N,w as k,L as Ce,bU as Qe,bV as He,bW as Ze,bX as Dt,a4 as rt,y as $e,al as dt,R as pe,r as H,cn as en,a3 as Ue,q as Q,co as ft,H as At,I as kt,e as M,m as ye,t as de,aI as tn,aS as nn,cp as ge,cq as Pe,cr as sn,c2 as on,cs as an,am as rn,ct as un,J as Ft,Q as pt,b$ as Ge,X as Xe,Y as We,bS as cn,V as ln,cu as dn,cv as fn,W as pn,aO as vn,S as Oe,c0 as ze}from"./index.js";import{u as ut,d as hn}from"./index-334fdcb7.js";import{a as gn,b as vt,l as _n,g as mn}from"./plugin-6aef7162.js";import{C as Cn}from"./index-ba2d39a2.js";import{i as De}from"./icon-0e07ccce.js";import{E as yn}from"./index-4f2ae401.js";import"./tables_list-38e71280.js";import"./index-c776e10b.js";import"./index-75342b33.js";const Te=re(),En=()=>{ot(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,document.getElementById("go-chart-edit-layout")),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,document.getElementById("go-chart-edit-content"));const e=Te.listenerScale();St(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,null),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,null),e()})})};var bt={exports:{}};(function(e){(function(n){var t,o={},s={16:!1,18:!1,17:!1,91:!1},g="all",c={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},w={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},C=function(r){return w[r]||r.toUpperCase().charCodeAt(0)},f=[];for(t=1;t<20;t++)w["f"+t]=111+t;function _(r,i){for(var F=r.length;F--;)if(r[F]===i)return F;return-1}function p(r,i){if(r.length!=i.length)return!1;for(var F=0;F<r.length;F++)if(r[F]!==i[F])return!1;return!0}var u={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function S(r){for(t in s)s[t]=r[u[t]]}function m(r){var i,F,O,G,K,le;if(i=r.keyCode,_(f,i)==-1&&f.push(i),(i==93||i==224)&&(i=91),i in s){s[i]=!0;for(O in c)c[O]==i&&(a[O]=!0);return}if(S(r),!!a.filter.call(this,r)&&i in o){for(le=j(),G=0;G<o[i].length;G++)if(F=o[i][G],F.scope==le||F.scope=="all"){K=F.mods.length>0;for(O in s)(!s[O]&&_(F.mods,+O)>-1||s[O]&&_(F.mods,+O)==-1)&&(K=!1);(F.mods.length==0&&!s[16]&&!s[18]&&!s[17]&&!s[91]||K)&&F.method(r,F)===!1&&(r.preventDefault?r.preventDefault():r.returnValue=!1,r.stopPropagation&&r.stopPropagation(),r.cancelBubble&&(r.cancelBubble=!0))}}}function h(r){var i=r.keyCode,F,O=_(f,i);if(O>=0&&f.splice(O,1),(i==93||i==224)&&(i=91),i in s){s[i]=!1;for(F in c)c[F]==i&&(a[F]=!1)}}function v(){for(t in s)s[t]=!1;for(t in c)a[t]=!1}function a(r,i,F){var O,G;O=l(r),F===void 0&&(F=i,i="all");for(var K=0;K<O.length;K++)G=[],r=O[K].split("+"),r.length>1&&(G=L(r),r=[r[r.length-1]]),r=r[0],r=C(r),r in o||(o[r]=[]),o[r].push({shortcut:O[K],scope:i,method:F,key:O[K],mods:G})}function b(r,i){var F,O,G=[],K,le,he;for(F=l(r),le=0;le<F.length;le++){if(O=F[le].split("+"),O.length>1&&(G=L(O),r=O[O.length-1]),r=C(r),i===void 0&&(i=j()),!o[r])return;for(K=0;K<o[r].length;K++)he=o[r][K],he.scope===i&&p(he.mods,G)&&(o[r][K]={})}}function y(r){return typeof r=="string"&&(r=C(r)),_(f,r)!=-1}function T(){return f.slice(0)}function R(r){var i=(r.target||r.srcElement).tagName;return!(i=="INPUT"||i=="SELECT"||i=="TEXTAREA")}for(t in c)a[t]=!1;function X(r){g=r||"all"}function j(){return g||"all"}function U(r){var i,F,O;for(i in o)for(F=o[i],O=0;O<F.length;)F[O].scope===r?F.splice(O,1):O++}function l(r){var i;return r=r.replace(/\s/g,""),i=r.split(","),i[i.length-1]==""&&(i[i.length-2]+=","),i}function L(r){for(var i=r.slice(0,r.length-1),F=0;F<i.length;F++)i[F]=c[i[F]];return i}function E(r,i,F){r.addEventListener?r.addEventListener(i,F,!1):r.attachEvent&&r.attachEvent("on"+i,function(){F(window.event)})}E(document,"keydown",function(r){m(r)}),E(document,"keyup",h),E(window,"focus",v);var B=n.key;function P(){var r=n.key;return n.key=B,r}n.key=a,n.key.setScope=X,n.key.getScope=j,n.key.deleteScope=U,n.key.filter=R,n.key.isPressed=y,n.key.getPressedKeyCodes=T,n.key.noConflict=P,n.key.unbind=b,e.exports=a})(Vt)})(bt);var Z=bt.exports;const ee=re(),ne=e=>`${Tt.CTRL}+${e}`,Le=e=>`${Tt.SHIFT}+${e}`,J={[A.ARROW_UP]:ne("up"),[A.ARROW_RIGHT]:ne("right"),[A.ARROW_DOWN]:ne("down"),[A.ARROW_LEFT]:ne("left"),[A.COPY]:ne("c"),[A.CUT]:ne("x"),[A.PARSE]:ne("v"),[A.DELETE]:"delete",[A.BACK]:ne("z"),[A.FORWORD]:ne(Le("z")),[A.GROUP]:ne("g"),[A.UN_GROUP]:ne(Le("g")),[A.LOCK]:ne("l"),[A.UNLOCK]:ne(Le("l")),[A.HIDE]:ne("h"),[A.SHOW]:ne(Le("h"))},te=e=>`${xt.CTRL}+${e}`,Me=e=>`${xt.SHIFT}+${e}`,V={[A.ARROW_UP]:te("arrowup"),[A.ARROW_RIGHT]:te("arrowright"),[A.ARROW_DOWN]:te("arrowdown"),[A.ARROW_LEFT]:te("arrowleft"),[A.COPY]:te("c"),[A.CUT]:te("x"),[A.PARSE]:te("v"),[A.DELETE]:te("backspace"),[A.BACK]:te("z"),[A.FORWORD]:te(Me("z")),[A.GROUP]:te("g"),[A.UN_GROUP]:te(Me("g")),[A.LOCK]:te("l"),[A.UNLOCK]:te(Me("l")),[A.HIDE]:te("h"),[A.SHOW]:te(Me("h"))},wn=[J.up,J.right,J.down,J.left,J.delete,J.copy,J.cut,J.parse,J.back,J.forward,J.group,J.unGroup,J.lock,J.unLock,J.hide,J.show],Sn=[V.up,V.right,V.down,V.left,V.delete,V.copy,V.cut,V.parse,V.back,V.forward,V.group,V.unGroup,V.lock,V.unLock,V.hide,V.show],Tn=()=>{window.$KeyboardActive={ctrl:!1,space:!1},document.onkeydown=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(it(e.keyCode),n){case 17:window.$KeyboardActive.ctrl=!0;break;case 32:window.$KeyboardActive.space=!0;break}},document.onkeyup=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(it(),n){case 17:window.$KeyboardActive.ctrl=!1;break;case 32:window.$KeyboardActive.space=!1;break}}},xn=()=>{const n=(t,o)=>{switch(o){case t.up:Z(o,se(()=>(ee.setMove(A.ARROW_UP),!1),50));break;case t.right:Z(o,se(()=>(ee.setMove(A.ARROW_RIGHT),!1),50));break;case t.down:Z(o,se(()=>(ee.setMove(A.ARROW_DOWN),!1),50));break;case t.left:Z(o,se(()=>(ee.setMove(A.ARROW_LEFT),!1),50));break;case t.delete:Z(o,Ke(()=>(ee.removeComponentList(),!1),50));break;case t.copy:Z(o,Ke(()=>(ee.setCopy(),!1),50));break;case t.cut:Z(o,Ke(()=>(ee.setCut(),!1),50));break;case t.parse:Z(o,se(()=>(ee.setParse(),!1),50));break;case t.back:Z(o,se(()=>(ee.setBack(),!1),50));break;case t.forward:Z(o,se(()=>(ee.setForward(),!1),50));break;case t.group:Z(o,se(()=>(ee.setGroup(),!1),50));break;case t.unGroup:Z(o,se(()=>(ee.setUnGroup(),!1),50));break;case t.lock:Z(o,se(()=>(ee.setLock(),!1),50));break;case t.unLock:Z(o,se(()=>(ee.setUnLock(),!1),50));break;case t.hide:Z(o,se(()=>(ee.setHide(),!1),50));break;case t.show:Z(o,se(()=>(ee.setShow(),!1),50));break}};wn.forEach(t=>{n(J,t)}),Sn.forEach(t=>{n(V,t)}),Tn()},x=re(),{onClickOutSide:Dn}=ut(),An=e=>Se(void 0,null,function*(){e.preventDefault();try{gn();const n=e.dataTransfer.getData(Qt.DRAG_KEY);if(!n){vt();return}x.setEditCanvas(ae.IS_CREATE,!1);const t=Ve(n);let o;if(t.sourceID){let g=yield Nt(t.sourceID,t.category);if(!g){window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...");return}o=g.chartConfig}else o=t;let s=yield Kt(o);q(s,e.offsetX-s.attr.w/2,e.offsetY-s.attr.h/2),x.addComponentList(s,!1,!0),x.setTargetSelectChart(s.id),vt()}catch(n){_n(),window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...")}}),ht=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},Ot=(e,n)=>{if(n){x.setTargetSelectChart(n.id);return}x.setTargetSelectChart(void 0)},kn=(e,n)=>{var f;if(e.which==2||(f=window.$KeyboardActive)!=null&&f.space)return;Ot();const t=e.offsetX,o=e.offsetY,s=e.screenX,g=e.screenY,c=x.getEditCanvas.scale;x.setMousePosition(void 0,void 0,t,o);const w=Re.exports.throttle(_=>{x.setTargetSelectChart(),x.setEditCanvas(ae.IS_SELECT,!0);const p=t+_.screenX-s,u=o+_.screenY-g;x.setMousePosition(p,u);const S={x1:0,y1:0,x2:0,y2:0};p>t&&u>o?(S.x1=t,S.y1=o,S.x2=Math.round(t+(_.screenX-s)/c),S.y2=Math.round(o+(_.screenY-g)/c)):p>t&&u<o?(S.x1=t,S.y1=Math.round(o-(g-_.screenY)/c),S.x2=Math.round(t+(_.screenX-s)/c),S.y2=o):p<t&&u>o?(S.x1=Math.round(t-(s-_.screenX)/c),S.y1=o,S.x2=t,S.y2=Math.round(o+(_.screenY-g)/c)):(S.x1=Math.round(t-(s-_.screenX)/c),S.y1=Math.round(o-(g-_.screenY)/c),S.x2=t,S.y2=o),x.getComponentList.forEach(m=>{if(!x.getTargetChart.selectId.includes(m.id)){const{x:h,y:v,w:a,h:b}=m.attr,y={x1:h,y1:v,x2:h+a,y2:v+b};y.x1-S.x1>=0&&y.y1-S.y1>=0&&y.x2-S.x2<=0&&y.y2-S.y2<=0&&!m.status.lock&&!m.status.hide&&x.setTargetSelectChart(m.id,!0)}})},30),C=()=>{w.cancel(),x.setEditCanvas(ae.IS_SELECT,!1),x.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",C)};document.addEventListener("mousemove",w),document.addEventListener("mouseup",C)},Lt=()=>({mouseClickHandle:(s,g)=>{var c;if(s.preventDefault(),s.stopPropagation(),!g.status.lock&&(c=window.$KeyboardActive)!=null&&c.ctrl)if(x.targetChart.selectId.includes(g.id)){const w=x.targetChart.selectId.filter(C=>C!==g.id);x.setTargetSelectChart(w)}else x.setTargetSelectChart(g.id,!0)},mousedownHandle:(s,g)=>{var v;if(s.preventDefault(),s.stopPropagation(),g.status.lock||(Dn(),s.buttons===Ye.LEFT&&((v=window.$KeyboardActive)==null?void 0:v.ctrl)))return;const c=x.getTargetChart.selectId;if(s.buttons===Ye.RIGHT&&c.length>1&&c.includes(g.id)||(x.setTargetSelectChart(g.id),s.buttons===Ye.RIGHT))return;const w=x.getEditCanvas.scale,C=x.getEditCanvasConfig.width,f=x.getEditCanvasConfig.height,_=new Map;x.getTargetChart.selectId.forEach(a=>{const b=x.fetchTargetIndex(a);if(b!==-1){const{x:y,y:T,w:R,h:X}=Zt(x.getComponentList[b]).attr;_.set(a,{x:y,y:T,w:R,h:X})}});const p=s.screenX,u=s.screenY;let S=[];x.getTargetChart.selectId.forEach(a=>{if(!_.has(a))return;const b=x.fetchTargetIndex(a);S.push(Re.exports.cloneDeep(x.getComponentList[b]))}),x.setMousePosition(void 0,void 0,p,u);const m=Re.exports.throttle(a=>{x.setEditCanvas(ae.IS_DRAG,!0),x.setMousePosition(a.screenX,a.screenY);let b=(a.screenX-p)/w,y=(a.screenY-u)/w;x.getTargetChart.selectId.forEach(T=>{if(!_.has(T))return;const R=x.fetchTargetIndex(T),{x:X,y:j,w:U,h:l}=_.get(T),L=x.getComponentList[R];let E=Math.round(X+b),B=Math.round(j+y);const P=50;E=E<-U+P?-U+P:E,B=B<-l+P?-l+P:B,E=E>C-P?C-P:E,B=B>f-P?f-P:B,L&&!Number.isNaN(E)&&!Number.isNaN(B)&&(L.attr=Object.assign(L.attr,{x:E,y:B}))})},20),h=()=>{try{x.setMousePosition(0,0,0,0),x.setEditCanvas(ae.IS_DRAG,!1),S.length&&(x.getTargetChart.selectId.forEach(a=>{if(!_.has(a))return;const b=x.fetchTargetIndex(a),y=x.getComponentList[b];S.forEach(T=>{T.id===a&&(T.attr=Object.assign(T.attr,{offsetX:y.attr.x-T.attr.x,offsetY:y.attr.y-T.attr.y}))})}),x.moveComponentList(S)),document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",h)}catch(a){console.log(a)}};document.addEventListener("mousemove",m),document.addEventListener("mouseup",h)},mouseenterHandle:(s,g)=>{s.preventDefault(),s.stopPropagation(),x.getEditCanvas.isSelect||x.setTargetHoverChart(g.id)},mouseleaveHandle:(s,g)=>{s.preventDefault(),s.stopPropagation(),x.setEditCanvas(ae.IS_DRAG,!1),x.setTargetHoverChart(void 0)}}),Fn=(e,n,t)=>{e.stopPropagation(),e.preventDefault(),x.setEditCanvas(ae.IS_DRAG,!0);const o=x.getEditCanvas.scale,s=t.x,g=t.y,c=t.w,w=t.h,C=e.screenX,f=e.screenY;x.setMousePosition(C,f);const _=Re.exports.throttle(u=>{x.setMousePosition(u.screenX,u.screenY);let S=Math.round((u.screenX-C)/o),m=Math.round((u.screenY-f)/o);const h=/t/.test(n),v=/b/.test(n),a=/l/.test(n),b=/r/.test(n),y=w+(h?-m:v?m:0),T=c+(a?-S:b?S:0);t.h=y>0?y:0,t.w=T>0?T:0,t.x=s+(a?S:0),t.y=g+(h?m:0)},50),p=()=>{x.setEditCanvas(ae.IS_DRAG,!1),x.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",p)};document.addEventListener("mousemove",_),document.addEventListener("mouseup",p)};const bn=["onMousedown"],On=ue({__name:"index",props:{item:{type:Object,required:!0},hiddenPoint:{type:Boolean,required:!1}},setup(e){Ae(p=>({"026d39a0":c.value}));const n=e,t=ke(),o=re(),s=["t","r","b","l","lt","rt","lb","rb"],g=["n","e","s","w","nw","ne","sw","se"],c=$(()=>t.getAppTheme),w=$(()=>n.item.status.lock?!1:n.item.id===o.getTargetChart.hoverId),C=$(()=>{const p=n.item.id;return n.item.status.lock?!1:o.getTargetChart.selectId.find(u=>u===p)}),f=$(()=>n.item.status.lock),_=$(()=>n.item.status.hide);return(p,u)=>(D(),z("div",{class:ie(["go-shape-box",{lock:f.value,hide:_.value}])},[at(p.$slots,"default",{},void 0,!0),e.hiddenPoint?fe("",!0):(D(!0),z(ve,{key:0},me(C.value?s:[],(S,m)=>(D(),z("div",{class:ie(`shape-point ${S}`),key:m,style:oe(d(Yt)(S,m,e.item.attr,g)),onMousedown:h=>d(Fn)(h,S,e.item.attr)},null,46,bn))),128)),W("div",{class:"shape-modal",style:oe(d(Ee)(e.item.attr))},[W("div",{class:ie(["shape-modal-select",{active:C.value}])},null,2),W("div",{class:ie(["shape-modal-change",{selectActive:C.value,hoverActive:w.value}])},null,2)],4)],2))}});var et=ce(On,[["__scopeId","data-v-5f8854aa"]]);const Ln={class:"go-edit-group-box"},Mn=ue({__name:"index",props:{groupData:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){const n=re(),{handleContextMenu:t}=ut(),{mouseenterHandle:o,mouseleaveHandle:s,mousedownHandle:g,mouseClickHandle:c}=Lt(),w=(_,p,u)=>{const S=m=>p.filter(h=>m.includes(h.key));if(n.getTargetChart.selectId.length>1)return S([A.GROUP,A.DELETE]);{const m=[];u.status.lock?m.push(A.LOCK):m.push(A.UNLOCK),u.status.hide?m.push(A.HIDE):m.push(A.SHOW);const h=[A.UN_GROUP];return[...S(h),hn(),..._.filter(v=>!m.includes(v.key))]}},C=$(()=>{const _=n.getEditCanvasConfig.chartThemeColor;return Et[_]}),f=$(()=>n.getEditCanvasConfig.chartThemeSetting);return(_,p)=>(D(),z("div",Ln,[(D(),N(d(et),{key:e.groupData.id,"data-id":e.groupData.id,index:e.groupIndex,item:e.groupData,hiddenPoint:!0,class:ie(d(Qe)(e.groupData.styles.animations)),style:oe(Y(Y(Y(Y(Y({},d(Ie)(e.groupData.attr,e.groupIndex)),d(Ee)(e.groupData.attr)),d(He)(e.groupData.styles)),d(Ze)(e.groupData.styles)),d(Dt)(e.groupData.styles))),onClick:p[0]||(p[0]=u=>d(c)(u,e.groupData)),onMousedown:p[1]||(p[1]=u=>d(g)(u,e.groupData)),onMouseenter:p[2]||(p[2]=u=>d(o)(u,e.groupData)),onMouseleave:p[3]||(p[3]=u=>d(s)(u,e.groupData)),onContextmenu:p[4]||(p[4]=u=>d(t)(u,e.groupData,w))},{default:k(()=>[(D(!0),z(ve,null,me(e.groupData.groupList,u=>(D(),N(d(et),{key:u.id,"data-id":u.id,index:e.groupIndex,item:u,hiddenPoint:!0,style:oe(Y({},d(Ie)(u.attr,e.groupIndex)))},{default:k(()=>[(D(),N(Ce(u.chartConfig.chartKey),{class:ie(["edit-content-chart",d(Qe)(u.styles.animations)]),chartConfig:u,themeSetting:f.value,themeColor:C.value,style:oe(Y(Y(Y({},d(Ee)(u.attr)),d(He)(u.styles)),d(Ze)(u.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","item","style"]))),128))]),_:1},8,["data-id","index","item","class","style"]))]))}});const Bn={class:"go-edit-align-line"},Rn=ue({__name:"index",setup(e){Ae(m=>({42514545:c.value}));const n=ke(),t=re(),o=rt(),s=$e({lineArr:["rowt","rowc","rowb","coll","colc","colr"],select:new Map,sorptioned:{x:!1,y:!1}}),g=m=>m?{left:`${m.x?m.x:0}px`,top:`${m.y?m.y:0}px`}:{},c=$(()=>n.getAppTheme),w=$(()=>o.getChartAlignRange),C=$(()=>t.getEditCanvas[ae.IS_DRAG]),f=(m,h)=>Math.abs(m-h)<=w.value,_=$(()=>t.getTargetChart.selectId),p=$(()=>t.getComponentList[t.fetchTargetIndex()]),u=$(()=>{var m;return((m=p.value)==null?void 0:m.attr)||{}}),S=$(()=>({id:"0",attr:{w:dt(t.getEditCanvasConfig.width),h:dt(t.getEditCanvasConfig.height),x:0,y:0,offsetX:0,offsetY:0,zIndex:0}}));return pe(()=>t.getMousePosition,se(()=>{try{if(!C.value||_.value.length!==1)return;const m=u.value.w,h=u.value.h,v=u.value.x,a=v+m/2,b=v+m,y=[v,a,b],T=u.value.y,R=T+h/2,X=T+h,j=[T,R,X];s.select.clear(),s.sorptioned.y=!1;const U=t.getComponentList.map(l=>({id:l.id,attr:l.attr}));U.push(S.value),s.lineArr.forEach(l=>{U.forEach(L=>{if(_.value[0]===L.id)return;const E=L.attr.w,B=L.attr.h,P=L.attr.x,r=P+E/2,i=P+E,F=[P,r,i],O=L.attr.y,G=O+B/2,K=O+B,le=[O,G,K];l.includes("rowt")&&(f(T,O)&&(s.select.set(l,{y:O}),q(p.value,v,O)),f(T,G)&&(s.select.set(l,{y:G}),q(p.value,v,G)),f(T,K)&&(s.select.set(l,{y:K}),q(p.value,v,K))),l.includes("rowc")&&(f(R,O)&&(s.select.set(l,{y:O}),q(p.value,v,O-h/2)),f(R,G)&&(s.select.set(l,{y:G}),q(p.value,v,G-h/2)),f(R,K)&&(s.select.set(l,{y:K}),q(p.value,v,K-h/2))),l.includes("rowb")&&(f(X,O)&&(s.select.set(l,{y:O}),q(p.value,v,O-h)),f(X,G)&&(s.select.set(l,{y:G}),q(p.value,v,G-h)),f(X,K)&&(s.select.set(l,{y:K}),q(p.value,v,K-h))),l.includes("coll")&&(f(v,P)&&(s.select.set(l,{x:P}),q(p.value,P,T)),f(v,r)&&(s.select.set(l,{x:r}),q(p.value,r,T)),f(v,i)&&(s.select.set(l,{x:i}),q(p.value,i,T))),l.includes("colc")&&(f(a,P)&&(s.select.set(l,{x:P}),q(p.value,P-m/2,T)),f(a,r)&&(s.select.set(l,{x:r}),q(p.value,r-m/2,T)),f(a,i)&&(s.select.set(l,{x:i}),q(p.value,i-m/2,T))),l.includes("colr")&&(f(b,P)&&(s.select.set(l,{x:P}),q(p.value,P-m,T)),f(b,r)&&(s.select.set(l,{x:r}),q(p.value,r-m,T)),f(b,i)&&(s.select.set(l,{x:i}),q(p.value,i-m,T)))})})}catch(m){console.log(m)}},200),{deep:!0}),pe(()=>C.value,m=>{m||(s.select.clear(),s.sorptioned.y=!1)}),(m,h)=>(D(),z("div",Bn,[(D(!0),z(ve,null,me(s.lineArr,v=>(D(),z("div",{class:ie(["line",[v.includes("row")?"row":"col",s.select.has(v)&&"visible"]]),key:v,style:oe(g(s.select.get(v)))},null,6))),128))]))}});var In=ce(Rn,[["__scopeId","data-v-403a9eed"]]);const Hn=ue({__name:"index",setup(e){return(n,t)=>{const o=H("n-watermark");return D(),N(o,{id:"go-edit-watermark",content:d(en),cross:"",selectable:"","font-size":16,"line-height":16,width:500,height:150,"x-offset":12,"y-offset":80,rotate:-15},null,8,["content"])}}});var Pn=ce(Hn,[["__scopeId","data-v-e5cd93da"]]);const Mt=e=>(At("data-v-71d41248"),e=e(),kt(),e),$n=Mt(()=>W("div",{class:"select-background"},null,-1)),Un=Mt(()=>W("div",{class:"select-border"},null,-1)),Nn=[$n,Un],Kn=ue({__name:"index",setup(e){Ae(w=>({c29aca42:g.value}));const n=ke(),t=re(),{isSelect:o,scale:s}=Ue(t.getEditCanvas),g=$(()=>n.getAppTheme),c=Q();return pe(()=>t.getMousePosition,w=>{if(!o.value)return;const{startX:C,startY:f,x:_,y:p}=w,u={zIndex:ft,x:0,y:0,w:0,h:0,offsetX:0,offsetY:0};_>C&&p>f?(u.x=C,u.y=f,u.w=Math.round((_-C)/s.value),u.h=Math.round((p-f)/s.value)):_>C&&p<f?(u.x=C,u.w=Math.round((_-C)/s.value),u.h=Math.round((f-p)/s.value),u.y=f-u.h):_<C&&p>f?(u.y=f,u.w=Math.round((C-_)/s.value),u.h=Math.round((p-f)/s.value),u.x=C-u.w):(u.w=Math.round((C-_)/s.value),u.h=Math.round((f-p)/s.value),u.x=C-u.w,u.y=f-u.h),c.value=Y(Y({},Ie(u,ft)),Ee(u))},{deep:!0}),(w,C)=>d(o)?(D(),z("div",{key:0,class:"go-edit-select",style:oe(c.value)},Nn,4)):fe("",!0)}});var Yn=ce(Kn,[["__scopeId","data-v-71d41248"]]);const Gn=ue({__name:"index",setup(e){const n=re(),{getEditCanvasConfig:t,getEditCanvas:o}=Ue(n),s=$(()=>({w:t.value.width,h:t.value.height})),g=$(()=>{const w={transform:`scale(${o.value.scale})`};return Y(Y({},Ee(s.value)),w)}),c=$(()=>{const w=o.value.isCreate&&{"z-index":99999};return Y(Y({},Ee(s.value)),w)});return(w,C)=>(D(),z("div",{class:"go-edit-range go-transition",style:oe(g.value),onMousedown:C[0]||(C[0]=f=>d(kn)(f,void 0))},[at(w.$slots,"default",{},void 0,!0),M(d(Pn)),M(d(In)),M(d(Yn)),W("div",{class:"go-edit-range-model",style:oe(c.value)},null,4)],36))}});var Xn=ce(Gn,[["__scopeId","data-v-52e445d0"]]),Bt=!!(typeof window!="undefined"&&window.document&&window.document.createElement),tt=!1,nt=!1;try{var qe={get passive(){return tt=!0},get once(){return nt=tt=!0}};Bt&&(window.addEventListener("test",qe,qe),window.removeEventListener("test",qe,!0))}catch(e){}function Wn(e,n,t,o){if(o&&typeof o!="boolean"&&!nt){var s=o.once,g=o.capture,c=t;!nt&&s&&(c=t.__once||function w(C){this.removeEventListener(n,w,g),t.call(this,C)},t.__once=c),e.addEventListener(n,c,tt?o:g)}e.addEventListener(n,t,o)}function zn(e,n,t,o){var s=o&&typeof o!="boolean"?o.capture:o;e.removeEventListener(n,t,s),t.__once&&e.removeEventListener(n,t.__once,s)}function gt(e,n,t,o){return Wn(e,n,t,o),function(){zn(e,n,t,o)}}var _t=new Date().getTime();function qn(e){var n=new Date().getTime(),t=Math.max(0,16-(n-_t)),o=setTimeout(e,t);return _t=n,o}var jn=["","webkit","moz","o","ms"],mt=qn,Ct=function(n,t){return n+(n?t[0].toUpperCase()+t.substr(1):t)+"AnimationFrame"};Bt&&jn.some(function(e){var n=Ct(e,"request");return n in window&&(Ct(e,"cancel"),mt=function(o){return window[n](o)}),!!mt});Function.prototype.bind.call(Function.prototype.call,[].slice);Function.prototype.bind.call(Function.prototype.call,[].slice);const Jn={class:"go-sketch-rule"},Vn={key:1,class:"fix-edit-screens-block"},je=20,Qn=ue({__name:"index",setup(e){Ae(E=>({"6f694401":T.value,ed8dd9a8:b.value,"58b617f4":p.value}));const n=re(),t=Gt(),o=ke();let s=[0,0],g=[0,0];const c=Q(),w=Q(!0),C=Q(),f=Q(),_=Q(!1),p=Q("auto"),{width:u,height:S}=Ue(n.getEditCanvasConfig),m=Q(0),h=Q(0),v=$e({h:[],v:[]}),a=$(()=>n.getEditCanvas.scale),b=$(()=>`${S.value*2}px`),y=$(()=>o.getDarkTheme?{bgColor:"#18181c",longfgColor:"#4d4d4d",shortfgColor:"#4d4d4d",fontColor:"#4d4d4d",shadowColor:"#18181c",borderColor:"#18181c",cornerActiveColor:"#18181c"}:{}),T=$(()=>o.getAppTheme),R=E=>{if(E.ctrlKey||E.metaKey){E.preventDefault();let B=a.value;if(E.wheelDelta>=0&&a.value<2){B=a.value+.05,n.setScale(B);return}E.wheelDelta<0&&a.value>.1&&(B=a.value-.05,n.setScale(B))}},X=()=>{if(!c.value)return;const E=c.value.getBoundingClientRect(),B=C.value.getBoundingClientRect();m.value=(E.left+je-B.left)/a.value,h.value=(E.top+je-B.top)/a.value},j=E=>{var F,O;if(E.preventDefault(),E.stopPropagation(),E.which==2)_.value=!0;else if(!((F=window.$KeyboardActive)!=null&&F.space))return;(O=document.activeElement)==null||O.blur();const B=E.pageX,P=E.pageY,r=gt(window,"mousemove",G=>{const K=G.pageX-B,le=G.pageY-P,[he,Fe]=s,[Ne,be]=g;s=[Fe,K],g=[be,le],c.value.scrollLeft-=Fe>he?Math.abs(Fe-he):-Math.abs(Fe-he),c.value.scrollTop-=be>Ne?Math.abs(be-Ne):-Math.abs(be-Ne)}),i=gt(window,"mouseup",()=>{r(),i(),s=[0,0],g=[0,0],_.value=!1})},U=()=>{const E=document.getElementById("go-chart-edit-layout");return E?{height:E.clientHeight-25,width:E.clientWidth}:{width:u.value,height:S.value}},l=()=>{w.value=!1,setTimeout(()=>{w.value=!0},10)},L=()=>{const{width:E,height:B}=f.value.getBoundingClientRect(),{width:P,height:r}=U();c.value.scrollLeft=E/2-P/2,c.value.scrollTop=B/2-r/2};return pe(()=>o.getDarkTheme,()=>{l()}),pe(()=>a.value,(E,B)=>{B!==E?(t.setItemUnHandle(Xt.RE_POSITION_CANVAS,!1),X(),setTimeout(()=>{L(),l()},400)):se(l,20)}),pe(()=>_.value,E=>{p.value=E?"grab":"auto"}),ot(()=>{c.value&&(c.value.addEventListener("wheel",R,{passive:!1}),L())}),St(()=>{c.value&&c.value.removeEventListener("wheel",R)}),window.onKeySpacePressHold=E=>{_.value=E},(E,B)=>{const P=H("sketch-rule");return D(),z("div",Jn,[w.value?(D(),N(P,{key:0,thick:je,scale:a.value,width:U().width,height:U().height,startX:m.value,startY:h.value,lines:v,palette:y.value},null,8,["scale","width","height","startX","startY","lines","palette"])):fe("",!0),W("div",{ref_key:"$app",ref:c,class:"edit-screens",onScroll:X},[W("div",{ref_key:"$container",ref:f,class:"edit-screen-container",style:oe({width:d(u)*2+"px"})},[W("div",{ref_key:"refSketchRuleBox",ref:C,class:"canvas",onMousedown:j,style:oe({marginLeft:"-"+(U().width/2-25)+"px"})},[W("div",{style:oe({pointerEvents:_.value?"none":"auto"})},[at(E.$slots,"default",{},void 0,!0)],4)],36)],4)],544),d(o).getDarkTheme?(D(),z("div",Vn)):fe("",!0)])}}});var Zn=ce(Qn,[["__scopeId","data-v-12b70182"]]);const Je={[I.ADD]:"\u65B0\u589E",[I.DELETE]:"\u5220\u9664",[I.UPDATE]:"\u66F4\u65B0",[I.MOVE]:"\u79FB\u52A8",[I.PASTE]:"\u7C98\u8D34",[I.COPY]:"\u590D\u5236",[I.CUT]:"\u526A\u5207",[I.TOP]:"\u7F6E\u9876",[I.BOTTOM]:"\u7F6E\u5E95",[I.UP]:"\u4E0A\u79FB",[I.DOWN]:"\u4E0B\u79FB",[I.GROUP]:"\u6210\u7EC4",[I.UN_GROUP]:"\u89E3\u7EC4",[I.LOCK]:"\u9501\u5B9A",[I.UNLOCK]:"\u89E3\u9501",[I.HIDE]:"\u9690\u85CF",[I.SHOW]:"\u663E\u793A",[Be.CANVAS]:"\u753B\u5E03\u521D\u59CB\u5316"};var es=Array.prototype,ts=es.reverse;function ns(e){return e==null?e:ts.call(e)}var ss=ns;const Rt=e=>(At("data-v-5a4fd660"),e=e(),kt(),e),os={class:"go-flex-items-center"},as=Rt(()=>W("span",{class:"btn-text"},"\u5386\u53F2\u8BB0\u5F55",-1)),rs={class:"history-list-box"},us=["title"],cs=Rt(()=>W("div",{class:"popover-modal"},null,-1)),ls=ue({__name:"index",setup(e){const{DesktopOutlineIcon:n,PencilIcon:t,TrashIcon:o,CopyIcon:s,LayersIcon:g,DuplicateIcon:c,HelpOutlineIcon:w,LockClosedOutlineIcon:C,LockOpenOutlineIcon:f,EyeOffOutlineIcon:_,EyeOutlineIcon:p}=De.ionicons5,{StackedMoveIcon:u,Carbon3DCursorIcon:S,Carbon3DSoftwareIcon:m}=De.carbon,h=Wt(),v=y=>{if(y.targetType===Be.CANVAS)return n;switch(y.actionType){case I.UPDATE:return t;case I.DELETE:return o;case I.PASTE:return s;case I.TOP:return g;case I.BOTTOM:return g;case I.UP:return g;case I.DOWN:return g;case I.MOVE:return u;case I.ADD:return c;case I.GROUP:return S;case I.UN_GROUP:return m;case I.LOCK:return C;case I.UNLOCK:return f;case I.HIDE:return _;case I.SHOW:return p;default:return t}},a=y=>{if(y.targetType===Be.CANVAS)return Je[Be.CANVAS];if(y.actionType===I.GROUP||y.actionType===I.UN_GROUP)return`${Je[y.actionType]}`;if(y.historyData.length)return`${Je[y.actionType]} - ${y.historyData[0].chartConfig.title}`},b=$(()=>{const T=h.getBackStack.map(R=>({label:a(R),icon:v(R)}));return ss(T.filter(R=>R.label))});return(y,T)=>{const R=H("n-button"),X=H("n-icon"),j=H("n-text"),U=H("n-scrollbar"),l=H("n-popover"),L=H("n-tooltip");return D(),z("div",os,[M(l,{class:"edit-history-popover","show-arrow":!1,size:"small",trigger:"click",placement:"top-start"},{trigger:k(()=>[M(R,{class:"mr-10",secondary:"",size:"small",disabled:b.value.length===0},{default:k(()=>[as]),_:1},8,["disabled"])]),default:k(()=>[W("div",rs,[M(U,{style:{"max-height":"500px"}},{default:k(()=>[(D(!0),z(ve,null,me(b.value,(E,B)=>(D(),z("div",{class:"list-item go-flex-items-center go-ellipsis-1",key:B,title:E.label},[M(X,{class:"item-icon",size:"16",depth:2,component:E.icon},null,8,["component"]),M(j,{depth:"2"},{default:k(()=>[ye(de(E.label),1)]),_:2},1024)],8,us))),128))]),_:1}),cs])]),_:1}),M(L,{trigger:"hover"},{trigger:k(()=>[M(X,{size:"21",depth:3},{default:k(()=>[M(d(w))]),_:1})]),default:k(()=>[W("span",null,"\u6700\u591A\u53EA\u4FDD\u7559"+de(d(tn))+"\u6761\u8BB0\u5F55",1)]),_:1})])}}});var is=ce(ls,[["__scopeId","data-v-5a4fd660"]]);const ds={class:"go-edit-bottom"},fs=ue({__name:"index",setup(e){Ae(v=>({f3add9fc:s.value}));const{LockClosedOutlineIcon:n,LockOpenOutlineIcon:t}=De.ionicons5,o=ke(),s=Q(o.getAppTheme),g=re(),{lockScale:c,scale:w}=Ue(g.getEditCanvas);let C=[{label:"200%",value:200},{label:"150%",value:150},{label:"100%",value:100},{label:"50%",value:50},{label:"\u81EA\u9002\u5E94",value:0}];const f=Q(""),_=v=>{if(v===0){g.computedScale();return}g.setScale(v/100)},p=()=>{g.setEditCanvas(ae.LOCK_SCALE,!c.value)},u=Q(100),S=v=>`${v}%`,m=v=>{g.setScale(v/100)},h=$e({100:""});return nn(()=>{const v=(w.value*100).toFixed(0);f.value=`${v}%`,u.value=parseInt(v)}),(v,a)=>{const b=H("n-text"),y=H("n-space"),T=H("n-select"),R=H("n-icon"),X=H("n-button"),j=H("n-tooltip"),U=H("n-slider");return D(),z("div",ds,[M(y,null,{default:k(()=>[M(d(is)),M(b,{id:"keyboard-dress-show",depth:"3"})]),_:1}),M(y,{class:"bottom-ri"},{default:k(()=>[M(yn),M(T,{disabled:d(c),class:"scale-btn",value:f.value,"onUpdate:value":[a[0]||(a[0]=l=>f.value=l),_],size:"mini",options:d(C)},null,8,["disabled","value","options"]),M(j,{trigger:"hover"},{trigger:k(()=>[M(X,{onClick:p,text:""},{default:k(()=>[M(R,{class:ie(["lock-icon",{color:d(c)}]),size:"18",depth:2},{default:k(()=>[d(c)?(D(),N(d(n),{key:0})):(D(),N(d(t),{key:1}))]),_:1},8,["class"])]),_:1})]),default:k(()=>[W("span",null,de(d(c)?"\u89E3\u9501":"\u9501\u5B9A")+"\u5F53\u524D\u6BD4\u4F8B",1)]),_:1}),M(U,{class:"scale-slider",value:u.value,"onUpdate:value":[a[1]||(a[1]=l=>u.value=l),m],"default-value":50,min:10,max:200,step:5,"format-tooltip":S,disabled:d(c),marks:h},null,8,["value","disabled","marks"])]),_:1})])}}});var ps=ce(fs,[["__scopeId","data-v-99a534fc"]]);const vs=ue({__name:"index",props:{modelShow:Boolean},emits:["update:modelShow"],setup(e,{emit:n}){const t=e,o=n,{HelpOutlineIcon:s,CloseIcon:g}=De.ionicons5,c=rt(),w=Q(!1),C=$e([{key:ge.ASIDE_ALL_COLLAPSED,value:c.getAsideAllCollapsed,type:"switch",name:"\u83DC\u5355\u6298\u53E0",desc:"\u9996\u9875\u83DC\u5355\u6298\u53E0\u65F6\u9690\u85CF\u81F3\u754C\u9762\u5916"},{key:ge.HIDE_PACKAGE_ONE_CATEGORY,value:c.getHidePackageOneCategory,type:"switch",name:"\u9690\u85CF\u5206\u7C7B",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u8868\u5355\u5206\u7C7B\u53EA\u6709\u5355\u9879\u65F6\u9690\u85CF"},{key:ge.CHANGE_LANG_RELOAD,value:c.getChangeLangReload,type:"switch",name:"\u5207\u6362\u8BED\u8A00",desc:"\u5207\u6362\u8BED\u8A00\u91CD\u65B0\u52A0\u8F7D\u9875\u9762",tip:"\u82E5\u9047\u5230\u90E8\u5206\u533A\u57DF\u8BED\u8A00\u5207\u6362\u5931\u8D25\uFF0C\u5219\u5EFA\u8BAE\u5F00\u542F"},{key:"divider1",type:"divider",name:"",desc:"",value:""},{key:ge.CHART_TOOLS_STATUS_HIDE,value:c.getChartToolsStatusHide,type:"switch",name:"\u9690\u85CF\u5DE5\u5177\u680F",desc:"\u9F20\u6807\u79FB\u5165\u65F6\uFF0C\u4F1A\u5C55\u793A\u5207\u6362\u5230\u5C55\u5F00\u6A21\u5F0F"},{key:ge.CHART_TOOLS_STATUS,value:c.getChartToolsStatus,type:"select",name:"\u5DE5\u5177\u680F\u5C55\u793A",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u5DE5\u5177\u680F\u5C55\u793A\u65B9\u5F0F",options:[{label:"\u4FA7\u8FB9\u680F",value:Pe.ASIDE},{label:"\u5E95\u90E8 Dock",value:Pe.DOCK}]},{key:"divider0",type:"divider",name:"",desc:"",value:""},{key:ge.CHART_MOVE_DISTANCE,value:c.getChartMoveDistance,type:"number",name:"\u79FB\u52A8\u8DDD\u79BB",min:1,step:1,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u65B9\u5411\u952E\u63A7\u5236\u79FB\u52A8\u8DDD\u79BB"},{key:ge.CHART_ALIGN_RANGE,value:c.getChartAlignRange,type:"number",name:"\u5438\u9644\u8DDD\u79BB",min:10,step:2,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u79FB\u52A8\u56FE\u8868\u65F6\u7684\u5438\u9644\u8DDD\u79BB"}]);pe(()=>t.modelShow,p=>{w.value=p});const f=()=>{o("update:modelShow",!1)},_=(p,u)=>{c.setItem(u.key,u.value)};return(p,u)=>{const S=H("n-h3"),m=H("n-icon"),h=H("n-space"),v=H("n-divider"),a=H("n-text"),b=H("n-switch"),y=H("n-input-number"),T=H("n-select"),R=H("n-tooltip"),X=H("n-list-item"),j=H("n-list"),U=H("n-modal");return D(),N(U,{show:w.value,"onUpdate:show":u[0]||(u[0]=l=>w.value=l),onAfterLeave:f},{default:k(()=>[M(j,{bordered:"",class:"go-system-setting"},{header:k(()=>[M(h,{justify:"space-between"},{default:k(()=>[M(S,{class:"go-mb-0"},{default:k(()=>[ye("\u7CFB\u7EDF\u8BBE\u7F6E")]),_:1}),M(m,{size:"20",class:"go-cursor-pointer",onClick:f},{default:k(()=>[M(d(g))]),_:1})]),_:1})]),default:k(()=>[(D(!0),z(ve,null,me(C,l=>(D(),N(X,{key:l.key},{default:k(()=>[l.type==="divider"?(D(),N(v,{key:0,style:{margin:"0"}})):(D(),N(h,{key:1,size:40},{default:k(()=>[M(h,null,{default:k(()=>[M(a,{class:"item-left"},{default:k(()=>[ye(de(l.name),1)]),_:2},1024),l.type==="switch"?(D(),N(b,{key:0,value:l.value,"onUpdate:value":[L=>l.value=L,L=>_(L,l)],size:"small"},null,8,["value","onUpdate:value"])):l.type==="number"?(D(),N(y,{key:1,value:l.value,"onUpdate:value":[L=>l.value=L,L=>_(L,l)],class:"input-num-width",size:"small",step:l.step||null,suffix:l.suffix||null,min:l.min||0},null,8,["value","onUpdate:value","step","suffix","min"])):l.type==="select"?(D(),N(T,{key:2,class:"select-min-width",value:l.value,"onUpdate:value":[L=>l.value=L,L=>_(L,l)],size:"small",options:l.options},null,8,["value","onUpdate:value","options"])):fe("",!0)]),_:2},1024),M(h,null,{default:k(()=>[M(a,{class:"item-right"},{default:k(()=>[ye(de(l.desc),1)]),_:2},1024),l.tip?(D(),N(R,{key:0,trigger:"hover"},{trigger:k(()=>[M(m,{size:"21"},{default:k(()=>[M(d(s))]),_:1})]),default:k(()=>[W("span",null,de(l.tip),1)]),_:2},1024)):fe("",!0)]),_:2},1024)]),_:2},1024))]),_:2},1024))),128))]),_:1})]),_:1},8,["show"])}}});var hs=ce(vs,[["__scopeId","data-v-7cea0aa5"]]);const xe=re(),gs=()=>{xe.setTargetSelectChart(void 0),sn(on(xe.getStorageInfo||[]),void 0,"json");const e=document.querySelector(".go-edit-range"),n=document.getElementById("go-edit-watermark");if(!e||!n){window.$message.error("\u5BFC\u51FA\u5931\u8D25\uFF01");return}const t=xe.getEditCanvas.scale;xe.setScale(1,!0),n.style.display="block",setTimeout(()=>{an(e,()=>{n&&(n.style.display="none"),xe.setScale(t,!0)})},600)};var st=(e=>(e.TXT="text/plain",e.JSON="application/json",e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e))(st||{});const _s=()=>{const e=Q(),{updateComponent:n}=wt();return{importUploadFileListRef:e,importBeforeUpload:({file:s})=>{e.value=[];const g=s.file.type;return g!==st.JSON&&g!==st.TXT?(window.$message.warning("\u4EC5\u652F\u6301\u4E0A\u4F20 \u3010JSON\u3011 \u683C\u5F0F\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20\uFF01"),!1):!0},importCustomRequest:s=>{const{file:g}=s;rn(()=>{g.file?un(g.file).then(c=>{mn({message:"\u8BF7\u9009\u62E9\u5BFC\u5165\u65B9\u5F0F:",positiveText:"\u65B0\u589E\uFF08\u53EF\u64A4\u56DE\uFF09",negativeText:"\u8986\u76D6\uFF08\u4E0D\u53EF\u64A4\u56DE\uFF09",negativeButtonProps:{type:"info",ghost:!1},onPositiveCallback:()=>Se(void 0,null,function*(){try{c=Ve(c),yield n(c,!1,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(w){console.log(w),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}}),onNegativeCallback:()=>Se(void 0,null,function*(){try{c=Ve(c),yield n(c,!0,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(w){console.log(w),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}})})}):window.$message.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6216\u8054\u7CFB\u7BA1\u7406\u5458\uFF01")})}}},{updateComponent:ms,dataSyncUpdate:yt}=wt(),Cs=re(),ys=()=>{const e=g=>ms(g.detail,!0,!1),n=()=>Se(void 0,null,function*(){yt&&(yield yt()),dispatchEvent(new CustomEvent(Ge.CHART,{detail:Cs.getStorageInfo}))}),t=()=>{addEventListener("blur",n),addEventListener(Ge.JSON,e)},o=()=>{removeEventListener(Ge.JSON,e),removeEventListener("blur",n)};return(g,c)=>{c==pt.CHART_HOME_NAME&&o(),g==pt.CHART_HOME_NAME&&t()}},Es=()=>{const e=Ft();pe(()=>e.name,ys(),{immediate:!0})};var _e=(e=>(e.BUTTON="button",e.IMPORTUPLOAD="importUpload",e))(_e||{});const ws={class:"btn-item"},Ss=ue({__name:"index",setup(e){const{DownloadIcon:n,ShareIcon:t,PawIcon:o,SettingsSharpIcon:s,CreateIcon:g}=De.ionicons5,c=rt(),w=re();Ft(),Es();let C=null;const f=Q(!1),_=Q(!0),p=Q(!0),{importUploadFileListRef:u,importCustomRequest:S,importBeforeUpload:m}=_s(),h=$(()=>c.getChartToolsStatus===Pe.ASIDE),v=$(()=>c.getChartToolsStatusHide),a=$(()=>_.value&&v.value),b=$(()=>{if(!h.value)return j;const U=[];return j.map(l=>{U.unshift(l)}),U}),y=()=>{C=setTimeout(()=>{_.value&&(_.value=!1,p.value=!0)},200),setTimeout(()=>{p.value=!1},400)},T=()=>{clearTimeout(C),_.value||(_.value=!0)},R=()=>{window.$message.warning("\u5C06\u5F00\u542F\u5931\u7126\u66F4\u65B0\uFF01"),setTimeout(()=>{const U=ln(dn.CHART_EDIT_NAME,"href");if(!U)return;const l=fn();X(l),pn(U,[l],void 0,!0)},1e3)},X=U=>{const l=w.getStorageInfo,L=vn(Oe.GO_CHART_STORAGE_LIST)||[];if(L!=null&&L.length){const E=L.findIndex(B=>B.id===U);E!==-1?(L.splice(E,1,we(Y({},l),{id:U})),ze(Oe.GO_CHART_STORAGE_LIST,L)):(L.push(we(Y({},l),{id:U})),ze(Oe.GO_CHART_STORAGE_LIST,L))}else ze(Oe.GO_CHART_STORAGE_LIST,[we(Y({},l),{id:U})])},j=[{key:"import",type:_e.IMPORTUPLOAD,name:"\u5BFC\u5165",icon:t},{key:"export",type:_e.BUTTON,name:"\u5BFC\u51FA",icon:n,handle:gs},{key:"edit",type:_e.BUTTON,name:"\u7F16\u8F91",icon:g,handle:R},{key:"setting",type:_e.BUTTON,name:"\u8BBE\u7F6E",icon:s,handle:()=>{f.value=!0}}];return(U,l)=>{const L=H("n-icon"),E=H("n-text"),B=H("n-button"),P=H("n-upload"),r=H("n-tooltip");return D(),z(ve,null,[W("div",{class:ie(["go-chart-edit-tools",[d(c).getChartToolsStatus,a.value?"isMini":"unMini"]]),onClick:l[1]||(l[1]=i=>_.value&&(_.value=!1)),onMouseenter:y,onMouseleave:T},[Xe(M(L,{class:"asideLogo",size:"22"},{default:k(()=>[M(d(o))]),_:1},512),[[We,d(c).getChartToolsStatus===d(Pe).ASIDE&&a.value]]),(D(!0),z(ve,null,me(b.value,(i,F)=>(D(),N(r,{key:i.key,disabled:!h.value||v.value&&p.value,trigger:"hover",placement:"left"},{trigger:k(()=>[W("div",ws,[i.type===d(_e).BUTTON?(D(),N(B,{key:0,circle:h.value,secondary:"",onClick:i.handle},{icon:k(()=>[h.value?(D(),N(L,{key:0,size:"22"},{default:k(()=>[(D(),N(Ce(i.icon)))]),_:2},1024)):(D(),N(Ce(i.icon),{key:1}))]),default:k(()=>[Xe(M(E,{depth:"3"},{default:k(()=>[ye(de(i.name),1)]),_:2},1536),[[We,!h.value]])]),_:2},1032,["circle","onClick"])):i.type===d(_e).IMPORTUPLOAD?(D(),N(P,{key:1,"file-list":d(u),"onUpdate:fileList":l[0]||(l[0]=O=>cn(u)?u.value=O:null),"show-file-list":!1,customRequest:d(S),onBeforeUpload:d(m)},{default:k(()=>[M(B,{circle:h.value,secondary:""},{icon:k(()=>[h.value?(D(),N(L,{key:0,size:"22"},{default:k(()=>[(D(),N(Ce(i.icon)))]),_:2},1024)):(D(),N(Ce(i.icon),{key:1}))]),default:k(()=>[Xe(M(E,{depth:"3"},{default:k(()=>[ye(de(i.name),1)]),_:2},1536),[[We,!h.value]])]),_:2},1032,["circle"])]),_:2},1032,["file-list","customRequest","onBeforeUpload"])):fe("",!0)])]),default:k(()=>[W("span",null,de(i.name),1)]),_:2},1032,["disabled"]))),128))],34),M(d(hs),{modelShow:f.value,"onUpdate:modelShow":l[2]||(l[2]=i=>f.value=i)},null,8,["modelShow"])],64)}}});var Ts=ce(Ss,[["__scopeId","data-v-4c257f27"]]);const xs=ue({__name:"index",setup(e){const n=re(),{handleContextMenu:t}=ut();En();const{mouseenterHandle:o,mouseleaveHandle:s,mousedownHandle:g,mouseClickHandle:c}=Lt(),w=(h,v,a)=>{if(n.getTargetChart.selectId.length>1)return v.filter(y=>[A.GROUP,A.DELETE].includes(y.key));const b=[];return a.status.lock?b.push(A.LOCK):b.push(A.UNLOCK),a.status.hide?b.push(A.HIDE):b.push(A.SHOW),h.filter(y=>!b.includes(y.key))},C=h=>{var v;return!!((v=h.chartConfig.filters)!=null&&v.length)},f=h=>{var a,b,y,T;let v=h.chartConfig.package;return!!(v=="Charts"&&((b=(a=h.option)==null?void 0:a.title)==null?void 0:b.text)&&((T=(y=h==null?void 0:h.option)==null?void 0:y.title)==null?void 0:T.titleShow)||v=="Charts"&&h.chartConfig.title||v=="Tables")},_=h=>f(h)?40:0,p=h=>{var T;const v=(T=h.chartConfig.filters)==null?void 0:T.map(R=>R.type==Jt.DATE&&R.from!="query"?221:450);if(!(v!=null&&v.length))return 0;const a=v==null?void 0:v.reduce((R,X)=>R+X+8),b=a?Math.ceil(a/h.attr.w):0;return b*24+(b-1)*8+32},u=$(()=>n.getEditCanvasConfig.chartThemeSetting),S=$(()=>{const h=n.getEditCanvasConfig.chartThemeColor;return Et[h]});$(()=>n.getEditCanvasConfig.filterShow);const m=$(()=>{const h=n.getEditCanvasConfig.background,v=n.getEditCanvasConfig.backgroundImage,y=n.getEditCanvasConfig.selectColor?{background:h||void 0}:{background:`url(${v}) no-repeat center center / cover !important`};return we(Y({},y),{width:"inherit",height:"inherit"})});return ot(()=>{xn()}),(h,v)=>(D(),N(d(Cn),{id:"go-chart-edit-layout",flex:!0,showTop:!1,showBottom:!0,depth:1,xScroll:!0,disabledScroll:!0,onMousedown:d(Ot),onDrop:d(An),onDragover:d(ht),onDragenter:d(ht)},{aside:k(()=>[M(d(Ts))]),bottom:k(()=>[M(d(ps))]),default:k(()=>[M(d(Zn),null,{default:k(()=>[W("div",{id:"go-chart-edit-content",onContextmenu:v[0]||(v[0]=(...a)=>d(t)&&d(t)(...a))},[M(d(Xn),null,{default:k(()=>[W("div",{style:oe(Y(Y({},d(He)(d(n).getEditCanvasConfig)),m.value))},[(D(!0),z(ve,null,me(d(n).getComponentList,(a,b)=>(D(),z("div",{key:a.id},[a.isGroup?(D(),N(d(Mn),{key:0,groupData:a,groupIndex:b},null,8,["groupData","groupIndex"])):(D(),N(d(et),{key:1,"data-id":a.id,index:b,style:oe(Y(Y({},d(Ie)(a.attr,b)),d(Dt)(a.styles))),item:a,onClick:y=>d(c)(y,a),onMousedown:y=>d(g)(y,a),onMouseenter:y=>d(o)(y,a),onMouseleave:y=>d(s)(y,a),onContextmenu:y=>d(t)(y,a,w)},{default:k(()=>{var y,T,R;return[f(a)?(D(),N(d(zt),{key:0,title:a.chartConfig.package=="Charts"&&(R=(T=(y=a.option)==null?void 0:y.title)==null?void 0:T.text)!=null?R:a.chartConfig.title,attr:a.attr},null,8,["title","attr"])):fe("",!0),C(a)?(D(),N(d(qt),{key:1,class:"filter-content",componentIdx:a.id,attr:a.attr,filters:a.chartConfig.filters,type:a.chartConfig.category},null,8,["componentIdx","attr","filters","type"])):fe("",!0),(D(),N(Ce(a.chartConfig.chartKey),{class:ie(["edit-content-chart",d(Qe)(a.styles.animations)]),chartConfig:a,themeSetting:u.value,themeColor:S.value,style:oe(Y(Y(Y({},d(jt)(a.attr,_(a)+p(a))),d(He)(a.styles)),d(Ze)(a.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]}),_:2},1032,["data-id","index","style","item","onClick","onMousedown","onMouseenter","onMouseleave","onContextmenu"]))]))),128))],4)]),_:1})],32)]),_:1})]),_:1},8,["onMousedown","onDrop","onDragover","onDragenter"]))}});var Hs=ce(xs,[["__scopeId","data-v-7a470414"]]);export{Hs as default};
